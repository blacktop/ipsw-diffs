## WebContentRestrictions

> `/System/Library/PrivateFrameworks/WebContentRestrictions.framework/WebContentRestrictions`

```diff

-39.40.2.0.0
-  __TEXT.__text: 0xc474
-  __TEXT.__auth_stubs: 0xae0
-  __TEXT.__objc_methlist: 0x79c
+39.60.4.0.0
+  __TEXT.__text: 0xba98
+  __TEXT.__auth_stubs: 0xad0
+  __TEXT.__objc_methlist: 0x75c
   __TEXT.__const: 0x560
-  __TEXT.__cstring: 0x12e6
+  __TEXT.__cstring: 0x10a6
   __TEXT.__gcc_except_tab: 0x84
-  __TEXT.__oslogstring: 0x193
+  __TEXT.__oslogstring: 0x1b3
   __TEXT.__swift5_typeref: 0x10c
   __TEXT.__constg_swiftt: 0x220
   __TEXT.__swift5_reflstr: 0x107

   __TEXT.__swift5_mpenum: 0x8
   __TEXT.__swift5_assocty: 0x18
   __TEXT.__swift5_proto: 0x34
-  __TEXT.__unwind_info: 0x3e0
+  __TEXT.__unwind_info: 0x3c8
   __TEXT.__eh_frame: 0x528
-  __TEXT.__objc_classname: 0xf2
-  __TEXT.__objc_methname: 0x1a98
-  __TEXT.__objc_methtype: 0x32c
-  __TEXT.__objc_stubs: 0x17a0
-  __DATA_CONST.__got: 0x190
+  __TEXT.__objc_classname: 0xe5
+  __TEXT.__objc_methname: 0x17fa
+  __TEXT.__objc_methtype: 0x2d0
+  __TEXT.__objc_stubs: 0x15e0
+  __DATA_CONST.__got: 0x188
   __DATA_CONST.__const: 0x338
-  __DATA_CONST.__objc_classlist: 0x58
+  __DATA_CONST.__objc_classlist: 0x50
   __DATA_CONST.__objc_protolist: 0x10
   __DATA_CONST.__objc_imageinfo: 0x8
-  __DATA_CONST.__objc_selrefs: 0x6d8
+  __DATA_CONST.__objc_selrefs: 0x668
   __DATA_CONST.__objc_protorefs: 0x10
   __DATA_CONST.__objc_superrefs: 0x28
   __DATA_CONST.__objc_arraydata: 0x78
-  __AUTH_CONST.__auth_got: 0x580
+  __AUTH_CONST.__auth_got: 0x578
   __AUTH_CONST.__const: 0x390
-  __AUTH_CONST.__cfstring: 0x14e0
-  __AUTH_CONST.__objc_const: 0xcf0
+  __AUTH_CONST.__cfstring: 0x1080
+  __AUTH_CONST.__objc_const: 0xc90
   __AUTH_CONST.__objc_arrayobj: 0x18
   __AUTH_CONST.__objc_intobj: 0x60
-  __AUTH.__objc_data: 0x360
+  __AUTH.__objc_data: 0x310
   __AUTH.__data: 0x168
-  __DATA.__objc_ivar: 0x64
+  __DATA.__objc_ivar: 0x68
   __DATA.__data: 0x198
   __DATA.__bss: 0x690
   __DATA_DIRTY.__objc_data: 0x50

   - /usr/lib/swift/libswiftXPC.dylib
   - /usr/lib/swift/libswift_Builtin_float.dylib
   - /usr/lib/swift/libswiftos.dylib
-  UUID: 217060CF-F861-332E-A14B-A4DB7644DFDD
-  Functions: 312
-  Symbols:   1389
-  CStrings:  708
+  UUID: 46888EAC-788D-3A1D-9404-FBD8AB745557
+  Functions: 308
+  Symbols:   1361
+  CStrings:  622
 
Symbols:
+ +[WCRBrowserEngineClient _appleAllowList:]
+ +[WCRBrowserEngineClient _blockPageForURL:inLanguage:withAllowButton:]
+ +[WCRBrowserEngineClient _evaluateURL:inMode:usingBloomFilter:userSettings:language:allowList:appleAllowList:denyList:allowedWebsitesOnlyList:macOSExemptURLList:withCompletion:onCompletionQueue:]
+ -[WCRBrowserEngineClient appleAllowList]
+ -[WCRBrowserEngineClient setAppleAllowList:]
+ GCC_except_table31
+ _OBJC_IVAR_$_WCRBrowserEngineClient._appleAllowList
+ ___195+[WCRBrowserEngineClient _evaluateURL:inMode:usingBloomFilter:userSettings:language:allowList:appleAllowList:denyList:allowedWebsitesOnlyList:macOSExemptURLList:withCompletion:onCompletionQueue:]_block_invoke
+ ___195+[WCRBrowserEngineClient _evaluateURL:inMode:usingBloomFilter:userSettings:language:allowList:appleAllowList:denyList:allowedWebsitesOnlyList:macOSExemptURLList:withCompletion:onCompletionQueue:]_block_invoke.56
+ ___195+[WCRBrowserEngineClient _evaluateURL:inMode:usingBloomFilter:userSettings:language:allowList:appleAllowList:denyList:allowedWebsitesOnlyList:macOSExemptURLList:withCompletion:onCompletionQueue:]_block_invoke.57
+ ___195+[WCRBrowserEngineClient _evaluateURL:inMode:usingBloomFilter:userSettings:language:allowList:appleAllowList:denyList:allowedWebsitesOnlyList:macOSExemptURLList:withCompletion:onCompletionQueue:]_block_invoke.58
+ ___195+[WCRBrowserEngineClient _evaluateURL:inMode:usingBloomFilter:userSettings:language:allowList:appleAllowList:denyList:allowedWebsitesOnlyList:macOSExemptURLList:withCompletion:onCompletionQueue:]_block_invoke.59
+ ___195+[WCRBrowserEngineClient _evaluateURL:inMode:usingBloomFilter:userSettings:language:allowList:appleAllowList:denyList:allowedWebsitesOnlyList:macOSExemptURLList:withCompletion:onCompletionQueue:]_block_invoke.60
+ ___195+[WCRBrowserEngineClient _evaluateURL:inMode:usingBloomFilter:userSettings:language:allowList:appleAllowList:denyList:allowedWebsitesOnlyList:macOSExemptURLList:withCompletion:onCompletionQueue:]_block_invoke.61
+ ___195+[WCRBrowserEngineClient _evaluateURL:inMode:usingBloomFilter:userSettings:language:allowList:appleAllowList:denyList:allowedWebsitesOnlyList:macOSExemptURLList:withCompletion:onCompletionQueue:]_block_invoke_2
+ ___195+[WCRBrowserEngineClient _evaluateURL:inMode:usingBloomFilter:userSettings:language:allowList:appleAllowList:denyList:allowedWebsitesOnlyList:macOSExemptURLList:withCompletion:onCompletionQueue:]_block_invoke_3
+ _objc_msgSend$_appleAllowList:
+ _objc_msgSend$_blockPageForURL:inLanguage:withAllowButton:
+ _objc_msgSend$_evaluateURL:inMode:usingBloomFilter:userSettings:language:allowList:appleAllowList:denyList:allowedWebsitesOnlyList:macOSExemptURLList:withCompletion:onCompletionQueue:
- +[WCRBlockPage _allowedWebSitesHTML:]
- +[WCRBlockPage _css:]
- +[WCRBlockPage _fileContentWithName:inLanguage:extension:]
- +[WCRBlockPage _javascript:]
- +[WCRBlockPage _xssSafeStringFromString:]
- +[WCRBlockPage blockPageForUser:inLanguage:withUserVisibleURLString:withFormPostToURLString:withFormRestrictedPageURLString:withFormRestrictedPageTitle:withAllowedWebsites:isAllowedWebsitesOnlyBlock:isNetworkAccount:allowsOverrides:]
- +[WCRBlockPage createBlockPageFromTemplate:inLanguage:withUserVisibleURLString:isAllowedWebsitesOnlyBlock:withAllowedWebsites:withFormPostToURLString:withFormRestrictedPageURLString:withFormRestrictedPageTitle:]
- +[WCRBrowserEngineClient _blockPageForURL:forUser:inLanguage:isAllowedWebsitesOnlyBlock:withAllowedWebsites:withAllowButton:]
- +[WCRBrowserEngineClient _evaluateURL:inMode:usingBloomFilter:userSettings:language:allowList:denyList:allowedWebsitesOnlyList:macOSExemptURLList:withCompletion:onCompletionQueue:]
- -[WCRAppleAllowList contains:]
- GCC_except_table29
- _OBJC_CLASS_$_NSMutableString
- _OBJC_CLASS_$_WCRBlockPage
- _OBJC_METACLASS_$_WCRBlockPage
- __OBJC_$_CLASS_METHODS_WCRBlockPage
- __OBJC_CLASS_RO_$_WCRBlockPage
- __OBJC_METACLASS_RO_$_WCRBlockPage
- ___180+[WCRBrowserEngineClient _evaluateURL:inMode:usingBloomFilter:userSettings:language:allowList:denyList:allowedWebsitesOnlyList:macOSExemptURLList:withCompletion:onCompletionQueue:]_block_invoke
- ___180+[WCRBrowserEngineClient _evaluateURL:inMode:usingBloomFilter:userSettings:language:allowList:denyList:allowedWebsitesOnlyList:macOSExemptURLList:withCompletion:onCompletionQueue:]_block_invoke.56
- ___180+[WCRBrowserEngineClient _evaluateURL:inMode:usingBloomFilter:userSettings:language:allowList:denyList:allowedWebsitesOnlyList:macOSExemptURLList:withCompletion:onCompletionQueue:]_block_invoke.57
- ___180+[WCRBrowserEngineClient _evaluateURL:inMode:usingBloomFilter:userSettings:language:allowList:denyList:allowedWebsitesOnlyList:macOSExemptURLList:withCompletion:onCompletionQueue:]_block_invoke.58
- ___180+[WCRBrowserEngineClient _evaluateURL:inMode:usingBloomFilter:userSettings:language:allowList:denyList:allowedWebsitesOnlyList:macOSExemptURLList:withCompletion:onCompletionQueue:]_block_invoke.59
- ___180+[WCRBrowserEngineClient _evaluateURL:inMode:usingBloomFilter:userSettings:language:allowList:denyList:allowedWebsitesOnlyList:macOSExemptURLList:withCompletion:onCompletionQueue:]_block_invoke.60
- ___180+[WCRBrowserEngineClient _evaluateURL:inMode:usingBloomFilter:userSettings:language:allowList:denyList:allowedWebsitesOnlyList:macOSExemptURLList:withCompletion:onCompletionQueue:]_block_invoke_2
- ___180+[WCRBrowserEngineClient _evaluateURL:inMode:usingBloomFilter:userSettings:language:allowList:denyList:allowedWebsitesOnlyList:macOSExemptURLList:withCompletion:onCompletionQueue:]_block_invoke_3
- _objc_msgSend$_allowedWebSitesHTML:
- _objc_msgSend$_allowedWebsitesOnly:
- _objc_msgSend$_blockPageForURL:forUser:inLanguage:isAllowedWebsitesOnlyBlock:withAllowedWebsites:withAllowButton:
- _objc_msgSend$_css:
- _objc_msgSend$_evaluateURL:inMode:usingBloomFilter:userSettings:language:allowList:denyList:allowedWebsitesOnlyList:macOSExemptURLList:withCompletion:onCompletionQueue:
- _objc_msgSend$_fileContentWithName:inLanguage:extension:
- _objc_msgSend$_javascript:
- _objc_msgSend$_xssSafeStringFromString:
- _objc_msgSend$appendFormat:
- _objc_msgSend$appendString:
- _objc_msgSend$containsObject:
- _objc_msgSend$createBlockPageFromTemplate:inLanguage:withUserVisibleURLString:isAllowedWebsitesOnlyBlock:withAllowedWebsites:withFormPostToURLString:withFormRestrictedPageURLString:withFormRestrictedPageTitle:
- _objc_msgSend$length
- _objc_msgSend$string
- _objc_msgSend$stringByReplacingOccurrencesOfString:withString:options:range:
- _objc_msgSend$stringWithString:
- _objc_msgSend$substringToIndex:
- _objc_retain_x27
CStrings:
+ "@36@0:8@16@24B32"
+ "Apple Allow list: %{sensitive}@ -> Allowed"
+ "T@\"WCRURLList\",&,V_appleAllowList"
+ "WCRAppleAllowList-2025-09-29.plist"
+ "WCRFilter-2025-09-29.plist"
+ "_appleAllowList:"
+ "_blockPageForURL:inLanguage:withAllowButton:"
+ "_evaluateURL:inMode:usingBloomFilter:userSettings:language:allowList:appleAllowList:denyList:allowedWebsitesOnlyList:macOSExemptURLList:withCompletion:onCompletionQueue:"
+ "v112@0:8@16Q24@32@40@48@56@64@72@80@88@?96@104"
- "\""
- "%@..."
- "&"
- "&amp;"
- "&apos;"
- "&gt;"
- "&lt;"
- "&quot;"
- "'"
- "-net"
- "-wl"
- "<"
- "<a href=\"%@\">%@</a><br>"
- ">"
- "@40@0:8@16@24@32"
- "@56@0:8@16@24@32B40@44B52"
- "@76@0:8@16@24@32B40@44@52@60@68"
- "@84@0:8@16@24@32@40@48@56@64B72B76B80"
- "ALLOWED_LIST_OF_WEBSITES_NO_LOC"
- "BlockPageURL was nil"
- "Error finding file with name %@"
- "Error getting address from websiteInfo"
- "Error getting title from websiteInfo"
- "Error loading block page: %@"
- "INCLUDE_JAVASCRIPT_FILE_NO_LOC"
- "Impossible to determine URL"
- "PAGE_TO_OVERRIDE_TITLE_NO_LOC"
- "PAGE_TO_OVERRIDE_URL_NO_LOC"
- "SEND_FORM_TO_URL_NO_LOC"
- "WCRAppleAllowList-2025-04-07.plist"
- "WCRBlockPage"
- "WCRFilter-2025-04-07.plist"
- "_allowedWebSitesHTML:"
- "_blockPageForURL:forUser:inLanguage:isAllowedWebsitesOnlyBlock:withAllowedWebsites:withAllowButton:"
- "_css:"
- "_evaluateURL:inMode:usingBloomFilter:userSettings:language:allowList:denyList:allowedWebsitesOnlyList:macOSExemptURLList:withCompletion:onCompletionQueue:"
- "_fileContentWithName:inLanguage:extension:"
- "_javascript:"
- "_xssSafeStringFromString:"
- "`"
- "appendFormat:"
- "appendString:"
- "block page is nil"
- "blockPageForUser:inLanguage:withUserVisibleURLString:withFormPostToURLString:withFormRestrictedPageURLString:withFormRestrictedPageTitle:withAllowedWebsites:isAllowedWebsitesOnlyBlock:isNetworkAccount:allowsOverrides:"
- "blockpage-macOS"
- "blockpage-macOS-nooverride"
- "blockpage_script"
- "blockpage_style-macOS"
- "containsObject:"
- "createBlockPageFromTemplate:inLanguage:withUserVisibleURLString:isAllowedWebsitesOnlyBlock:withAllowedWebsites:withFormPostToURLString:withFormRestrictedPageURLString:withFormRestrictedPageTitle:"
- "error loading file with name %@. Error: %@"
- "http://www.error.com"
- "js"
- "length"
- "pageTitle"
- "string"
- "stringByReplacingOccurrencesOfString:withString:options:range:"
- "stringWithString:"
- "substringToIndex:"
- "v104@0:8@16Q24@32@40@48@56@64@72@80@?88@96"

```
