## MessagesCloudSync

> `/System/Library/PrivateFrameworks/MessagesCloudSync.framework/MessagesCloudSync`

```diff

-1261.200.71.2.16
-  __TEXT.__text: 0x103008
-  __TEXT.__auth_stubs: 0x1cc0
-  __TEXT.__objc_methlist: 0x524
-  __TEXT.__const: 0x6870
-  __TEXT.__cstring: 0x6c57
-  __TEXT.__constg_swiftt: 0x24e8
-  __TEXT.__swift5_typeref: 0x238a
-  __TEXT.__swift5_builtin: 0x104
-  __TEXT.__swift5_reflstr: 0x2bfa
-  __TEXT.__swift5_fieldmd: 0x2f2c
+1262.300.81.2.13
+  __TEXT.__text: 0x10e5d0
+  __TEXT.__auth_stubs: 0x1d20
+  __TEXT.__objc_methlist: 0x574
+  __TEXT.__const: 0x6c00
+  __TEXT.__cstring: 0x79c7
+  __TEXT.__constg_swiftt: 0x27fc
+  __TEXT.__swift5_typeref: 0x2554
+  __TEXT.__swift5_builtin: 0x118
+  __TEXT.__swift5_reflstr: 0x300a
+  __TEXT.__swift5_fieldmd: 0x3150
   __TEXT.__swift5_assocty: 0x5a0
-  __TEXT.__swift5_proto: 0x670
-  __TEXT.__swift5_types: 0x264
-  __TEXT.__swift5_capture: 0xa74
+  __TEXT.__swift5_proto: 0x6bc
+  __TEXT.__swift5_types: 0x298
+  __TEXT.__swift5_capture: 0xc2c
   __TEXT.__swift5_mpenum: 0x48
-  __TEXT.__swift5_protos: 0x88
-  __TEXT.__unwind_info: 0x4020
-  __TEXT.__eh_frame: 0x864c
-  __TEXT.__objc_classname: 0x1a0
-  __TEXT.__objc_methname: 0x2198
-  __TEXT.__objc_methtype: 0x4bc
-  __TEXT.__objc_stubs: 0x300
-  __DATA_CONST.__got: 0x430
-  __DATA_CONST.__const: 0x1b8
-  __DATA_CONST.__objc_classlist: 0xe0
+  __TEXT.__swift5_protos: 0x8c
+  __TEXT.__unwind_info: 0x3e14
+  __TEXT.__eh_frame: 0x8fd4
+  __TEXT.__objc_classname: 0x18b
+  __TEXT.__objc_methname: 0x2316
+  __TEXT.__objc_methtype: 0x4f6
+  __TEXT.__objc_stubs: 0x360
+  __DATA_CONST.__got: 0x488
+  __DATA_CONST.__const: 0x1d8
+  __DATA_CONST.__objc_classlist: 0x100
   __DATA_CONST.__objc_catlist: 0x0
-  __DATA_CONST.__objc_protolist: 0x110
+  __DATA_CONST.__objc_protolist: 0x100
   __DATA_CONST.__objc_imageinfo: 0x8
-  __DATA_CONST.__objc_const: 0x21f0
-  __DATA_CONST.__objc_selrefs: 0xb10
+  __DATA_CONST.__objc_const: 0x2740
+  __DATA_CONST.__objc_selrefs: 0xb80
   __AUTH_CONST.__objc_const: 0x240
-  __AUTH_CONST.__const: 0x8518
+  __AUTH_CONST.__const: 0x8d28
   __AUTH_CONST.__auth_ptr: 0x1f0
-  __AUTH_CONST.__auth_got: 0xe68
-  __AUTH.__objc_data: 0x5e0
-  __AUTH.__data: 0x1320
-  __DATA.__objc_protorefs: 0x90
-  __DATA.__objc_classrefs: 0x270
+  __AUTH_CONST.__auth_got: 0xe98
+  __AUTH.__objc_data: 0x630
+  __AUTH.__data: 0x1670
+  __DATA.__objc_protorefs: 0x88
+  __DATA.__objc_classrefs: 0x278
   __DATA.__objc_superrefs: 0x10
   __DATA.__objc_ivar: 0x8
   __DATA.__objc_data: 0x88
-  __DATA.__data: 0x4218
-  __DATA.__bss: 0xbb50
-  __DATA.__common: 0x118
+  __DATA.__data: 0x3b98
+  __DATA.__bss: 0xc170
+  __DATA.__common: 0x1c0
   __DATA_DIRTY.__objc_data: 0x258
-  __DATA_DIRTY.__data: 0x5c8
+  __DATA_DIRTY.__data: 0x5b8
   __DATA_DIRTY.__bss: 0x280
-  __DATA_DIRTY.__common: 0xa0
+  __DATA_DIRTY.__common: 0x98
   - /System/Library/Frameworks/CloudKit.framework/CloudKit
   - /System/Library/Frameworks/CoreData.framework/CoreData
   - /System/Library/Frameworks/CoreFoundation.framework/CoreFoundation

   - /usr/lib/swift/libswift_Concurrency.dylib
   - /usr/lib/swift/libswiftos.dylib
   - /usr/lib/swift/libswiftsimd.dylib
-  Functions: 4544
-  Symbols:   363
-  CStrings:  1213
+  Functions: 4847
+  Symbols:   375
+  CStrings:  1289
 
Symbols:
+ _IMCloudKitDefinesShouldRetryUnsupported
+ _IMCloudKitDefinesVerifyFirstRestoreDateVersion
+ _IMDKVPersistValueForKey
+ _IMDKVValueForKey
+ _IMDMessageRecordCalculateLocalCloudKitStatistics
+ _IMDMessageRecordCloudKitStatisticServerCountsKey
+ _IMFileTransferAttributionInfoIsStickerReactionKey
+ _IMSMSDirectoryURL
+ _IMStickerUserInfoStickerIsReactionKey
+ _JWEncodeDictionary
+ _OBJC_CLASS_$_IMDeviceConditions
+ _XPC_ACTIVITY_SHOULD_WAKE_DEVICE
+ _objc_retain_x9
- _IMCloudKitLastSyncErrors
CStrings:
+ "%s: Missing sync token store, did not update server change token for key (%s)"
+ "/Library/Caches/com.apple.xbs/Sources/MessagesCore/IMCore/MessagesCloudSync/SyncSteps/ImportStep.swift"
+ "/Library/Caches/com.apple.xbs/Sources/MessagesCore/IMCore/MessagesCloudSync/SyncSteps/RecordZoneDeleter.swift"
+ "/Library/Caches/com.apple.xbs/Sources/MessagesCore/IMCore/MessagesCloudSync/SyncSteps/RecordZoneReader.swift"
+ "/Library/Caches/com.apple.xbs/Sources/MessagesCore/IMCore/MessagesCloudSync/SyncSteps/RecordZoneWriter.swift"
+ "/Library/Caches/com.apple.xbs/Sources/MessagesCore/IMCore/MessagesCloudSync/SyncSteps/ReportDiagnosticTelemetryStep.swift"
+ "/Library/Caches/com.apple.xbs/Sources/MessagesCore/IMCore/MessagesCloudSync/SyncSteps/SyncPreReqsVerifierStep.swift"
+ "<no_record_name>"
+ "<no_record_type>"
+ "Aborting after finishing batch due to: %@"
+ "Already finished telemetry not scheduling, current version: %ld"
+ "Broadcasting import progress"
+ "Clearing local counts"
+ "CloudKitFirstRestoreCompletedDate"
+ "CloudKitTelemetrySyncVersion"
+ "Device Policy Violation: User was charging then went on battery"
+ "Device Policy Violation: User was on wifi then network disconnected"
+ "Device Policy Violation: User was on wifi then switched to cellular"
+ "Device violated device policy criteria"
+ "Did not successfully ping iCloud for quota grace"
+ "Doing remote record query with predicate %@"
+ "Download Progress: %f"
+ "Encountered error fetching record counts: %@"
+ "Error importing: %@ for record(guid = %s, recordType = %s, recordName = %s)"
+ "Error pinging iCloud for quota grace: %@"
+ "Error when fetching chat properties for import context: %@"
+ "Extracted %ld guids from %ld records when creating import context"
+ "Failed to decode duplicate diagnostics or file doesn't exist, setting to empty. Error: %@"
+ "Failed to encode and write duplicates diagnostics file %@"
+ "Failed to encode statistics for diagnostics telemetry: %@"
+ "Failed to get json string for statistics: %s"
+ "Failed to remove duplicates diagnostics file: %@"
+ "Failed to write diagnostics binary plist: %@"
+ "Fetched empty statistics from IMDPersistence, that shouldn't occur."
+ "ForceAbortBeforeDelete"
+ "Found %ld records ready to re-import"
+ "Found %ld records without GUIDs!"
+ "Has server counts: %s"
+ "MIC2 Delete - Forced Abort due to default ForceAbortBeforeDelete"
+ "MIC2 Read - Forced Abort due to default ForceAbortBeforeRead"
+ "Missing backup controller did not send ping for iCloud quota grace"
+ "No GUID present for chat record %s"
+ "No row present in kvtable for key name %s"
+ "Performing import with tombstoning with batch: %s"
+ "Performing import, given predicate with batch: %s"
+ "Posting duplicates telemetry with value: %s"
+ "Preparing sync statistics"
+ "Query to sync store returned empty for predicate: %@"
+ "Read from %s encountered error: %@"
+ "Record %s failed to write because Quota Exceeded"
+ "Record id chat lock record, skipping"
+ "Sent ping for quota grace to iCloud"
+ "Setting the following sync statistics on our CloudKit state: %s"
+ "Starting sync (totalProcessed: %lld, totalDownloads: %lld)"
+ "Successfully imported %ld records, had %ld unsupported records, did tombstone? %{bool}d"
+ "Successfully nil'd out local store count from database"
+ "Successfully wrote to database our new local store count: %s"
+ "Telemetry"
+ "Tried clearing local counts but currently in a sync, will clear on completion"
+ "Unable to get domain model, returning .unknown"
+ "User finished first full sync, and did not have a marker for first restore, setting marker"
+ "User has not marked first restore, setting first restore date, and marker"
+ "[DevicePolicy]:\n    evaluateUserSyncOnly = %{bool}d\n    maintainWifi = %{bool}d\n    maintainCharging = %{bool}d\n    initialDeviceState = %s"
+ "_TtC17MessagesCloudSync10CountStore"
+ "_TtC17MessagesCloudSync11SyncContext"
+ "_TtC17MessagesCloudSync20ImportContextFactory"
+ "_TtC17MessagesCloudSync25DuplicateCountReadHandler"
+ "activity"
+ "attachmentTotals"
+ "attemptCount"
+ "chatOriginalGroupID"
+ "chatTelemetryChangeToken"
+ "chat_duplicates_diagnostics"
+ "clearLocalCountsWhenSafe"
+ "cloudDatabase"
+ "cloudState"
+ "countStore"
+ "currentTelemetrySyncVersion"
+ "currentTelemetryVersion"
+ "devicePolicy"
+ "diagnostics_telemetry"
+ "duplicatesMap"
+ "groupChatAverage"
+ "identifier"
+ "imessage-importer-progress-interval-key"
+ "imessage-message-sync-periodic-batches-per-import"
+ "integerValue"
+ "isDeviceCharging"
+ "isDeviceOnData"
+ "isDeviceOnWifi"
+ "lastImportProgressDate"
+ "liveDatabasePersistence"
+ "maxOneToOneChatCount"
+ "messageUpdateLives"
+ "messageUpdateTotals"
+ "minGroupChatCount"
+ "minOneToOneChatCount"
+ "notifiers"
+ "oneToOneChatAverage"
+ "osActivity"
+ "overallChatAverage"
+ "parentID"
+ "progress"
+ "q16@0:8"
+ "recordPersistence"
+ "recoverableMessageLives"
+ "recoverableMessageTotals"
+ "scheduleTelemetrySyncWithDelegate:"
+ "scheduleTelemetrySyncWithDelegate:error:"
+ "sendDeviceIDToCloudKitWithCompletion:"
+ "setCloudKitHasAvailableRecordsToDownload:"
+ "setCloudKitSyncStatistics:"
+ "setLastSyncDownloadProgress:"
+ "setParentID:"
+ "setRelationshipKeyPathsForPrefetching:"
+ "startDate"
+ "statsCollector"
+ "stickerUserInfo"
+ "syncDatabase"
+ "syncJob"
+ "telemetry"
+ "telemetryService"
+ "telemetrySyncComplete"
+ "telemetrySyncStart"
+ "totalDownloadsCount"
+ "totalGroupChatCount"
+ "totalOneToOneChatCount"
+ "totalProcessedCount"
+ "update(serverChangeToken:key:)"
+ "v20@0:8B16"
+ "v20@?0B8@\"NSError\"12"
+ "v24@0:8@?<v@?B@\"NSError\">16"
+ "v24@0:8d16"
- "%s: Missing sync token store, did not update server change token for %s"
- "/Library/Caches/com.apple.xbs/Sources/MessagesCore/IMCore/MessagesCloudSync/CloudKit/Steps/ImportStep.swift"
- "/Library/Caches/com.apple.xbs/Sources/MessagesCore/IMCore/MessagesCloudSync/CloudKit/Steps/RecordZoneDeleter.swift"
- "/Library/Caches/com.apple.xbs/Sources/MessagesCore/IMCore/MessagesCloudSync/CloudKit/Steps/RecordZoneReader.swift"
- "/Library/Caches/com.apple.xbs/Sources/MessagesCore/IMCore/MessagesCloudSync/CloudKit/Steps/RecordZoneWriter.swift"
- "/Library/Caches/com.apple.xbs/Sources/MessagesCore/IMCore/MessagesCloudSync/CloudKit/Steps/SyncPreReqsVerifierStep.swift"
- "/Library/Caches/com.apple.xbs/Sources/MessagesCore/IMCore/MessagesCloudSync/LiveData/FetchToDatabaseStep.swift"
- "Couldn't find change token name for %s to update sync token"
- "Error importing: %@ for record: %s"
- "Executing fetch request with [%@] predicate and %ld limit in QueryBuilder"
- "Failure in FetchRecord stream for recordID %@, %@"
- "Importer stopping work due to xpc_activity telling us to defer"
- "MIC2 Read - Forced Abort due to default ForceAbortBeforeWrite"
- "NSFetchRequestResult"
- "Performing import with tombstoning, given predicate %@, batch: %s"
- "Performing import, given predicate %@, batch: %s"
- "Record guid not found for recordName %s"
- "Starting fetch from %s to database"
- "Successfully imported %ld records, did tombstone? %{bool}d"
- "ac"
- "accessl"
- "adam-id"
- "addObserverForName:object:queue:usingBlock:"
- "bundle-id"
- "cmm-url"
- "contextWillSaveToken"
- "decryption-key"
- "decryption-key-1"
- "file-size"
- "file-size-1"
- "icon"
- "mime-type"
- "mmcs-owner"
- "mmcs-owner-1"
- "mmcs-signature-hex"
- "mmcs-signature-hex-1"
- "mmcs-url"
- "mmcs-url-1"
- "ph-uuid"
- "pid"
- "sai"
- "sbid"
- "shash"
- "sid"
- "sli"
- "spw"
- "srecipe"
- "sro"
- "ssa"
- "statusValue == $STATUS_VALUE && recordType == $RECORD_TYPE && guid ENDSWITH $RECORD_GUID"
- "sthash"
- "sxs"
- "sys"
- "ti"
- "tssa"
- "update(serverChangeToken:zoneName:)"
- "url"
- "uti-type"
- "v16@?0@\"NSNotification\"8"

```
