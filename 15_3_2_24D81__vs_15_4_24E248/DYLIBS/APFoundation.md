## APFoundation

> `/System/Library/PrivateFrameworks/APFoundation.framework/Versions/A/APFoundation`

```diff

-554.14.0.0.0
-  __TEXT.__text: 0x1223d0
-  __TEXT.__auth_stubs: 0x1700
-  __TEXT.__objc_methlist: 0x3784
-  __TEXT.__const: 0x7090
-  __TEXT.__cstring: 0x3c84
-  __TEXT.__oslogstring: 0x40b9
-  __TEXT.__gcc_except_tab: 0xa38
+555.44.0.0.0
+  __TEXT.__text: 0x13afc0
+  __TEXT.__auth_stubs: 0x1be0
+  __TEXT.__objc_methlist: 0x428c
+  __TEXT.__const: 0x81f0
+  __TEXT.__gcc_except_tab: 0xa80
+  __TEXT.__cstring: 0x4484
+  __TEXT.__oslogstring: 0x43f4
   __TEXT.__ustring: 0x4
-  __TEXT.__swift5_typeref: 0x886
-  __TEXT.__constg_swiftt: 0xb28
-  __TEXT.__swift5_reflstr: 0x3a7
-  __TEXT.__swift5_fieldmd: 0x628
-  __TEXT.__swift5_builtin: 0x28
-  __TEXT.__swift5_assocty: 0x110
-  __TEXT.__swift5_proto: 0xd8
-  __TEXT.__swift5_types: 0x8c
-  __TEXT.__swift5_capture: 0xdc
-  __TEXT.__swift5_protos: 0x30
-  __TEXT.__swift5_mpenum: 0x8
-  __TEXT.__unwind_info: 0x1408
-  __TEXT.__eh_frame: 0x500
-  __TEXT.__objc_classname: 0x8c3
-  __TEXT.__objc_methname: 0x8538
-  __TEXT.__objc_methtype: 0x19dd
-  __TEXT.__objc_stubs: 0x6d40
-  __DATA_CONST.__got: 0x6e8
-  __DATA_CONST.__const: 0x898
-  __DATA_CONST.__objc_classlist: 0x2a0
+  __TEXT.__swift5_typeref: 0xe56
+  __TEXT.__constg_swiftt: 0x15dc
+  __TEXT.__swift5_reflstr: 0x787
+  __TEXT.__swift5_fieldmd: 0xbc4
+  __TEXT.__swift5_builtin: 0x8c
+  __TEXT.__swift5_assocty: 0x220
+  __TEXT.__swift5_proto: 0x1a8
+  __TEXT.__swift5_types: 0x104
+  __TEXT.__swift5_protos: 0x48
+  __TEXT.__swift5_capture: 0x3cc
+  __TEXT.__swift5_mpenum: 0x18
+  __TEXT.__unwind_info: 0x1c20
+  __TEXT.__eh_frame: 0x1088
+  __TEXT.__objc_classname: 0x8f4
+  __TEXT.__objc_methname: 0x89aa
+  __TEXT.__objc_methtype: 0x1a5d
+  __TEXT.__objc_stubs: 0x6e60
+  __DATA_CONST.__got: 0x768
+  __DATA_CONST.__const: 0xa88
+  __DATA_CONST.__objc_classlist: 0x2d0
   __DATA_CONST.__objc_catlist: 0x80
-  __DATA_CONST.__objc_protolist: 0x118
+  __DATA_CONST.__objc_protolist: 0x110
   __DATA_CONST.__objc_imageinfo: 0x8
-  __DATA_CONST.__objc_selrefs: 0x22e0
+  __DATA_CONST.__objc_selrefs: 0x24d8
   __DATA_CONST.__objc_protorefs: 0x60
-  __DATA_CONST.__objc_superrefs: 0x178
-  __DATA_CONST.__objc_arraydata: 0x68
-  __AUTH_CONST.__auth_got: 0xb90
-  __AUTH_CONST.__const: 0x5d90
-  __AUTH_CONST.__cfstring: 0x3220
-  __AUTH_CONST.__objc_const: 0x8438
+  __DATA_CONST.__objc_superrefs: 0x180
+  __DATA_CONST.__objc_arraydata: 0x70
+  __AUTH_CONST.__auth_got: 0xe00
+  __AUTH_CONST.__const: 0x6f30
+  __AUTH_CONST.__cfstring: 0x34e0
+  __AUTH_CONST.__objc_const: 0x7ef0
   __AUTH_CONST.__objc_intobj: 0x168
-  __AUTH_CONST.__objc_doubleobj: 0xb0
+  __AUTH_CONST.__objc_doubleobj: 0xc0
   __AUTH_CONST.__objc_arrayobj: 0x30
-  __AUTH.__objc_data: 0x16e0
-  __AUTH.__data: 0xe78
-  __DATA.__objc_ivar: 0x34c
-  __DATA.__data: 0x11c8
-  __DATA.__bss: 0x1890
-  __DATA.__common: 0x110
+  __AUTH.__objc_data: 0x1820
+  __AUTH.__data: 0x1268
+  __DATA.__objc_ivar: 0x370
+  __DATA.__data: 0x19c0
+  __DATA.__bss: 0x3090
+  __DATA.__common: 0x10c
   - /System/Library/Frameworks/CoreFoundation.framework/Versions/A/CoreFoundation
   - /System/Library/Frameworks/CoreLocation.framework/Versions/A/CoreLocation
   - /System/Library/Frameworks/Foundation.framework/Versions/C/Foundation

   - /usr/lib/swift/libswiftos.dylib
   - /usr/lib/swift/libswiftsys_time.dylib
   - /usr/lib/swift/libswiftunistd.dylib
-  UUID: 72CA18C0-3BEF-3D95-AA99-245C87AC02A6
-  Functions: 1922
-  Symbols:   651
-  CStrings:  3264
+  UUID: 26A550DE-10A2-32D3-AF04-061B4ADDD91D
+  Functions: 2673
+  Symbols:   681
+  CStrings:  3427
 
Symbols:
+ _OBJC_CLASS_$_APFeatureFlags
+ _OBJC_CLASS_$_APSigningAuthorityPoolManagerWrapper
+ _OBJC_METACLASS_$_APFeatureFlags
+ _OBJC_METACLASS_$_APSigningAuthorityPoolManagerWrapper
+ __objc_autoreleasePoolPop
+ __objc_autoreleasePoolPush
+ __swift_stdlib_bridgeErrorToNSError
+ _kAPActionStoreEnabled
+ _kAPExperimentationReportEnabled
+ _kAPMetricContainer
+ _kAPMetricFormat
+ _kAPModernDataCollectionEnabled
+ _kAPOnDeviceAttributionEnabled
+ _kAPOnDeviceConversionEnabled
+ _kAPTriggersIdentifier
+ _os_unfair_lock_assert_not_owner
+ _os_unfair_lock_assert_owner
+ _os_unfair_lock_lock
+ _swift_allocateGenericClassMetadata
+ _swift_arrayInitWithTakeBackToFront
+ _swift_arrayInitWithTakeFrontToBack
+ _swift_checkMetadataState
+ _swift_dynamicCastClass
+ _swift_getErrorValue
+ _swift_getFunctionTypeMetadata1
+ _swift_getMetatypeMetadata
+ _swift_initClassMetadata2
+ _swift_release_n
+ _swift_retain_n
+ _swift_slowDealloc
+ _swift_unexpectedError
+ _swift_willThrowTypedImpl
- _kAPMetricImpressionIdentifier
- _strcmp
CStrings:
+ " (id, position, type, assignedListener, payload)\nVALUES (?,(SELECT COALESCE(MAX(position), 0) + 1 FROM "
+ " (id, position, type, assignedListener, payload)\nVALUES (?,(SELECT COALESCE(MIN(position), 0) - 1 FROM "
+ " ORDER BY position ASC"
+ "#"
+ "$__lazy_storage_$_columnNames"
+ "%@ Purpose: %ld Metric: %ld H: %@ SH: %@ Options: %@, CID: %@ CX: %@ BID: %@ P: %@ IP: %@ REL: %@, ORD: %ld ENV: %@"
+ "%@ R: %ld M: %ld H: %@ SH: %@ O: %@, CI: %@ CX: %@ BID: %@ P: %@ IP: %@ REL: %@, ORD: %ld ENV: %@"
+ "%@%ld%ld%@%@%@%@%@%@%@%@%@%ld%@"
+ "%u-%u-%u-%u-%u-%u-%u-%u"
+ "+[APAnalytics sendEventAppleDomain:customPayload:]"
+ ".plist"
+ "@\"<APMetricProtocol>\"120@0:8q16q24@\"NSString\"32@\"NSString\"40@\"NSString\"48@\"NSString\"56@\"NSArray\"64@\"NSDictionary\"72@\"NSDictionary\"80@\"NSDictionary\"88@\"NSArray\"96q104q112"
+ "@\"APSigningAuthorityPoolManager\""
+ "@120@0:8q16q24@32@40@48@56@64@72@80@88@96q104q112"
+ "@32@0:8@16@?24"
+ "@56@0:8@16Q24Q32@?40@?48"
+ "APFeatureFlags"
+ "APFoundation/Worker.swift"
+ "APSigning"
+ "APSigningAuthorityPoolManagerWrapper"
+ "APSigningRequest"
+ "Adding message %{public}s to the queue."
+ "B28@0:8@16i24"
+ "B36@0:8i16^i20@?28"
+ "BEGIN TRANSACTION"
+ "Can't convert payload to utf8"
+ "Can't find assigned listener %{public}s, that doesn't seem right. The listener disappeared?"
+ "Cannot decode JSON"
+ "Duplicate values for key: '"
+ "Error: unexpected worker type."
+ "Failed \"appendToHead\"."
+ "Failed \"appendToHead\". %{public}@"
+ "Failed to append a message to the queue."
+ "Failed to append a message to the queue. %{public}@"
+ "Failed to load message queue."
+ "Failed to load message queue. %{public}@"
+ "Failed to remove a message to the queue."
+ "Failed to remove a message to the queue. %{public}@"
+ "Fatal error"
+ "Feature: actionStore enabled: %d"
+ "Feature: experimentationReport enabled: %d"
+ "Feature: modernDataCollection enabled: %d"
+ "Feature: modernDataCollection enabled: %{public}d"
+ "IdentifierManager"
+ "JetEngine"
+ "Listener \"%{public}s\" has processed message %s"
+ "Message queue is ready."
+ "Migration failed on dynamic event tables from version %d"
+ "No connection on optimize."
+ "No listeners for message %{public}s was found. Dropping the message."
+ "OnDeviceAttribution"
+ "OnDeviceConversion"
+ "PRAGMA auto_vacuum"
+ "PRAGMA optimize"
+ "Pool manager %p refilling (retry %ld)"
+ "Processing message %{public}s"
+ "Query"
+ "Queue can't make any progress."
+ "ROLLBACK TRANSACTION"
+ "SELECT name FROM sqlite_master WHERE type='table' AND name LIKE 'event_%'"
+ "SH"
+ "Signing Authority %p received init response %p with length %u\nwith error: %@"
+ "SigningErrors"
+ "Simulated init timeout"
+ "Simulated setup timeout"
+ "Starting message queue."
+ "Swift/Dictionary.swift"
+ "Swift/NativeDictionary.swift"
+ "T@\"APSigningAuthorityPoolManager\",&,N,V_poolManager"
+ "T@\"NSData\",&,N,V_data"
+ "T@\"NSMutableArray\",&,N,V_waitingRequests"
+ "T@\"NSObject<OS_dispatch_queue>\",&,N,V_queue"
+ "T@\"NSObject<OS_dispatch_queue>\",&,N,V_setupQueue"
+ "T@\"NSString\",R,N,V_secondaryHandle"
+ "T@\"NSString\",R,N,V_tableName"
+ "T@?,C,N,V_stateChangeHandler"
+ "TQ,N,V_retryLevel"
+ "This method must be overridden by a subclass"
+ "Tq,N,V_options"
+ "Unexpected FPDI state: %ld"
+ "VACUUM"
+ "Worker type is not "
+ "[%{private}@]: %{private}@ Error couldn't set incremental vacuum."
+ "[%{private}@]: Database has %ld free pages, %@. vacuum."
+ "[%{private}@]: Database optimize."
+ "[%{sensitive}s]: Failed to receive init reponse, FPDI setup has failed.\n%@"
+ "_TtC12APFoundation10UnfairLock"
+ "_TtC12APFoundation16SignpostProvider"
+ "_TtC12APFoundation24SinglyCallableCompletion"
+ "_data"
+ "_endSetup"
+ "_handleEventTablesDynamicMigrationWithQuery:version:"
+ "_isMetricWithContainerAllowed:"
+ "_poolManager"
+ "_poolManagerStateChangedTo:"
+ "_queue"
+ "_replyToWaitingClients:state:"
+ "_retryLevel"
+ "_retrySetup"
+ "_runTransactionStatement:"
+ "_secondaryHandle"
+ "_setupQueue"
+ "_stateChangeHandler"
+ "_tableName"
+ "_trySetup"
+ "_waitingRequests"
+ "actionStoreEnabled"
+ "assignedListenerId"
+ "auditTokenString"
+ "callbacks"
+ "com.apple"
+ "com.apple.AppStore.ProductPageExtension"
+ "com.apple.ap.promotedcontentd.remoteconnection.queue"
+ "com.apple.ap.signing.pending"
+ "com.apple.ap.signingauthority.fail_init"
+ "container"
+ "createForData:completionHandler:"
+ "createSigningErrorWithCode:"
+ "createWithResponseData:URLResponse:error:"
+ "eventSourceID:"
+ "executeTransactionQueryWithType:"
+ "executeTransactionQueryWithType:result:transactionBody:"
+ "experimentationReportEnabled"
+ "format"
+ "fulfillHandlers"
+ "i20@0:8i16"
+ "i24@0:8@16"
+ "initWithName:poolSize:numberToStash:stateChangeHandler:setupCompletion:"
+ "initWithPurpose:metric:contentIdentifier:contextIdentifier:handle:secondaryHandle:branch:properties:internalProperties:relayData:environment:order:options:"
+ "internalState"
+ "isBroken"
+ "isProcessingMessage"
+ "isReady"
+ "isStarted"
+ "messageDidProcessClosure"
+ "messageWillProcessClosure"
+ "modernDataCollectionEnabled"
+ "onDeviceAttributionEnabled"
+ "onDeviceConversionEnabled"
+ "optimize"
+ "poolManager"
+ "processingQueue"
+ "queue"
+ "queueCache"
+ "queueStorage"
+ "queueStore"
+ "rejectHandlers"
+ "retryLevel"
+ "secondaryHandle"
+ "sendEventAppleDomain:customPayload:"
+ "setData:"
+ "setOptions:"
+ "setPoolManager:"
+ "setQueue:"
+ "setRetryLevel:"
+ "setSetupQueue:"
+ "setStateChangeHandler:"
+ "setWaitingRequests:"
+ "setupQueue"
+ "signatureForData:completion:"
+ "signatureForData:waitIfSigningIsNotReady:completion:"
+ "signposters"
+ "stateChangeHandler"
+ "storeRetries"
+ "task"
+ "timed out"
+ "triggers"
+ "v24@?0@\"NSArray\"8@?<v@?@\"NSString\">16"
+ "v24@?0@\"NSData\"8@\"NSError\"16"
+ "v32@0:8@\"NSData\"16@?<v@?@\"NSData\"@\"NSError\">24"
+ "v32@0:8d16@?<v@?q>24"
+ "v36@0:8@16B24@?28"
+ "waitingRequests"
+ "{TableName}"
- "%@ Purpose: %ld Metric: %ld H: %@ Options: %@, CID: %@ CX: %@ BID: %@ P: %@ IP: %@ REL: %@, ORD: %ld ENV: %@"
- "%@ R: %ld M: %ld H: %@ O: %@, CI: %@ CX: %@ BID: %@ P: %@ IP: %@ REL: %@, ORD: %ld ENV: %@"
- "%@%ld%ld%@%@%@%@%@%@%@%@%ld%@"
- "@\"<APDatabaseTableProtocol>\""
- "@\"<APDatabaseTableProtocol>\"16@0:8"
- "@\"<APMetricProtocol>\"112@0:8q16q24@\"NSString\"32@\"NSString\"40@\"NSString\"48@\"NSArray\"56@\"NSDictionary\"64@\"NSDictionary\"72@\"NSDictionary\"80@\"NSArray\"88q96q104"
- "@\"APBackoffTimer\""
- "@\"APInMemoryTTLCache\""
- "@112@0:8q16q24@32@40@48@56@64@72@80@88q96q104"
- "APBackoffTimerDelegate"
- "APPurgeableCacheObjectP"
- "Execute begin transaction error: %s"
- "No connection on begin transaction."
- "Pool manager %p refilling"
- "Signing Authority %p finished with setup request"
- "Signing Authority %p received init response"
- "T@\"<APDatabaseTableProtocol>\",R,W,N"
- "T@\"APBackoffTimer\",&,N,V_backoffTimer"
- "T@\"APInMemoryTTLCache\",&,N,V_tableCache"
- "T@\"NSString\",R"
- "Tq,R,N,V_options"
- "[%{private}@]: Database has %f free pages, %@. vacuum."
- "_backoffTimer"
- "_table"
- "_tableCache"
- "backoffTimer"
- "beginTransaction"
- "cancelBackoff"
- "com.apple.ap.db-table-cache.queue"
- "com.apple.ap.signingauthority.setup.%p"
- "com.apple.ap.signingserverrequestor.failqueue"
- "commitTransaction"
- "compare:"
- "enterBackoff"
- "impressionId"
- "initWithPurpose:metric:contentIdentifier:contextIdentifier:handle:branch:properties:internalProperties:relayData:environment:order:options:"
- "setBackoffTimer:"
- "setTableCache:"
- "table"
- "tableCache"
- "v24@?0@\"NSString\"8@?<v@?@\"NSString\">16"

```
