## apsd

> `/System/Library/PrivateFrameworks/ApplePushService.framework/apsd`

```diff

-1133.100.1.0.0
-  __TEXT.__text: 0x108ff0
-  __TEXT.__auth_stubs: 0x3230
-  __TEXT.__objc_stubs: 0x10460
+1135.100.2.0.0
+  __TEXT.__text: 0x106fb0
+  __TEXT.__auth_stubs: 0x3210
+  __TEXT.__objc_stubs: 0x10120
   __TEXT.__init_offsets: 0xc
-  __TEXT.__objc_methlist: 0xb5e8
-  __TEXT.__objc_methname: 0x1a19f
-  __TEXT.__objc_classname: 0xe51
-  __TEXT.__objc_methtype: 0x51c0
-  __TEXT.__cstring: 0x10417
+  __TEXT.__objc_methlist: 0xb2f0
+  __TEXT.__objc_methname: 0x19d54
+  __TEXT.__objc_classname: 0xe08
+  __TEXT.__objc_methtype: 0x4da3
+  __TEXT.__cstring: 0x102dc
   __TEXT.__const: 0x7600
-  __TEXT.__oslogstring: 0x12fa7
-  __TEXT.__gcc_except_tab: 0x2730
+  __TEXT.__oslogstring: 0x12f97
+  __TEXT.__gcc_except_tab: 0x27d0
   __TEXT.__dlopen_cstrs: 0xae
   __TEXT.__constg_swiftt: 0x104c
-  __TEXT.__swift5_typeref: 0x7a0
+  __TEXT.__swift5_typeref: 0x7a8
   __TEXT.__swift5_reflstr: 0xb8d
   __TEXT.__swift5_fieldmd: 0x9f4
   __TEXT.__swift5_types: 0xc8
-  __TEXT.__swift5_capture: 0x2bc
+  __TEXT.__swift5_capture: 0x2dc
   __TEXT.__swift_as_entry: 0x48
   __TEXT.__swift_as_ret: 0x20
   __TEXT.__swift5_builtin: 0xc8
   __TEXT.__swift5_mpenum: 0x8
   __TEXT.__swift5_proto: 0x40
   __TEXT.__swift5_assocty: 0x78
-  __TEXT.__unwind_info: 0x3ed0
+  __TEXT.__unwind_info: 0x3e78
   __TEXT.__eh_frame: 0x320
-  __DATA_CONST.__auth_got: 0x1930
-  __DATA_CONST.__got: 0x8c0
-  __DATA_CONST.__auth_ptr: 0x1a0
-  __DATA_CONST.__const: 0x8cf0
-  __DATA_CONST.__cfstring: 0x7e20
-  __DATA_CONST.__objc_classlist: 0x3e0
-  __DATA_CONST.__objc_protolist: 0x278
+  __DATA_CONST.__auth_got: 0x1920
+  __DATA_CONST.__got: 0x810
+  __DATA_CONST.__auth_ptr: 0x1a8
+  __DATA_CONST.__const: 0x8e28
+  __DATA_CONST.__cfstring: 0x7ce0
+  __DATA_CONST.__objc_classlist: 0x3d8
+  __DATA_CONST.__objc_protolist: 0x260
   __DATA_CONST.__objc_imageinfo: 0x8
   __DATA_CONST.__objc_protorefs: 0x90
-  __DATA_CONST.__objc_superrefs: 0x2b8
-  __DATA_CONST.__objc_intobj: 0x360
-  __DATA_CONST.__objc_arraydata: 0x68
+  __DATA_CONST.__objc_superrefs: 0x2b0
+  __DATA_CONST.__objc_intobj: 0x330
+  __DATA_CONST.__objc_arraydata: 0x58
   __DATA_CONST.__objc_dictobj: 0xc8
-  __DATA_CONST.__objc_arrayobj: 0x30
+  __DATA_CONST.__objc_arrayobj: 0x18
   __DATA_CONST.__objc_doubleobj: 0x10
-  __DATA.__objc_const: 0x1b4c8
-  __DATA.__objc_selrefs: 0x5570
-  __DATA.__objc_ivar: 0xbd8
-  __DATA.__objc_data: 0x3010
-  __DATA.__data: 0x4258
-  __DATA.__bss: 0xd28
+  __DATA.__objc_const: 0x1a548
+  __DATA.__objc_selrefs: 0x5440
+  __DATA.__objc_ivar: 0xb74
+  __DATA.__objc_data: 0x2fc0
+  __DATA.__data: 0x4138
+  __DATA.__bss: 0xd48
   __DATA.__common: 0x1b8
   - /System/Library/Frameworks/CFNetwork.framework/CFNetwork
   - /System/Library/Frameworks/CoreFoundation.framework/CoreFoundation

   - /usr/lib/swift/libswift_Builtin_float.dylib
   - /usr/lib/swift/libswift_Concurrency.dylib
   - /usr/lib/swift/libswiftos.dylib
-  UUID: 11096B32-D49D-3259-9E35-D50AB92C2EDD
-  Functions: 6284
-  Symbols:   1148
-  CStrings:  9454
+  UUID: 43FF5BFF-5B5D-3D93-8D08-CDCE42D76AB8
+  Functions: 6246
+  Symbols:   1128
+  CStrings:  9368
 
Symbols:
+ _$s10Foundation4DateV18addingTimeIntervalyACSdF
+ _mach_continuous_time
+ _mach_timebase_info
- _CFCopyDescription
- _CFReadStreamScheduleWithRunLoop
- _CFReadStreamSetClient
- _CFWriteStreamScheduleWithRunLoop
- _NSURLAuthenticationMethodServerTrust
- _OBJC_CLASS_$_NSOperationQueue
- _OBJC_CLASS_$_NSURLCredential
- __kCFStreamPropertyEnableConnectionStatistics
- __kCFStreamPropertyLocalAddressPreference
- __kCFStreamPropertyNPNProtocolsAvailable
- __kCFStreamPropertyNoCompanion
- __kCFStreamPropertySSLClientCertificateState
- __kCFStreamPropertyTCPInfo
- __kCFStreamSocketSetNoDelay
- _inet_pton
- _kCFStreamPropertyDataConnectionServiceType
- _kCFStreamPropertyDataContextOnDemand
- _kCFStreamPropertyNoCellular
- _kCFStreamPropertySSLSettings
- _kCFStreamSSLPeerName
- _kCFStreamSSLValidatesCertificateChain
- _kCTDataConnectionServiceTypeInternet
- _nw_parameters_set_companion_preference
CStrings:
+ "%@ Not doing anything, linger power assertion is still around. power assertion count %ld"
+ "%@ all couriers have finished processing server bag"
+ "%@ checking if identity provider has identity to connect"
+ "%@ checking if main user courier is ready to connect"
+ "%@ underlying identity provider has identity to connect? %@"
+ "%@ user courier finished processing server bag (%ld/%ld)"
+ "%@ user courier processing updated APSConfig"
+ "%@ user courier ready to connect? %@"
+ "%@-lastpowerassertionlinger"
+ "%@: Can offload: %@; heuristics allow? %@; hardware supported? %@; in offloading population? %@"
+ "%@: Delegates have processed server bag update, checking if stream should connect"
+ "%@: Holding power assertion %@ with type %@"
+ "%@: Identity provider has processed server bag update, user courier finished processing config"
+ "%@: Release of power assertion %@ will cause sleep imminently"
+ "%@: Releasing power assertion %@ but with %d now outstanding"
+ "%@: told not to connect!"
+ "%@: we have an identity available, connect to server!"
+ "MultiClientIdentityProvider finished process server bag update"
+ "MultiClientIdentityProvider, currentIdentityProvider: %s, shouldIdentityBeAvailable:%{bool}d"
+ "NoIdleSleepAssertion"
+ "T@\"NSObject<OS_dispatch_queue>\",&,N,V_queue"
+ "T@\"NSObject<OS_dispatch_source>\",&,N,V_timer"
+ "TI,N,V_powerAssertion"
+ "Td,N,V_timeout"
+ "Told not to connect after fetching server bag: %@ - closing stream"
+ "_APSPowerAssertion_MacOnly"
+ "_onQueue_clear"
+ "_onQueue_hold"
+ "checkIdentityIsAvailable:hasExistingToken:"
+ "courierConnection:receivedServerBag:finishedProcessingServerBagBlock:"
+ "courierConnection:shouldConnect:"
+ "courierConnectionManager:receivedServerBag:finishedProcessingServerBagBlock:"
+ "courierConnectionManager:shouldConnectBlock:"
+ "isReadyToFetchIdentity"
+ "noteServerBagUpdate:finishedProcessingServerBagUpdateBlock:"
+ "powerAssertion"
+ "queue"
+ "setPowerAssertion:"
+ "setQueue:"
+ "setTimeout:"
+ "setTimer:"
+ "setUseInteractivePowerAssertion called with %@.  Current power assertion type %@."
+ "shouldConnectToCourier:"
+ "tcpStream:receivedServerBag:processedServerBagBlock:"
+ "tcpStream:shouldConnect:"
+ "timer"
+ "updateForReceivedConfig:finishedProcessingConfigBlock:"
+ "v28@0:8@?<v@?B>16B24"
+ "v32@0:8@\"<APSTCPStream>\"16@?<v@?B>24"
+ "v32@0:8@\"APSConfiguration\"16@?<v@?>24"
+ "v32@0:8@\"APSCourierConnection\"16@?<v@?B>24"
+ "v32@0:8@\"APSCourierConnectionManager\"16@?<v@?B>24"
+ "v32@0:8@16@?24"
+ "v40@0:8@\"<APSTCPStream>\"16@\"APSConfiguration\"24@?<v@?>32"
+ "v40@0:8@\"APSCourierConnection\"16@\"APSConfiguration\"24@?<v@?>32"
+ "v40@0:8@\"APSCourierConnectionManager\"16@\"APSConfiguration\"24@?<v@?>32"
- " %s: %@ received nil streams, readStream %@ writeStream %@"
- "\"%@\" ([%@]:%@, [%@]:%@)"
- "%@ Copying local sockaddr {address: %s, port: %d}"
- "%@ Copying remote sockaddr {address: %s, port: %d}"
- "%@ Set _kCFStreamSocketSetNoDelay = %@"
- "%@ Unable to get interface name after stream is opened"
- "%@ asked to write data on suspended stream"
- "%@ didBecomeInvalidWithError: Received error on the session task: %@"
- "%@ didBecomeInvalidWithError: Received error: %@ when the stream is not open"
- "%@ didCompleteWithError: Received error %@ when the stream is not open"
- "%@ didCompleteWithError: Received error on the session task: %@"
- "%@ didReceiveChallenge: _hasCompletedTLSHandshake: %d _peerCertificateIsAuthorized : %d"
- "%@ got error when stream is opened %@"
- "%@ npnSelectedProtocols: %@"
- "%@ sslHostname: %@ peerName: %@"
- "%@: Attempt to re-create the streams at %@"
- "%@: Data received on stream that is not open"
- "-[APSTCPStream URLSession:streamTask:didBecomeInputStream:outputStream:]"
- "<APSTCPStream: %p> TCPStream closed in call to tcpStreamHasConnected: -- returning"
- "@\"NSInputStream\""
- "@\"NSOutputStream\""
- "@\"NSURLSession\""
- "@\"NSURLSessionStreamTask\""
- "APSPowerAssertion_NoHold"
- "APSTCPStream %@ got config %@  -- opened? %@"
- "APSTCPStream.m"
- "LOG_BUFFER"
- "MultiClientIdentityProvider, currentIdentityProvider: %s, isIdentityAvailable:%{bool}d"
- "NPN Selected protocol components: %@"
- "NSURLSessionDelegate"
- "NSURLSessionStreamDelegate"
- "NSURLSessionTaskDelegate"
- "Opening streams"
- "URLSession:betterRouteDiscoveredForStreamTask:"
- "URLSession:didBecomeInvalidWithError:"
- "URLSession:didCreateTask:"
- "URLSession:didReceiveChallenge:completionHandler:"
- "URLSession:readClosedForStreamTask:"
- "URLSession:streamTask:didBecomeInputStream:outputStream:"
- "URLSession:task:didCompleteWithError:"
- "URLSession:task:didFinishCollectingMetrics:"
- "URLSession:task:didReceiveChallenge:completionHandler:"
- "URLSession:task:didReceiveInformationalResponse:"
- "URLSession:task:didSendBodyData:totalBytesSent:totalBytesExpectedToSend:"
- "URLSession:task:needNewBodyStream:"
- "URLSession:task:needNewBodyStreamFromOffset:completionHandler:"
- "URLSession:task:willBeginDelayedRequest:completionHandler:"
- "URLSession:task:willPerformHTTPRedirection:newRequest:completionHandler:"
- "URLSession:taskIsWaitingForConnectivity:"
- "URLSession:writeClosedForStreamTask:"
- "URLSessionDidFinishEventsForBackgroundURLSession:"
- "Unable to copy sockaddr {address: %s, port: %d}"
- "UseNWConnectionTCPStream"
- "^{sockaddr=CC[14c]}16@0:8"
- "_copyLocalSockAddr"
- "_copyRemoteSockAddr"
- "_copyServerIPAddressString"
- "_hasBytesAvailable"
- "_hasCompletedTLSHandshake"
- "_hasSpaceAvailable"
- "_incompleteCurrentTaskTransactionMetrics"
- "_kCFStreamPropertyConnectionStatistics"
- "_kCFStreamPropertyNPNSelectedProtocol"
- "_kCFStreamPropertyPrefersNoProxy"
- "_kCFStreamPropertyWakeReadEvent"
- "_kCFStreamStatsConnectionEstablishmentTimeMs"
- "_kCFStreamStatsDNS_ResolutionTimeMs"
- "_kCFStreamStatsTLS_HandshakeTimeMs"
- "_peerCertificateIsAuthorized"
- "_readStream"
- "_streamTask"
- "_urlSession"
- "_writeStream"
- "authenticationMethod"
- "cancel"
- "captureStreams"
- "configureWhetherPeerIsTrustedFor:"
- "connectionStatistics: %@ secureHandshakeEnabled %@"
- "courierConnection:receivedServerBag:"
- "courierConnectionManager:receivedServerBag:"
- "credentialForTrust:"
- "defaultSessionConfiguration"
- "hasSpaceAvailable"
- "isIdentityAvailable"
- "kCFStreamPropertyAutoErrorOnSystemChange"
- "kCFStreamPropertyInterfaceIdentifier"
- "localAddress"
- "localPort"
- "mainQueue"
- "noteServerBagUpdate:"
- "open"
- "propertyForKey:"
- "protectionSpace"
- "read:maxLength:"
- "remoteAddress"
- "remotePort"
- "serverTrust"
- "sessionWithConfiguration:delegate:delegateQueue:"
- "setAllowsCellularAccess:"
- "setNetworkServiceType:"
- "setTLSMinimumSupportedProtocolVersion:"
- "set_socketStreamProperties:"
- "startSecureConnection"
- "streamError"
- "streamStatus"
- "streamTaskWithHostName:port:"
- "taskTransactionMetrics"
- "tcpStream:receivedServerBag:"
- "tcpStreamClass"
- "updateForReceivedConfig:"
- "v24@0:8@\"APSConfiguration\"16"
- "v24@0:8@\"NSURLSession\"16"
- "v24@0:8^^{__SecTrust}16"
- "v32@0:8@\"<APSTCPStream>\"16@\"APSConfiguration\"24"
- "v32@0:8@\"APSCourierConnection\"16@\"APSConfiguration\"24"
- "v32@0:8@\"APSCourierConnectionManager\"16@\"APSConfiguration\"24"
- "v32@0:8@\"NSURLSession\"16@\"NSError\"24"
- "v32@0:8@\"NSURLSession\"16@\"NSURLSessionStreamTask\"24"
- "v32@0:8@\"NSURLSession\"16@\"NSURLSessionTask\"24"
- "v40@0:8@\"NSURLSession\"16@\"NSURLAuthenticationChallenge\"24@?<v@?q@\"NSURLCredential\">32"
- "v40@0:8@\"NSURLSession\"16@\"NSURLSessionTask\"24@\"NSError\"32"
- "v40@0:8@\"NSURLSession\"16@\"NSURLSessionTask\"24@\"NSHTTPURLResponse\"32"
- "v40@0:8@\"NSURLSession\"16@\"NSURLSessionTask\"24@\"NSURLSessionTaskMetrics\"32"
- "v40@0:8@\"NSURLSession\"16@\"NSURLSessionTask\"24@?<v@?@\"NSInputStream\">32"
- "v48@0:8@\"NSURLSession\"16@\"NSURLSessionStreamTask\"24@\"NSInputStream\"32@\"NSOutputStream\"40"
- "v48@0:8@\"NSURLSession\"16@\"NSURLSessionTask\"24@\"NSURLAuthenticationChallenge\"32@?<v@?q@\"NSURLCredential\">40"
- "v48@0:8@\"NSURLSession\"16@\"NSURLSessionTask\"24@\"NSURLRequest\"32@?<v@?q@\"NSURLRequest\">40"
- "v48@0:8@\"NSURLSession\"16@\"NSURLSessionTask\"24q32@?<v@?@\"NSInputStream\">40"
- "v48@0:8@16@24@32@?40"
- "v48@0:8@16@24q32@?40"
- "v56@0:8@\"NSURLSession\"16@\"NSURLSessionTask\"24@\"NSHTTPURLResponse\"32@\"NSURLRequest\"40@?<v@?@\"NSURLRequest\">48"
- "v56@0:8@\"NSURLSession\"16@\"NSURLSessionTask\"24q32q40q48"
- "v56@0:8@16@24@32@40@?48"
- "v56@0:8@16@24q32q40q48"

```
