## IntelligencePlatformLibrary

> `/System/Library/PrivateFrameworks/IntelligencePlatformLibrary.framework/IntelligencePlatformLibrary`

```diff

-236.0.0.0.0
-  __TEXT.__text: 0x4d38bc
+243.0.0.0.0
+  __TEXT.__text: 0x4da04c
   __TEXT.__auth_stubs: 0x18f0
   __TEXT.__objc_methlist: 0x11e14
   __TEXT.__const: 0x4d018

   __TEXT.__swift5_types: 0x1224
   __TEXT.__swift5_reflstr: 0x1233a
   __TEXT.__swift5_assocty: 0x3308
-  __TEXT.__cstring: 0x66f53
+  __TEXT.__cstring: 0x68413
   __TEXT.__oslogstring: 0x19c
   __TEXT.__swift5_proto: 0x58c8
   __TEXT.__swift5_capture: 0x35f0
   __TEXT.__swift5_protos: 0x40
   __TEXT.__swift5_builtin: 0x5f0
   __TEXT.__swift5_mpenum: 0x5b8
-  __TEXT.__unwind_info: 0x18e20
+  __TEXT.__unwind_info: 0x18e98
   __TEXT.__eh_frame: 0x1fe14
   __TEXT.__objc_classname: 0x5a1c
   __TEXT.__objc_methname: 0x16ee3

   __DATA_CONST.__objc_protorefs: 0x10
   __DATA_CONST.__objc_superrefs: 0x60
   __AUTH_CONST.__auth_got: 0xc80
-  __AUTH_CONST.__const: 0x33b78
+  __AUTH_CONST.__const: 0x397d0
   __AUTH_CONST.__cfstring: 0xe300
   __AUTH_CONST.__objc_const: 0x21788
-  __AUTH.__objc_data: 0x63f0
-  __AUTH.__data: 0x28c8
+  __AUTH.__objc_data: 0x7238
+  __AUTH.__data: 0x29e0
   __DATA.__objc_ivar: 0x17b0
-  __DATA.__data: 0x93f0
+  __DATA.__data: 0x9410
   __DATA.__bss: 0x5e010
   __DATA.__common: 0x5b10
-  __DATA_DIRTY.__objc_data: 0x1618
-  __DATA_DIRTY.__data: 0x5d58
+  __DATA_DIRTY.__objc_data: 0x7d0
+  __DATA_DIRTY.__data: 0x5c28
   __DATA_DIRTY.__bss: 0xa1b0
   __DATA_DIRTY.__common: 0x18
   - /System/Library/Frameworks/Combine.framework/Combine

   - /usr/lib/swift/libswift_Concurrency.dylib
   - /usr/lib/swift/libswift_DarwinFoundation1.dylib
   - /usr/lib/swift/libswiftos.dylib
-  UUID: 9B84AC40-C9D0-3F2E-AFA5-DE1DCBF7485B
-  Functions: 48277
-  Symbols:   45474
-  CStrings:  13378
+  UUID: BA9F4894-80E5-3A45-8CEE-1CB586B144F6
+  Functions: 48712
+  Symbols:   45490
+  CStrings:  13379
 
CStrings:
+ "    {\"tableName\": \"walletOrder\", \"primaryKeyColumns\": [\"identifier\", \"referenceId\"], \"columns\": [[\"subject\", \"INTEGER\"], [\"identifier\", \"TEXT\"], [\"orderNumber\", \"TEXT\"], [\"referenceEntityIdType\", \"TEXT\"], [\"referenceId\", \"INTEGER\"]], \"subjectIdentifierColumn\": \"subject\", \"indexes\": [{\"name\": \"WalletOrderSubject_idx\", \"columns\": [\"subject\"]}]}"
+ "    {\"tableName\": \"walletOrderPerson\", \"columns\": [[\"subject\", \"INTEGER\"], [\"identifier\", \"TEXT\"], [\"name\", \"TEXT\"], [\"street\", \"TEXT\"], [\"city\", \"TEXT\"], [\"state\", \"TEXT\"], [\"country\", \"TEXT\"], [\"postal\", \"TEXT\"], [\"phone\", \"TEXT\"], [\"email\", \"TEXT\"], [\"rawAddress\", \"TEXT\"]], \"subjectIdentifierColumn\": \"subject\"}"
+ "05864b9a0d5c4d6ea283e5096c7e101588a655c9fdba7271d3ab9a2bf45d3b54"
+ "0dae6363-bdb3-4e63-874d-1009814b2acc"
+ "14b07a19-5c69-43eb-b6e3-05b8da77b8d6"
+ "241ed73c187956bcaa446fec1e0a20428175ccbe7c091dbc45d5f48d957cef27"
+ "2613da96538acea25beaa5ad782f655b6ad17f326a00e4f456fc702921ea3a33"
+ "267ee20b-fa23-4d32-a85f-1c546fae72ad"
+ "2d35ae1d-007d-4bb9-b74b-838982432447"
+ "3a723bf4-5a00-411e-88b8-eaf9a0de0eac"
+ "3bc00097-4d92-4b51-a63a-a3faada3b69e"
+ "405d589a4d718a23627f16a7eb4ee8383a54d493bd327190ee95d856e90da8c5"
+ "471dc40995d798b15535124b1d108aa0ea4208cdf0d45ddfd0f8628bafc99d10"
+ "4b800527e9bc0222c8b6db6f8e82e54ee60472327eff0a83f2bf37a12fa91066"
+ "61306782-5483-4ef1-95af-1383dfc68d2b"
+ "6adaf600-d3d9-4cb2-a059-73a9a8b628e8"
+ "6c16ff1324a54dff47fe0cb47b78cf9790f86fb4ed09bbbc5099e66721487c75"
+ "71a4b13e336acb2c4e0e05ef4a4d9184c4f329a684e18bfd8c070d572331afa5"
+ "921b460b59498f750c4a21685a0ea5dfab61dcd91286ab935391381176cedf30"
+ "92a847d3-278a-454b-ac84-87b3d980b614"
+ "96f9bd64-6f59-4cb4-a129-2527490d1f67"
+ "a7e9502c7b95af86742d994fc780188ac81de723aa1594fbbe56d96a935ff328"
+ "abff9c36b3aa5c23428010f8bafd538d2ef0f106df2d8be79030c1a8811aed6b"
+ "ad2a3e189ce7f2d50f9af4fa3db3eb7389e22744f73c4993270741f7cc9239c4"
+ "bb56e5de40b618fbafd3938060f68772ec456cd346e4eb48ec1ddf91daa5e3f9"
+ "bc70f166-d274-4a2b-823d-1c5c95e77bdc"
+ "bfa291046ece1b2ff022e6f2af45dca0892930991d5f41037c923a63b47ca79c"
+ "c7d29143-bce4-4f7f-a720-aed83442e337"
+ "d97930fa-0acb-4f07-9cc1-4e0d80cb7c64"
+ "e7668ab7-2388-45e2-876b-253d69505cf4"
+ "f667d05c-f450-4330-833d-b9c739dec19a"
+ "f7229cbe2459d45e5a6ada3353930f0c88dc783fd1a1471ea2ad88f30753705a"
+ "{\"configHash\": \"05864b9a0d5c4d6ea283e5096c7e101588a655c9fdba7271d3ab9a2bf45d3b54\", \"dependencies\": [], \"dependents\": [], \"deployment\": [\"production\"], \"featureFlag\": \"OrionSQL\", \"legacyName\": \"software\", \"name\": \"Software\", \"platforms\": {\"iOS\": \"18.0\", \"macOS\": \"15.0\"}, \"sql\": {\"update\": \"WITH SoftwareSubjects AS MATERIALIZED (\\n  -- NOTE: If we trust that subject_cond contains only Software subjects, this may not be needed.\\n  -- For now, this table enforces that the subjects we consider are Software subjects\\n  SELECT DISTINCT\\n    subject\\n  FROM\\n    \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\"\\n  WHERE\\n    predicate = 'PS1'\\n    AND object = 'SB144'\\n    AND $SUBJECT_COND(subject)\\n), SoftwareSubgraph AS MATERIALIZED (\\n  -- PERF: Failing to materialize this subgraph leads to extremely large processing times when there are many subjects\\n  SELECT\\n    subject,\\n    predicate,\\n    object,\\n    relationshipPredicate,\\n    relationshipId\\n  FROM\\n    \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\"\\n  WHERE\\n    subject IN (SELECT subject FROM SoftwareSubjects)\\n), OrganizationSubgraph AS MATERIALIZED (\\n  -- TODO: re-create's' the organization subgraph from the entire KG even for incremental Software updates\\n  -- PERF: Materializing this subgraph is preferable\\n  SELECT\\n    g1.subject,\\n    g1.predicate,\\n    g1.object,\\n    g1.relationshipPredicate,\\n    g1.relationshipId\\n  FROM\\n    \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\" g1\\n    JOIN \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\" g2 ON g1.subject = g2.subject\\n  WHERE\\n    g2.predicate = 'PS1'\\n    AND g2.object = 'SB10'\\n), SoftwareName AS MATERIALIZED (\\n  -- PERF: Materializing this subgraph is preferable\\n  SELECT subject, object as name\\n  FROM SoftwareSubgraph\\n  WHERE predicate = 'PS33'\\n), SoftwareBundleIdentifier AS (\\n  SELECT subject, object as bundleIdentifier\\n  FROM SoftwareSubgraph\\n  WHERE predicate = 'nm_bundleID'\\n), SoftwareAppIdentifier AS (\\n  SELECT subject, object as applicationIdentifier\\n  FROM SoftwareSubgraph\\n  WHERE predicate = 'nm_applicationIdentifier'\\n), SoftwarePublisher AS (\\n  SELECT p.subject, json_group_object(\\n    CASE WHEN o.predicate = 'PS33' THEN 'name' WHEN o.predicate = 'nm_phoneticName' THEN 'phoneticName' WHEN o.predicate = 'PS548' THEN 'department' WHEN o.predicate = 'nm_teamIdentifier' THEN 'teamIdentifier' END,\\n    o.object\\n  ) as publishedBy\\n  FROM SoftwareSubgraph p JOIN OrganizationSubgraph o ON p.object = o.subject\\n  WHERE p.predicate = 'PS194'\\n  AND o.predicate IN ('PS33', 'nm_phoneticName', 'PS548', 'nm_teamIdentifier')\\n  GROUP BY p.subject\\n), SoftwareRepeated AS (\\nSELECT\\n  s.subject,\\n  SoftwareName.name,\\n  SoftwareBundleIdentifier.bundleIdentifier,\\n  SoftwareAppIdentifier.applicationIdentifier,\\n  SoftwarePublisher.publishedBy\\nFROM\\n  SoftwareSubjects AS s\\n  LEFT JOIN SoftwareName ON s.subject = SoftwareName.subject\\n  LEFT JOIN SoftwareBundleIdentifier ON s.subject = SoftwareBundleIdentifier.subject\\n  LEFT JOIN SoftwareAppIdentifier ON s.subject = SoftwareAppIdentifier.subject\\n  LEFT JOIN SoftwarePublisher ON s.subject = SoftwarePublisher.subject\\n), SoftwareRanked AS (\\n  SELECT\\n    *,\\n    ROW_NUMBER() OVER (PARTITION BY subject) AS rn\\n  FROM\\n    SoftwareRepeated\\n)\\n\\nSELECT\\n  subject,\\n  'md:' || subject as identifier,\\n  name,\\n  bundleIdentifier,\\n  applicationIdentifier,\\n  publishedBy\\nFROM\\n  SoftwareRanked\\nWHERE\\n  rn = 1\\n\"}, \"target\": {\"database\": \"IntelligencePlatform.Entity\", \"name\": \"Software\", \"target\": \"IntelligencePlatform.Entity.Software\", \"type\": \"view\"}, \"type\": \"sqlConnection\", \"update\": {\"knowledgeGraphListeners\": [{\"filters\": [{\"entityType\": \"SB144\"}], \"schedule\": \"live\", \"stores\": [\"stableGraph\"]}]}, \"uuid\": \"22867F23-F8DB-4678-B75F-96CE567CC22B\", \"version\": \"c7d29143-bce4-4f7f-a720-aed83442e337\"}"
+ "{\"configHash\": \"241ed73c187956bcaa446fec1e0a20428175ccbe7c091dbc45d5f48d957cef27\", \"dependencies\": [], \"dependents\": [\"WalletOrderExtractedView\"], \"deployment\": [\"production\"], \"featureFlag\": \"OrionSQL\", \"legacyName\": \"WalletOrderPerson\", \"name\": \"WalletOrderPerson\", \"platforms\": {\"iOS\": \"18.0\"}, \"sql\": {\"update\": \"WITH WalletPersonSubjects AS MATERIALIZED (\\n  -- NOTE: If we trust that subject_cond contains only Person subjects, this may not be needed.\\n  -- For now, this table enforces that the subjects we consider are Person subjects\\n  SELECT DISTINCT\\n    subject\\n  FROM\\n    \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\"\\n  WHERE\\n    predicate = 'PS1'\\n    AND object = 'SB104'\\n    AND $SUBJECT_COND(subject)\\n),\\nPersonSubgraph AS MATERIALIZED (\\n  -- PERF: Failing to materialize this subgraph leads to extremely large processing times when there are many subjects\\n  SELECT\\n    subject,\\n    predicate,\\n    relationshipId,\\n    relationshipPredicate,\\n    object\\n  FROM\\n    \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\"\\n  WHERE\\n    subject IN (SELECT subject FROM WalletPersonSubjects)\\n),\\nWalletPersonNames AS MATERIALIZED (\\n  -- PERF: Failing to materialize this subgraph leads to extremely large processing times when there are many subjects\\n  SELECT\\n    subject,\\n    object AS name\\n  FROM\\n    PersonSubgraph\\n  WHERE\\n    predicate = 'PS313'\\n),\\nWalletPersonCityEntries AS MATERIALIZED (\\n  -- TODO: This flattens objects otherwise grouped by relationshipId\\n  SELECT\\n    subject,\\n    relationshipPredicate,\\n    object\\n  FROM\\n    PersonSubgraph\\n  WHERE\\n    predicate = 'PS520'\\n    AND relationshipId IN (\\n      SELECT\\n         relationshipId\\n      FROM\\n         PersonSubgraph\\n      WHERE\\n         predicate = 'PS520'\\n         AND relationshipPredicate = 'PS1'\\n         AND object = 'CS97'\\n    )\\n),\\nWalletPersonCityRecord AS (\\n  SELECT\\n    subject,\\n    object as city\\n  FROM\\n    WalletPersonCityEntries\\n  WHERE\\n    relationshipPredicate = 'PS453'\\n),\\nWalletPersonStreetRecord AS (\\n  SELECT\\n    subject,\\n    object as street\\n  FROM\\n    WalletPersonCityEntries\\n  WHERE\\n    relationshipPredicate = 'PS316'\\n),\\nWalletPersonRawAddressRecord AS (\\n  SELECT\\n    subject,\\n    object as rawAddress\\n  FROM\\n    WalletPersonCityEntries\\n  WHERE\\n    relationshipPredicate = 'PS581'\\n),\\nWalletPersonState AS (\\n  SELECT\\n    DISTINCT subject,\\n    object as state\\n  FROM\\n    WalletPersonCityEntries\\n  WHERE\\n    relationshipPredicate = 'PS455'\\n),\\nWalletPersonPostalRecord AS (\\n  SELECT\\n    DISTINCT subject,\\n    object as postal\\n  FROM\\n    WalletPersonCityEntries\\n  WHERE\\n    relationshipPredicate = 'PS315'\\n),\\nWalletPersonCountry AS (\\n  SELECT\\n    DISTINCT subject,\\n    object as country\\n  FROM\\n    WalletPersonCityEntries\\n  WHERE\\n    relationshipPredicate = 'PS450'\\n),\\nWalletPersonPhone AS (\\n  SELECT\\n    DISTINCT subject,\\n    object as phone\\n  FROM\\n    WalletPersonCityEntries\\n  WHERE\\n    relationshipPredicate = 'PS407'\\n),\\nWalletPersonEmail AS (\\n  SELECT\\n    DISTINCT subject,\\n    object as email\\n  FROM\\n    WalletPersonCityEntries\\n  WHERE\\n    relationshipPredicate = 'PS406'\\n),\\nWalletPersonRepeated AS (\\n  SELECT\\n    s.subject,\\n    WalletPersonNames.name,\\n    WalletPersonStreetRecord.street,\\n    WalletPersonCityRecord.city,\\n    WalletPersonState.state,\\n    WalletPersonPostalRecord.postal,\\n    WalletPersonCountry.country,\\n    WalletPersonPhone.phone,\\n    WalletPersonEmail.email,\\n    WalletPersonRawAddressRecord.rawAddress\\n  FROM\\n    WalletPersonSubjects as s\\n    LEFT JOIN WalletPersonNames ON s.subject = WalletPersonNames.subject\\n    LEFT JOIN WalletPersonCityRecord ON s.subject = WalletPersonCityRecord.subject\\n    LEFT JOIN WalletPersonState ON s.subject = WalletPersonState.subject\\n    LEFT JOIN WalletPersonPostalRecord ON s.subject = WalletPersonPostalRecord.subject\\n    LEFT JOIN WalletPersonCountry ON s.subject = WalletPersonCountry.subject\\n    LEFT JOIN WalletPersonPhone ON s.subject = WalletPersonPhone.subject\\n    LEFT JOIN WalletPersonEmail ON s.subject = WalletPersonEmail.subject\\n    LEFT JOIN WalletPersonStreetRecord ON s.subject = WalletPersonStreetRecord.subject\\n    LEFT JOIN WalletPersonRawAddressRecord ON s.subject = WalletPersonRawAddressRecord.subject\\n),\\nWalletPersonSubjectsFinal AS (\\n  SELECT\\n    *,\\n    ROW_NUMBER() OVER (PARTITION BY subject) AS rn\\n  FROM\\n    WalletPersonRepeated\\n)\\nSELECT\\n  subject,\\n  'md:' || subject AS identifier,\\n  name,\\n  street,\\n  city,\\n  state,\\n  country,\\n  postal,\\n  phone,\\n  email,\\n  rawAddress\\nFROM\\n  WalletPersonSubjectsFinal\\nWHERE\\n  rn = 1\\n\"}, \"target\": {\"database\": \"WalletPaymentsCommerce.Internal\", \"name\": \"WalletOrderPerson\", \"target\": \"WalletPaymentsCommerce.Internal.WalletOrderPerson\", \"type\": \"view\"}, \"type\": \"sqlConnection\", \"update\": {\"knowledgeGraphListeners\": [{\"filters\": [{\"entityType\": \"SB104\"}], \"requiredSource\": false, \"schedule\": \"live\", \"stores\": [\"stableGraph\"]}, {\"filters\": [{\"entityType\": \"SB104\"}], \"requiredSource\": false, \"schedule\": \"live\", \"source\": \"WalletClassicOrder\", \"stores\": [\"stableGraph\"]}, {\"filters\": [{\"entityType\": \"SB104\"}], \"requiredSource\": false, \"schedule\": \"live\", \"source\": \"WalletEmailOrder\", \"stores\": [\"stableGraph\"]}, {\"filters\": [{\"entityType\": \"SB104\"}], \"requiredSource\": false, \"schedule\": \"live\", \"source\": \"WalletTransactionOrder\", \"stores\": [\"stableGraph\"]}, {\"filters\": [{\"entityType\": \"SB104\"}], \"requiredSource\": false, \"schedule\": \"live\", \"source\": \"WalletTrackedOrder\", \"stores\": [\"stableGraph\"]}]}, \"uuid\": \"2692b131-570b-4094-bbb3-7287bbbe4d6b\", \"version\": \"0dae6363-bdb3-4e63-874d-1009814b2acc\"}"
+ "{\"configHash\": \"2613da96538acea25beaa5ad782f655b6ad17f326a00e4f456fc702921ea3a33\", \"dependencies\": [], \"dependents\": [\"WalletOrderExtractedView\"], \"deployment\": [\"production\"], \"featureFlag\": \"OrionSQL\", \"legacyName\": \"WalletOrderTransaction\", \"name\": \"WalletOrderTransaction\", \"platforms\": {\"iOS\": \"18.0\"}, \"sql\": {\"update\": \"WITH WalletTransactionSubjects AS MATERIALIZED (\\n  -- NOTE: If we trust that subject_cond contains only nm_transaction subjects, this may not be needed.\\n  -- For now, this table enforces that the subjects we consider are nm_transaction subjects\\n  SELECT DISTINCT\\n    subject\\n  FROM\\n    \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\"\\n  WHERE\\n    predicate = 'PS1'\\n    AND object = 'nm_transaction'\\n    AND $SUBJECT_COND(subject)\\n),\\nWalletTransactionSubgraph AS MATERIALIZED (\\n  -- PERF: Failing to materialize this subgraph leads to extremely large processing times when there are many subjects\\n  SELECT\\n    subject,\\n    predicate,\\n    object,\\n    relationshipPredicate,\\n    relationshipId\\n  FROM\\n    \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\"\\n  WHERE\\n    subject IN (SELECT subject FROM WalletTransactionSubjects)\\n),\\nCurrencyCode AS (\\nSELECT subject, object as currencyCode\\nFROM WalletTransactionSubgraph\\nWHERE predicate = 'nm_amount' AND relationshipPredicate = 'PS2'\\n), TotalAmount AS (\\nSELECT subject, object as totalAmount\\nFROM WalletTransactionSubgraph\\nWHERE predicate = 'nm_amount' AND relationshipPredicate = 'PS3'\\n), TrxAccountInstitution AS (\\nSELECT subject, object as accountInstitution\\nFROM WalletTransactionSubgraph\\nWHERE predicate = 'nm_accountInstitution'\\n), TrxAccountLastFourDigits AS (\\nSELECT subject, object as accountLastFourDigits\\nFROM WalletTransactionSubgraph\\nWHERE predicate = 'nm_accountLastFourDigits'\\n),TrxIdentifier AS (\\nSELECT subject, object as trxId\\nFROM WalletTransactionSubgraph\\nWHERE predicate = 'PS69'\\n),TrxDisplayName AS (\\nSELECT subject, object as trxDisplay\\nFROM WalletTransactionSubgraph\\nWHERE predicate = 'PS51'\\n), WalletTransactionsRepeated AS (\\nSELECT\\n  s.subject,\\n  CurrencyCode.currencyCode,\\n  TotalAmount.totalAmount,\\n  TrxAccountInstitution.accountInstitution,\\n  TrxAccountLastFourDigits.accountLastFourDigits,\\n  TrxIdentifier.trxId,\\n  TrxDisplayName.trxDisplay\\nFROM WalletTransactionSubjects as s\\nLEFT JOIN CurrencyCode ON s.subject = CurrencyCode.subject\\nLEFT JOIN TotalAmount ON s.subject = TotalAmount.subject\\nLEFT JOIN TrxAccountInstitution ON s.subject = TrxAccountInstitution.subject\\nLEFT JOIN TrxAccountLastFourDigits ON s.subject = TrxAccountLastFourDigits.subject\\nLEFT JOIN TrxIdentifier ON s.subject = TrxIdentifier.subject\\nLEFT JOIN TrxDisplayName ON s.subject = TrxDisplayName.subject\\n), WalletTransactionsRanked AS (\\n  SELECT *,\\n      ROW_NUMBER() OVER (PARTITION BY currencyCode, totalAmount, accountInstitution, accountLastFourDigits, trxId) as rn\\n  FROM WalletTransactionsRepeated\\n)\\n\\nSELECT\\n  subject,\\n  'md:' || subject AS identifier,\\n  currencyCode,\\n  totalAmount,\\n  accountInstitution,\\n  accountLastFourDigits,\\n  trxId,\\n  trxDisplay\\nFROM\\n  WalletTransactionsRanked\\nWHERE\\n  rn = 1\\n\"}, \"target\": {\"database\": \"WalletPaymentsCommerce.Internal\", \"name\": \"WalletOrderTransaction\", \"target\": \"WalletPaymentsCommerce.Internal.WalletOrderTransaction\", \"type\": \"view\"}, \"type\": \"sqlConnection\", \"update\": {\"knowledgeGraphListeners\": [{\"filters\": [{\"entityType\": \"nm_transaction\"}], \"requiredSource\": false, \"schedule\": \"live\", \"source\": \"WalletClassicOrder\", \"stores\": [\"stableGraph\"]}, {\"filters\": [{\"entityType\": \"nm_transaction\"}], \"requiredSource\": false, \"schedule\": \"live\", \"source\": \"WalletEmailOrder\", \"stores\": [\"stableGraph\"]}, {\"filters\": [{\"entityType\": \"nm_transaction\"}], \"requiredSource\": false, \"schedule\": \"live\", \"source\": \"WalletTransactionOrder\", \"stores\": [\"stableGraph\"]}, {\"filters\": [{\"entityType\": \"nm_transaction\"}], \"requiredSource\": false, \"schedule\": \"live\", \"source\": \"WalletTrackedOrder\", \"stores\": [\"stableGraph\"]}]}, \"uuid\": \"7C8D3B36-B9A9-4D1E-95F2-C5967ABA9238\", \"version\": \"e7668ab7-2388-45e2-876b-253d69505cf4\"}"
+ "{\"configHash\": \"405d589a4d718a23627f16a7eb4ee8383a54d493bd327190ee95d856e90da8c5\", \"dependencies\": [], \"dependents\": [], \"deployment\": [\"production\"], \"featureFlag\": \"OrionSQL\", \"legacyName\": \"FlightReservations\", \"name\": \"FlightReservations\", \"platforms\": {\"iOS\": \"18.0\", \"macOS\": \"15.0\"}, \"sql\": {\"update\": \"WITH FlightReservationSubjects AS MATERIALIZED (\\n  -- NOTE: If we trust that subject_cond contains only FlightReservation subjects, this may not be needed.\\n  -- For now, this table enforces that the subjects we consider are FlightReservation subjects\\n  SELECT DISTINCT\\n    subject\\n  FROM\\n    \\\"IntelligencePlatform.KnowledgeGraph.EventGraph\\\"\\n  WHERE\\n    predicate = 'PS1'\\n    AND object = 'SB514'\\n    AND $SUBJECT_COND(subject)\\n), FlightReservationSubgraph AS MATERIALIZED (\\n  -- PERF: Failing to materialize this subgraph leads to extremely large processing times when there are many subjects\\n  SELECT\\n    subject,\\n    predicate,\\n    object,\\n    relationshipPredicate,\\n    relationshipId\\n  FROM\\n    \\\"IntelligencePlatform.KnowledgeGraph.EventGraph\\\"\\n  WHERE\\n    subject IN (SELECT subject FROM FlightReservationSubjects)\\n), FlightReservationTitle AS (\\n  SELECT subject, object as title\\n  FROM FlightReservationSubgraph\\n  WHERE predicate = 'PS33'\\n),FlightReservationDescription AS (\\n  SELECT subject, object as description\\n  FROM FlightReservationSubgraph\\n  WHERE predicate = 'PS51'\\n), FlightReservationFlightNumber AS (\\n  SELECT subject, object as flightNumber\\n  FROM FlightReservationSubgraph\\n  WHERE predicate = 'nm_flightNumber'\\n), FlightReservationCarrierCode AS (\\n  SELECT subject, object as carrierCode\\n  FROM FlightReservationSubgraph\\n  WHERE predicate = 'nm_iataCode'\\n), DepartureAirportName as (\\n    SELECT F.subject, G.object as departureAirportName\\n    FROM FlightReservationSubgraph F\\n    JOIN \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\" G ON entityIdentifier(F.object) = G.subject\\n    WHERE F.predicate = 'PS248'\\n    AND G.predicate = 'PS33'\\n), DepartureAirportCode as (\\n    SELECT F.subject, G.object as departureAirportCode\\n    FROM FlightReservationSubgraph F\\n    JOIN \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\" G ON entityIdentifier(F.object) = G.subject\\n    WHERE F.predicate = 'PS248'\\n    AND G.predicate = 'nm_iataCode'\\n), DepartureAirportAddress as (\\n    SELECT F.subject, G.object as departureAirportAddress\\n    FROM FlightReservationSubgraph F\\n    JOIN \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\" G ON entityIdentifier(F.object) = G.subject\\n    WHERE F.predicate = 'PS248'\\n    AND G.predicate = 'nm_addressString'\\n), DepartureTime AS (\\n    SELECT subject, object as departureTime\\n    FROM FlightReservationSubgraph\\n    WHERE predicate = 'nm_hasDate' and relationshipPredicate = 'nm_imputedStartTime'\\n), DepartureAirportLatitude AS (\\n    SELECT F.subject, G.object as departureAirportLatitude\\n    FROM FlightReservationSubgraph F\\n    JOIN \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\" G ON entityIdentifier(F.object) = G.subject\\n    WHERE F.predicate = 'PS248'\\n    AND G.predicate = 'PS573'\\n    AND G.relationshipPredicate = 'PS571'\\n), DepartureAirportLongitude AS (\\n    SELECT F.subject, G.object as departureAirportLongitude\\n    FROM FlightReservationSubgraph F\\n    JOIN \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\" G ON entityIdentifier(F.object) = G.subject\\n    WHERE F.predicate = 'PS248'\\n    AND G.predicate = 'PS573'\\n    AND G.relationshipPredicate = 'PS572'\\n), ArrivalAirportName as (\\n    SELECT F.subject, G.object as arrivalAirportName\\n    FROM FlightReservationSubgraph F\\n    JOIN \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\" G ON entityIdentifier(F.object) = G.subject\\n    WHERE F.predicate = 'PS249'\\n    AND G.predicate = 'PS33'\\n), ArrivalAirportCode as (\\n    SELECT F.subject, G.object as arrivalAirportCode\\n    FROM FlightReservationSubgraph F\\n    JOIN \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\" G ON entityIdentifier(F.object) = G.subject\\n    WHERE F.predicate = 'PS249'\\n    AND G.predicate = 'nm_iataCode'\\n), ArrivalAirportAddress as (\\n    SELECT F.subject, G.object as arrivalAirportAddress\\n    FROM FlightReservationSubgraph F\\n    JOIN \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\" G ON entityIdentifier(F.object) = G.subject\\n    WHERE F.predicate = 'PS249'\\n    AND G.predicate = 'nm_addressString'\\n), ArrivalTime AS (\\n    SELECT subject, object as arrivalTime\\n    FROM FlightReservationSubgraph\\n    WHERE predicate = 'nm_hasDate' and relationshipPredicate = 'nm_imputedEndTime'\\n), ArrivalAirportLatitude AS (\\n    SELECT F.subject, G.object as arrivalAirportLatitude\\n    FROM FlightReservationSubgraph F\\n    JOIN \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\" G ON entityIdentifier(F.object) = G.subject\\n    WHERE F.predicate = 'PS249'\\n    AND G.predicate = 'PS573'\\n    AND G.relationshipPredicate = 'PS571'\\n), ArrivalAirportLongitude AS (\\n    SELECT F.subject, G.object as arrivalAirportLongitude\\n    FROM FlightReservationSubgraph F\\n    JOIN \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\" G ON entityIdentifier(F.object) = G.subject\\n    WHERE F.predicate = 'PS249'\\n    AND G.predicate = 'PS573'\\n    AND G.relationshipPredicate = 'PS572'\\n), PassengerNames AS (\\n    SELECT F1.subject, json_group_array(G.object) as passengerNames\\n    FROM FlightReservationSubgraph F1\\n    JOIN FlightReservationSubgraph F2 ON F1.relationshipId = F2.relationshipId\\n    JOIN \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\" G ON entityIdentifier(F2.object) = G.subject\\n    WHERE F1.predicate = 'PS232' AND F1.relationshipPredicate = 'PS1' AND F1.object = 'CS38'\\n        AND F2.relationshipPredicate = 'PS143'\\n        AND G.predicate = 'PS33'\\n    GROUP BY F1.subject\\n), ExtractionSource AS (\\n    SELECT subject, object as extractionSource\\n    FROM FlightReservationSubgraph\\n    WHERE predicate = 'nm_sourceType'\\n), FlightsRepeated AS (\\n  SELECT\\n    s.subject,\\n    FlightReservationTitle.title,\\n    FlightReservationDescription.description,\\n    FlightReservationFlightNumber.flightNumber,\\n    FlightReservationCarrierCode.carrierCode,\\n    DepartureAirportName.departureAirportName,\\n    DepartureAirportCode.departureAirportCode,\\n    DepartureAirportAddress.departureAirportAddress,\\n    DepartureAirportLatitude.departureAirportLatitude,\\n    DepartureAirportLongitude.departureAirportLongitude,\\n    DepartureTime.departureTime,\\n    ArrivalAirportName.arrivalAirportName,\\n    ArrivalAirportCode.arrivalAirportCode,\\n    ArrivalAirportAddress.arrivalAirportAddress,\\n    ArrivalAirportLatitude.arrivalAirportLatitude,\\n    ArrivalAirportLongitude.arrivalAirportLongitude,\\n    ArrivalTime.arrivalTime,\\n    PassengerNames.passengerNames,\\n    ExtractionSource.extractionSource\\n  FROM\\n    FlightReservationSubjects s\\n    LEFT JOIN FlightReservationTitle ON s.subject = FlightReservationTitle.subject\\n    LEFT JOIN FlightReservationDescription ON s.subject = FlightReservationDescription.subject\\n    LEFT JOIN FlightReservationFlightNumber ON s.subject = FlightReservationFlightNumber.subject\\n    LEFT JOIN FlightReservationCarrierCode ON s.subject = FlightReservationCarrierCode.subject\\n    LEFT JOIN DepartureAirportName ON s.subject = DepartureAirportName.subject\\n    LEFT JOIN DepartureAirportCode ON s.subject = DepartureAirportCode.subject\\n    LEFT JOIN DepartureAirportAddress ON s.subject = DepartureAirportAddress.subject\\n    LEFT JOIN DepartureTime ON s.subject = DepartureTime.subject\\n    LEFT JOIN DepartureAirportLatitude ON s.subject = DepartureAirportLatitude.subject\\n    LEFT JOIN DepartureAirportLongitude ON s.subject = DepartureAirportLongitude.subject\\n    LEFT JOIN ArrivalAirportName ON s.subject = ArrivalAirportName.subject\\n    LEFT JOIN ArrivalAirportCode ON s.subject = ArrivalAirportCode.subject\\n    LEFT JOIN ArrivalAirportAddress ON s.subject = ArrivalAirportAddress.subject\\n    LEFT JOIN ArrivalAirportLatitude ON s.subject = ArrivalAirportLatitude.subject\\n    LEFT JOIN ArrivalAirportLongitude ON s.subject = ArrivalAirportLongitude.subject\\n    LEFT JOIN ArrivalTime ON s.subject = ArrivalTime.subject\\n    LEFT JOIN PassengerNames ON s.subject = PassengerNames.subject\\n    LEFT JOIN ExtractionSource ON s.subject = ExtractionSource.subject\\n), FlightsRanked AS (\\n  SELECT\\n    *,\\n    ROW_NUMBER() OVER (PARTITION BY subject) AS rn\\n  FROM\\n    FlightsRepeated\\n)\\n\\nSELECT\\n    subject,\\n    'md:' || subject AS identifier,\\n    title,\\n    description,\\n    flightNumber,\\n    carrierCode,\\n    departureAirportName,\\n    departureAirportCode,\\n    departureAirportAddress,\\n    departureAirportLatitude,\\n    departureAirportLongitude,\\n    departureTime,\\n    arrivalAirportName,\\n    arrivalAirportCode,\\n    arrivalAirportAddress,\\n    arrivalAirportLatitude,\\n    arrivalAirportLatitude,\\n    arrivalTime,\\n    passengerNames,\\n    extractionSource\\nFROM FlightsRanked\\nWHERE rn = 1\\n\"}, \"target\": {\"database\": \"IntelligencePlatform.Entity\", \"name\": \"FlightReservations\", \"target\": \"IntelligencePlatform.Entity.FlightReservations\", \"type\": \"view\"}, \"type\": \"sqlConnection\", \"update\": {\"knowledgeGraphListeners\": [{\"filters\": [{\"entityType\": \"SB514\", \"sources\": [\"SGEvent\"]}], \"schedule\": \"live\", \"stores\": [\"eventGraph\"]}]}, \"uuid\": \"08EDDFCE-98BC-42F2-AE1F-96CDA2CF1DD5\", \"version\": \"bc70f166-d274-4a2b-823d-1c5c95e77bdc\"}"
+ "{\"configHash\": \"471dc40995d798b15535124b1d108aa0ea4208cdf0d45ddfd0f8628bafc99d10\", \"dependencies\": [], \"dependents\": [\"WalletOrderExtractedView\"], \"deployment\": [\"production\"], \"featureFlag\": \"OrionSQL\", \"legacyName\": \"WalletOrderFields\", \"name\": \"WalletOrderFields\", \"platforms\": {\"iOS\": \"18.0\"}, \"sql\": {\"update\": \"WITH WalletOrderSubjects AS MATERIALIZED (\\n  -- NOTE: If we trust that subject_cond contains only nm_walletOrder subjects, this may not be needed.\\n  -- For now, this table enforces that the subjects we consider are nm_walletOrder subjects\\n  SELECT DISTINCT\\n    subject\\n  FROM\\n    \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\"\\n  WHERE\\n    predicate = 'PS1'\\n    AND object = 'nm_walletOrder'\\n    AND $SUBJECT_COND(subject)\\n), WalletOrderSubgraph AS MATERIALIZED (\\n  -- PERF: Failing to materialize this subgraph leads to extremely large processing times when there are many subjects\\n  SELECT\\n    subject,\\n    predicate,\\n    object,\\n    relationshipPredicate,\\n    relationshipId\\n  FROM\\n    \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\"\\n  WHERE\\n    subject IN (SELECT subject FROM WalletOrderSubjects)\\n), WalletOrderNumber AS (\\nSELECT subject, object as orderNumber\\nFROM WalletOrderSubgraph\\nWHERE predicate = 'nm_orderNumber'\\n),\\nWalletOrderDates AS (\\nSELECT subject, predicate, object , relationshipId, relationshipPredicate\\nFROM WalletOrderSubgraph\\nWHERE predicate = 'nm_hasDate'\\n),\\nWalletOrderDateRecord AS (\\nSELECT subject, predicate, object , relationshipId, relationshipPredicate\\nFROM WalletOrderDates\\nWHERE predicate = 'nm_hasDate' AND object = 'orderDate'),\\nWalletOrderDateEntries AS (\\nSELECT WalletOrderDates.* from WalletOrderDateRecord LEFT JOIN WalletOrderDates ON WalletOrderDateRecord.relationshipId = WalletOrderDates.relationshipId\\n),\\nWalletOrderDateFinal AS (\\nSELECT subject, object as orderDate\\nFROM WalletOrderDateEntries\\nWHERE relationshipPredicate = 'nm_imputedOccurrenceDate'\\n),\\nWalletOrderUpdateDateRecord AS (\\nSELECT subject, predicate, object , relationshipId, relationshipPredicate\\nFROM WalletOrderDates\\nWHERE predicate = 'nm_hasDate' AND object = 'orderUpdateDate'),\\nWalletOrderUpdateDateEntries AS (\\nSELECT WalletOrderDates.* from WalletOrderUpdateDateRecord LEFT JOIN WalletOrderDates ON WalletOrderUpdateDateRecord.relationshipId = WalletOrderDates.relationshipId\\n),\\nWalletUpdateOrderDateFinal AS (\\nSELECT subject, object as orderUpdateDate\\nFROM WalletOrderUpdateDateEntries\\nWHERE relationshipPredicate = 'nm_imputedOccurrenceDate'\\n),\\nWalletHasIdentifiers AS (\\nSELECT subject, predicate, object , relationshipId, relationshipPredicate\\nFROM WalletOrderSubgraph\\nWHERE predicate = 'PS72'\\n),\\nWalletOrderTypeRecord AS (\\nSELECT subject, predicate, object , relationshipId, relationshipPredicate\\nFROM WalletHasIdentifiers\\nWHERE predicate = 'PS72' AND object = 'orderType'),\\nWalletOrderTypeEntries AS (\\nSELECT WalletHasIdentifiers.* from WalletOrderTypeRecord LEFT JOIN WalletHasIdentifiers ON WalletOrderTypeRecord.relationshipId = WalletHasIdentifiers.relationshipId\\n)\\n,orderTypeIdentifier AS (\\nSELECT subject, object as orderTypeIdentifier\\nFROM WalletOrderTypeEntries\\nWHERE predicate = 'PS72' AND relationshipPredicate = 'PS33'\\n),orderIdentifier AS (\\nSELECT subject, object as orderIdentifier\\nFROM WalletOrderTypeEntries\\nWHERE predicate = 'PS72' AND relationshipPredicate = 'PS69'\\n),\\nWalletTrackedOrderTypeRecord AS (\\nSELECT subject, predicate, object , relationshipId, relationshipPredicate\\nFROM WalletHasIdentifiers\\nWHERE predicate = 'PS72' AND object = 'trackedOrderIdentifier'),\\nWalletTrackedOrderTypeEntries AS (\\nSELECT WalletHasIdentifiers.* from WalletTrackedOrderTypeRecord LEFT JOIN WalletHasIdentifiers ON WalletTrackedOrderTypeRecord.relationshipId = WalletHasIdentifiers.relationshipId\\n)\\n,TrackedOrderIdentifier AS (\\nSELECT subject, object as trackedOrderIdentifier\\nFROM WalletTrackedOrderTypeEntries\\nWHERE predicate = 'PS72' AND relationshipPredicate = 'PS69'\\n),\\nWalletOrdersRepeated AS (\\n  SELECT\\n    s.subject,\\n    WalletOrderNumber.orderNumber,\\n    WalletOrderDateFinal.orderDate,\\n    orderTypeIdentifier.orderTypeIdentifier,\\n    orderIdentifier.orderIdentifier,\\n    TrackedOrderIdentifier.trackedOrderIdentifier,\\n    WalletUpdateOrderDateFinal.orderUpdateDate\\n  FROM\\n    WalletOrderSubjects AS s\\n    LEFT JOIN WalletOrderNumber ON s.subject = WalletOrderNumber.subject\\n    LEFT JOIN orderTypeIdentifier ON s.subject = orderTypeIdentifier.subject\\n    LEFT JOIN orderIdentifier ON s.subject = orderIdentifier.subject\\n    LEFT JOIN WalletOrderDateFinal ON s.subject = WalletOrderDateFinal.subject\\n    LEFT JOIN WalletUpdateOrderDateFinal ON s.subject = WalletUpdateOrderDateFinal.subject\\n    LEFT JOIN TrackedOrderIdentifier ON s.subject = TrackedOrderIdentifier.subject\\n)\\nSELECT DISTINCT\\n  subject,\\n  'md:' || subject AS identifier,\\n  orderNumber,\\n  orderDate,\\n  orderTypeIdentifier,\\n  orderIdentifier,\\n  trackedOrderIdentifier,\\n  orderUpdateDate\\nFROM\\n  WalletOrdersRepeated\\n\"}, \"target\": {\"database\": \"WalletPaymentsCommerce.Internal\", \"name\": \"WalletOrderFields\", \"target\": \"WalletPaymentsCommerce.Internal.WalletOrderFields\", \"type\": \"view\"}, \"type\": \"sqlConnection\", \"update\": {\"knowledgeGraphListeners\": [{\"filters\": [{\"entityType\": \"nm_walletOrder\"}], \"requiredSource\": false, \"schedule\": \"live\", \"source\": \"WalletClassicOrder\", \"stores\": [\"stableGraph\"]}, {\"filters\": [{\"entityType\": \"nm_walletOrder\"}], \"requiredSource\": false, \"schedule\": \"live\", \"source\": \"WalletEmailOrder\", \"stores\": [\"stableGraph\"]}, {\"filters\": [{\"entityType\": \"nm_walletOrder\"}], \"requiredSource\": false, \"schedule\": \"live\", \"source\": \"WalletTransactionOrder\", \"stores\": [\"stableGraph\"]}, {\"filters\": [{\"entityType\": \"nm_walletOrder\"}], \"requiredSource\": false, \"schedule\": \"live\", \"source\": \"WalletTrackedOrder\", \"stores\": [\"stableGraph\"]}]}, \"uuid\": \"BC6D1A82-3165-4C64-B6D5-E1FBDFE8EDC5\", \"version\": \"96f9bd64-6f59-4cb4-a129-2527490d1f67\"}"
+ "{\"configHash\": \"4b800527e9bc0222c8b6db6f8e82e54ee60472327eff0a83f2bf37a12fa91066\", \"dependencies\": [], \"dependents\": [\"WalletOrderExtractedView\"], \"deployment\": [\"production\"], \"featureFlag\": \"OrionSQL\", \"legacyName\": \"WalletTrackedOrderFields\", \"name\": \"WalletTrackedOrderFields\", \"platforms\": {\"iOS\": \"18.0\"}, \"sql\": {\"update\": \"WITH WalletOrderSubjects AS MATERIALIZED (\\n  -- NOTE: If we trust that subject_cond contains only WalletOrder subjects, this may not be needed.\\n  -- For now, this table enforces that the subjects we consider are WalletOrder subjects\\n  SELECT DISTINCT\\n    subject\\n  FROM\\n    \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\"\\n  WHERE\\n    predicate = 'PS1'\\n    AND object = 'nm_walletOrder'\\n    AND $SUBJECT_COND(subject)\\n),\\nWalletOrderSubgraph AS MATERIALIZED (\\n  -- PERF: Failing to materialize this subgraph leads to extremely large processing times when there are many subjects\\n  SELECT\\n    subject,\\n    predicate,\\n    object,\\n    relationshipPredicate,\\n    relationshipId\\n  FROM\\n    \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\"\\n  WHERE\\n    subject IN (SELECT subject FROM WalletOrderSubjects)\\n),\\nWalletOrderNumber AS (\\n  SELECT\\n    subject,\\n    object as orderNumber\\n  FROM\\n    WalletOrderSubgraph\\n  WHERE\\n    predicate = 'nm_orderNumber'\\n),\\nWalletHasIdentifiers AS (\\n  SELECT\\n    subject,\\n    predicate,\\n    object,\\n    relationshipId,\\n    relationshipPredicate\\n  FROM\\n    WalletOrderSubgraph\\n  WHERE\\n    predicate = 'PS72'\\n),\\nWalletTrackedOrderTypeRecord AS (\\n  SELECT\\n    subject,\\n    predicate,\\n    object,\\n    relationshipId,\\n    relationshipPredicate\\n  FROM\\n    WalletHasIdentifiers\\n  WHERE\\n    predicate = 'PS72'\\n    AND object = 'trackedOrderDetails'\\n),\\nWalletTrackedOrderTypeEntries AS (\\n  SELECT\\n    WalletHasIdentifiers.*\\n  from\\n    WalletTrackedOrderTypeRecord\\n    LEFT JOIN WalletHasIdentifiers ON WalletTrackedOrderTypeRecord.relationshipId = WalletHasIdentifiers.relationshipId\\n),\\nTrackedOrderDetails AS (\\n  SELECT\\n    subject,\\n    object as trackedOrderDetailJson\\n  FROM\\n    WalletTrackedOrderTypeEntries\\n  WHERE\\n    predicate = 'PS72'\\n    AND relationshipPredicate = 'PS69'\\n)\\nSELECT\\n  subject,\\n  'md:' || subject AS identifier,\\n  json_extract(trackedOrderDetailJson, '$.merchantName') trkMerchantName,\\n  json_extract(trackedOrderDetailJson, '$.domainName') trkDomainName,\\n  json_extract(trackedOrderDetailJson, '$.orderStatus') trkOrderStatus,\\n  json_extract(trackedOrderDetailJson, '$.orderDate') trkOrderDate,\\n  json_extract(trackedOrderDetailJson, '$.trackingNumber') trkTrackingNumber,\\n  json_extract(trackedOrderDetailJson, '$.orderNumber') trkOrderNumber,\\n  json_extract(trackedOrderDetailJson, '$.earliestEmailDateSent') earliestEmailDateSent,\\n  json_extract(trackedOrderDetailJson, '$.displayNameUpdateDate') merchantNameUpdateDate,\\n  json_extract(trackedOrderDetailJson, '$.orderStatusUpdateDate') orderStatusUpdateDate\\nFROM\\n  TrackedOrderDetails\\n\"}, \"target\": {\"database\": \"WalletPaymentsCommerce.Internal\", \"name\": \"WalletTrackedOrderFields\", \"target\": \"WalletPaymentsCommerce.Internal.WalletTrackedOrderFields\", \"type\": \"view\"}, \"type\": \"sqlConnection\", \"update\": {\"knowledgeGraphListeners\": [{\"filters\": [{\"entityType\": \"nm_walletOrder\"}], \"requiredSource\": false, \"schedule\": \"live\", \"source\": \"WalletTrackedOrder\", \"stores\": [\"stableGraph\"]}]}, \"uuid\": \"BC6D1A82-3165-4C64-B6D5-E1FBDFE8EDC5\", \"version\": \"3a723bf4-5a00-411e-88b8-eaf9a0de0eac\"}"
+ "{\"configHash\": \"6c16ff1324a54dff47fe0cb47b78cf9790f86fb4ed09bbbc5099e66721487c75\", \"dependencies\": [], \"dependents\": [], \"deployment\": [\"production\"], \"featureFlag\": \"OrionSQL\", \"legacyName\": \"person\", \"name\": \"Person\", \"platforms\": {\"iOS\": \"18.0\", \"macOS\": \"15.0\"}, \"sql\": {\"update\": \"WITH PersonSubjects AS MATERIALIZED (\\n  -- NOTE: If we trust that subject_cond contains only Person subjects, this may not be needed.\\n  -- For now, this table enforces that the subjects we consider are Person subjects\\n  SELECT DISTINCT\\n    subject\\n  FROM\\n    \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\"\\n  WHERE\\n    predicate = 'PS1'\\n    AND object = 'SB104'\\n    AND $SUBJECT_COND(subject)\\n), PersonSubgraph AS MATERIALIZED (\\n  -- PERF: Failing to materialize this subgraph leads to extremely large processing times when there are many subjects\\n  SELECT\\n    subject,\\n    predicate,\\n    object,\\n    relationshipPredicate,\\n    relationshipId\\n  FROM\\n    \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\"\\n  WHERE\\n    subject IN (SELECT subject FROM PersonSubjects)\\n), PersonIdentifiers AS (\\n  SELECT p1.subject, p1.object AS source, p2.object AS identifier\\n  FROM PersonSubgraph p1\\n  JOIN PersonSubgraph p2 ON p1.relationshipId = p2.relationshipId\\n  WHERE p1.predicate = 'PS72' AND p1.relationshipPredicate = 'PS396' AND p2.predicate = 'PS72' AND p2.relationshipPredicate = 'PS69'\\n), OrganizationSubgraph AS MATERIALIZED (\\n  -- TODO: re-create's' the organization subgraph from the entire KG even for incremental Person updates\\n  -- PERF: Materializing this subgraph is preferable\\n  SELECT\\n    g1.subject,\\n    g1.predicate,\\n    g1.object,\\n    g1.relationshipPredicate,\\n    g1.relationshipId\\n  FROM\\n    \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\" g1\\n    JOIN \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\" g2 ON g1.subject = g2.subject\\n  WHERE\\n    g2.predicate = 'PS1'\\n    AND g2.object = 'SB10'\\n), PersonName AS (\\n  SELECT subject, object as fullName\\n  FROM PersonSubgraph\\n  WHERE predicate = 'PS33'\\n), PersonFirstName AS (\\n  SELECT subject, json_group_array(object) as firstNames\\n  FROM PersonSubgraph\\n  WHERE predicate = 'PS312'\\n  GROUP BY subject\\n), PersonMiddleName AS (\\n  SELECT subject, json_group_array(object) as middleNames\\n  FROM PersonSubgraph\\n  WHERE predicate = 'PS546'\\n  GROUP BY subject\\n), PersonFamilyName AS (\\n  SELECT subject, json_group_array(object) as familyNames\\n  FROM PersonSubgraph\\n  WHERE predicate = 'PS441'\\n  GROUP BY subject\\n), PersonPhoneticName AS (\\n  SELECT subject, json_group_object(\\n    CASE WHEN predicate = 'nm_phoneticName' THEN 'name' WHEN predicate = 'nm_phoneticFirstName' THEN 'firstName' WHEN predicate = 'nm_phoneticMiddleName' THEN 'middleName' WHEN predicate = 'nm_phoneticFamilyName' THEN 'familyName' END,\\n    object\\n  ) as phoneticName\\n  FROM PersonSubgraph\\n  WHERE predicate IN ('nm_phoneticName', 'nm_phoneticFirstName', 'nm_phoneticMiddleName', 'nm_phoneticFamilyName')\\n  GROUP BY subject\\n), PersonAliases AS (\\n  SELECT subject, json_group_array(object) as aliases\\n  FROM PersonSubgraph\\n  WHERE predicate = 'nm_entityAliasRelationship' AND relationshipPredicate = 'PS89'\\n  GROUP BY subject\\n), PersonDOB AS (\\n  SELECT subject, object as dateOfBirth\\n  FROM PersonSubgraph\\n  WHERE predicate = 'nm_imputedBirthday'\\n), PersonCurrentUser AS (\\n  SELECT p1.subject, CASE WHEN p2.object = 'true' THEN 1 ELSE 0 END as isCurrentUser\\n  FROM PersonSubjects p1 LEFT JOIN\\n  (SELECT * FROM PersonSubgraph WHERE predicate = 'nm_isCurrentUser' ) p2 ON p1.subject = p2.subject\\n), PersonPrevFamilyName AS (\\n  SELECT subject, object as previousFamilyName\\n  FROM PersonSubgraph\\n  WHERE predicate = 'PS574'\\n), PersonVID AS (\\n  SELECT subject, json_group_array(object) as visualIdentifier\\n  FROM PersonSubgraph\\n  WHERE predicate = 'nm_hasVisualIdentifier' and relationshipPredicate = 'nm_visualIdentifier'\\n  GROUP BY subject\\n), PersonCID AS (\\n  SELECT subject, json_group_array(identifier) as contactIdentifier\\n  FROM PersonIdentifiers\\n  WHERE source = 'CNContact'\\n  GROUP BY subject\\n), PersonEmployer AS (\\n  SELECT p.subject, json_group_object(\\n    CASE WHEN o.predicate = 'PS33' THEN 'name' WHEN o.predicate = 'nm_phoneticName' THEN 'phoneticName' WHEN o.predicate = 'PS548' THEN 'department' WHEN o.predicate = 'nm_teamIdentifier' THEN 'teamIdentifier' END,\\n    o.object\\n  ) as employer\\n  FROM PersonSubgraph p JOIN OrganizationSubgraph o ON p.object = o.subject\\n  WHERE p.predicate = 'PS500' AND p.relationshipPredicate = 'PS45'\\n  AND o.predicate IN ('PS33', 'nm_phoneticName', 'PS548', 'nm_teamIdentifier')\\n  GROUP BY p.subject\\n), PersonURL AS (\\n  SELECT subject, json_group_array(object) as url\\n  FROM PersonSubgraph\\n  WHERE predicate = 'PS296'\\n  GROUP BY subject\\n), PersonRelationship AS (\\n  SELECT subject, json_group_array(json(rel)) as personRelationship\\n  FROM (\\n    SELECT subject, relationshipId, json_group_object(\\n      CASE WHEN relationshipPredicate = 'nm_relationshipLabel' THEN 'label' WHEN relationshipPredicate = 'nm_personIdentifier' THEN 'target' END,\\n      object\\n    ) as rel\\n    FROM PersonSubgraph\\n    WHERE predicate = 'PS598' and relationshipPredicate IN ('nm_relationshipLabel', 'nm_personIdentifier')\\n    GROUP BY subject, relationshipId\\n  )\\n  GROUP BY subject\\n), PersonLocation AS (\\n  SELECT subject, json_group_array(json(rel)) as location\\n  FROM (\\n    SELECT subject, json_group_object(\\n      CASE WHEN relationshipPredicate = 'PS733' THEN 'label' WHEN relationshipPredicate = 'PS107' THEN 'targetIdentifier' END,\\n      object\\n    ) as rel\\n    FROM PersonSubgraph\\n    WHERE predicate = 'PS225' and relationshipPredicate IN ('PS733', 'PS107')\\n    GROUP BY subject, relationshipId\\n  )\\n  GROUP BY subject\\n), PersonEmail AS (\\n  SELECT subject, json_group_array(json(email)) as emailAddresses\\n  FROM (\\n    SELECT p1.subject, json_object('label', p1.object, 'emailAddress', p2.object) as email\\n    FROM PersonSubgraph p1 JOIN PersonSubgraph p2 ON p1.relationshipId = p2.relationshipId\\n    WHERE p1.predicate = 'PS520' AND p1.relationshipPredicate = 'PS740' AND p2.relationshipPredicate = 'PS406'\\n    GROUP BY p1.subject, p1.relationshipId\\n  ) as res\\n  GROUP BY subject\\n), PersonNumber AS (\\n  SELECT subject, json_group_array(json(number)) as phoneNumbers\\n  FROM (\\n    SELECT p1.subject, json_object('label', p1.object, 'phoneNumber', p2.object) as number\\n    FROM PersonSubgraph p1 JOIN PersonSubgraph p2 ON p1.relationshipId = p2.relationshipId\\n    WHERE p1.predicate = 'PS520' AND p1.relationshipPredicate = 'PS740' AND p2.relationshipPredicate = 'PS407'\\n    GROUP BY p1.subject, p1.relationshipId\\n  ) as res\\n  GROUP BY subject\\n), PersonsRepeated AS (\\n    SELECT\\n      s.subject,\\n      PersonName.fullName,\\n      PersonFirstName.firstNames,\\n      PersonMiddleName.middleNames,\\n      PersonFamilyName.familyNames,\\n      NULL as names,\\n      PersonPhoneticName.phoneticName,\\n      PersonAliases.aliases,\\n      PersonDOB.dateOfBirth,\\n      PersonCurrentUser.isCurrentUser,\\n      PersonPrevFamilyName.previousFamilyName,\\n      PersonVID.visualIdentifier,\\n      PersonCID.contactIdentifier,\\n      PersonEmployer.employer,\\n      PersonURL.url,\\n      PersonRelationship.personRelationship,\\n      PersonLocation.location,\\n      PersonEmail.emailAddresses,\\n      PersonNumber.phoneNumbers\\n    FROM PersonSubjects s\\n    LEFT JOIN PersonName ON s.subject = PersonName.subject\\n    LEFT JOIN PersonFirstName ON s.subject = PersonFirstName.subject\\n    LEFT JOIN PersonMiddleName ON s.subject = PersonMiddleName.subject\\n    LEFT JOIN PersonFamilyName ON s.subject = PersonFamilyName.subject\\n    LEFT JOIN PersonPhoneticName ON s.subject = PersonPhoneticName.subject\\n    LEFT JOIN PersonAliases ON s.subject = PersonAliases.subject\\n    LEFT JOIN PersonDOB ON s.subject = PersonDOB.subject\\n    LEFT JOIN PersonCurrentUser ON s.subject = PersonCurrentUser.subject\\n    LEFT JOIN PersonPrevFamilyName ON s.subject = PersonPrevFamilyName.subject\\n    LEFT JOIN PersonVID ON s.subject = PersonVID.subject\\n    LEFT JOIN PersonCID ON s.subject = PersonCID.subject\\n    LEFT JOIN PersonEmployer ON s.subject = PersonEmployer.subject\\n    LEFT JOIN PersonURL ON s.subject = PersonURL.subject\\n    LEFT JOIN PersonRelationship ON s.subject = PersonRelationship.subject\\n    LEFT JOIN PersonLocation ON s.subject = PersonLocation.subject\\n    LEFT JOIN PersonEmail ON s.subject = PersonEmail.subject\\n    LEFT JOIN PersonNumber ON s.subject = PersonNumber.subject\\n), PersonsRanked AS (\\n    SELECT\\n      *,\\n      ROW_NUMBER() OVER (PARTITION BY subject) AS rn\\n    FROM\\n      PersonsRepeated\\n)\\n\\nSELECT\\n  subject,\\n  'md:' || subject AS identifier,\\n  fullName,\\n  firstNames,\\n  middleNames,\\n  familyNames,\\n  names,\\n  phoneticName,\\n  aliases,\\n  dateOfBirth,\\n  isCurrentUser,\\n  previousFamilyName,\\n  visualIdentifier,\\n  contactIdentifier,\\n  employer,\\n  url,\\n  personRelationship,\\n  location,\\n  emailAddresses,\\n  phoneNumbers\\nFROM\\n  PersonsRanked\\nWHERE\\n  rn = 1;\\n\"}, \"target\": {\"database\": \"IntelligencePlatform.Entity\", \"name\": \"Person\", \"target\": \"IntelligencePlatform.Entity.Person\", \"type\": \"view\"}, \"type\": \"sqlConnection\", \"update\": {\"knowledgeGraphListeners\": [{\"filters\": [{\"entityType\": \"SB104\"}], \"schedule\": \"live\", \"stores\": [\"stableGraph\"]}]}, \"uuid\": \"452B64BE-860F-45E7-A31E-3FBE288A01E8\", \"version\": \"f667d05c-f450-4330-833d-b9c739dec19a\", \"writeToStream\": true}"
+ "{\"configHash\": \"71a4b13e336acb2c4e0e05ef4a4d9184c4f329a684e18bfd8c070d572331afa5\", \"dependencies\": [], \"dependents\": [\"WalletOrderExtractedView\"], \"deployment\": [\"production\"], \"featureFlag\": \"OrionSQL\", \"legacyName\": \"WalletOrder\", \"name\": \"WalletOrder\", \"platforms\": {\"iOS\": \"18.0\"}, \"sql\": {\"update\": \"WITH WalletOrderSubjects AS MATERIALIZED (\\n  -- NOTE: If we trust that subject_cond contains only WalletOrder subjects, this may not be needed.\\n  -- For now, this table enforces that the subjects we consider are WalletOrder subjects\\n  SELECT DISTINCT\\n    subject\\n  FROM\\n    \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\"\\n  WHERE\\n    predicate = 'PS1'\\n    AND object = 'nm_walletOrder'\\n    AND $SUBJECT_COND(subject)\\n), WalletOrderSubgraph AS MATERIALIZED (\\n  SELECT\\n    subject,\\n    predicate,\\n    object,\\n    relationshipPredicate,\\n    relationshipId\\n  FROM\\n    \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\"\\n  WHERE\\n    subject IN (SELECT subject FROM WalletOrderSubjects)\\n),\\nWalletOrderNumber AS MATERIALIZED (\\n  SELECT\\n    subject,\\n    object AS orderNumber\\n  FROM\\n    WalletOrderSubgraph\\n  WHERE\\n    predicate = 'nm_orderNumber'\\n),\\nWalletOrderPaymentIdentifier AS (\\n  SELECT\\n    subject,\\n    object AS paymentIdentifier\\n  FROM\\n    WalletOrderSubgraph\\n  WHERE\\n    predicate = 'nm_hasPayment'\\n    AND relationshipPredicate = 'nm_paymentIdentifier'\\n),\\nWalletOrderTransactionIdentifier AS (\\n  SELECT\\n    subject,\\n    object AS transactionIdentifier\\n  FROM\\n    WalletOrderSubgraph\\n  WHERE\\n    predicate = 'nm_hasTransaction'\\n    AND relationshipPredicate = 'nm_transactionIdentifier'\\n),\\nWalletOrderEmailIdentifier AS (\\n  SELECT\\n    subject,\\n    object AS emailIdentifier\\n  FROM\\n    WalletOrderSubgraph\\n  WHERE\\n    predicate = 'nm_hasEmail'\\n    AND relationshipPredicate = 'nm_emailIdentifier'\\n),\\nWalletOrderShipmentFullFillmentIdentifier AS (\\n  SELECT\\n    subject,\\n    object AS shipmentFullFillmentIdentifier\\n  FROM\\n    WalletOrderSubgraph\\n  WHERE\\n    predicate = 'nm_hasShipmentFullFillment'\\n    AND relationshipPredicate = 'nm_shipmentFullFillmentIdentifier'\\n),\\nCustomerIdentifier AS (\\n  SELECT\\n    subject,\\n    object AS customerIdentifier\\n  FROM\\n    WalletOrderSubgraph\\n  WHERE\\n    (predicate = 'nm_hasPerson' OR predicate = 'PS598')\\n    AND relationshipPredicate = 'nm_personIdentifier'\\n),\\nMerchantIdentifier AS (\\n  SELECT\\n    subject,\\n    object AS merchantIdentifier\\n  FROM\\n    WalletOrderSubgraph\\n  WHERE\\n    predicate='nm_hasMerchant'\\n    AND relationshipPredicate = 'nm_organizationIdentifier'\\n),\\nWalletOrdersTransposed AS (\\n  SELECT\\n    a.subject,\\n    b.orderNumber,\\n    'paymentIdentifier' AS referenceEntityIdType,\\n    entityIdentifier(paymentIdentifier) AS referenceId\\n  FROM\\n    WalletOrderPaymentIdentifier a\\n    LEFT JOIN WalletOrderNumber b ON a.subject = b.subject\\n  UNION ALL\\n  SELECT\\n    a.subject,\\n    b.orderNumber,\\n    'transactionIdentifier' AS referenceEntityIdType,\\n    entityIdentifier(transactionIdentifier) AS referenceId\\n  FROM\\n    WalletOrderTransactionIdentifier a\\n    LEFT JOIN WalletOrderNumber b ON a.subject = b.subject\\n  UNION ALL\\n  SELECT\\n    a.subject,\\n    b.orderNumber,\\n    'emailIdentifier' AS referenceEntityIdType,\\n    entityIdentifier(emailIdentifier) AS referenceId\\n  FROM\\n    WalletOrderEmailIdentifier a\\n    LEFT JOIN WalletOrderNumber b ON a.subject = b.subject\\n  UNION ALL\\n  SELECT\\n    a.subject,\\n    b.orderNumber,\\n    'shipmentFullFillmentIdentifier' AS referenceEntityIdType,\\n    entityIdentifier(shipmentFullFillmentIdentifier) AS referenceId\\n  FROM\\n    WalletOrderShipmentFullFillmentIdentifier a\\n    LEFT JOIN WalletOrderNumber b ON a.subject = b.subject\\n  UNION ALL\\n  SELECT\\n    a.subject,\\n    b.orderNumber,\\n    'customerIdentifier' AS referenceEntityIdType,\\n    entityIdentifier(customerIdentifier) AS referenceId\\n  FROM\\n    CustomerIdentifier a\\n    LEFT JOIN WalletOrderNumber b ON a.subject = b.subject\\n  UNION ALL\\n  SELECT\\n    a.subject,\\n    b.orderNumber,\\n    'merchantIdentifier' AS referenceEntityIdType,\\n    entityIdentifier(merchantIdentifier) AS referenceId\\n  FROM\\n    MerchantIdentifier a\\n    LEFT JOIN WalletOrderNumber b ON a.subject = b.subject\\n)\\nSELECT DISTINCT\\n  subject,\\n  'md:' || subject AS identifier,\\n  orderNumber,\\n  referenceEntityIdType,\\n  referenceId\\nFROM\\n  WalletOrdersTransposed\\n\"}, \"target\": {\"database\": \"WalletPaymentsCommerce.Internal\", \"name\": \"WalletOrder\", \"target\": \"WalletPaymentsCommerce.Internal.WalletOrder\", \"type\": \"view\"}, \"type\": \"sqlConnection\", \"update\": {\"knowledgeGraphListeners\": [{\"filters\": [{\"entityType\": \"nm_walletOrder\"}], \"requiredSource\": false, \"schedule\": \"live\", \"source\": \"WalletClassicOrder\", \"stores\": [\"stableGraph\"]}, {\"filters\": [{\"entityType\": \"nm_walletOrder\"}], \"requiredSource\": false, \"schedule\": \"live\", \"source\": \"WalletEmailOrder\", \"stores\": [\"stableGraph\"]}, {\"filters\": [{\"entityType\": \"nm_walletOrder\"}], \"requiredSource\": false, \"schedule\": \"live\", \"source\": \"WalletTransactionOrder\", \"stores\": [\"stableGraph\"]}, {\"filters\": [{\"entityType\": \"nm_walletOrder\"}], \"requiredSource\": false, \"schedule\": \"live\", \"source\": \"WalletTrackedOrder\", \"stores\": [\"stableGraph\"]}]}, \"uuid\": \"1C132518-5A84-4EA0-B282-5CD8F73E41E0\", \"version\": \"267ee20b-fa23-4d32-a85f-1c546fae72ad\"}"
+ "{\"configHash\": \"921b460b59498f750c4a21685a0ea5dfab61dcd91286ab935391381176cedf30\", \"dependencies\": [], \"dependents\": [\"WalletOrderExtractedView\", \"WalletOrderShipmentFullFillmentInfo\"], \"deployment\": [\"production\"], \"featureFlag\": \"OrionSQL\", \"legacyName\": \"WalletOrderEmail\", \"name\": \"WalletOrderEmail\", \"platforms\": {\"iOS\": \"18.0\"}, \"sql\": {\"update\": \"WITH WalletEmailSubjects AS MATERIALIZED (\\n  -- NOTE: SUBJECT_COND contains multiple class types\\n  -- This is filtered to just wallet email subjects here\\n  SELECT DISTINCT\\n    subject\\n  FROM\\n    \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\"\\n  WHERE\\n    predicate = 'PS1'\\n    AND object = 'nm_email'\\n    AND $SUBJECT_COND(subject)\\n), WalletEmailSubgraph AS MATERIALIZED (\\n  -- PERF: Failing to materialize this subgraph leads to extremely large processing times when there are many subjects\\n  SELECT\\n    subject,\\n    predicate,\\n    object,\\n    relationshipPredicate,\\n    relationshipId\\n  FROM\\n    \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\"\\n  WHERE\\n    subject IN (SELECT subject FROM WalletEmailSubjects)\\n),\\nWalletEmailDisplaySubgraph AS MATERIALIZED (\\n  -- PERF: This CTE is materialized\\n  -- NOTE: This lacks a predicate clause and will include names for all class types passed\\n  -- in via SUBJECT_COND\\n  SELECT\\n    subject,\\n    object\\n  FROM\\n    \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\"\\n  WHERE\\n    predicate = 'PS33'\\n    AND $SUBJECT_COND(subject)\\n),\\nEmailRelationSubgraph AS MATERIALIZED (\\n  SELECT\\n    subject,\\n    object\\n  FROM\\n    \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\"\\n  WHERE\\n    predicate = 'PS520'\\n    AND relationshipPredicate = 'PS406'\\n    AND $SUBJECT_COND(subject)\\n),\\nWalletEmailDates AS (\\n  SELECT\\n    subject,\\n    predicate,\\n    object,\\n    relationshipId,\\n    relationshipPredicate\\n  FROM\\n    WalletEmailSubgraph\\n  WHERE\\n    predicate = 'nm_hasDate'\\n),\\nWalletEmailSentDateRecords AS (\\n  SELECT\\n    subject,\\n    predicate,\\n    object,\\n    relationshipId,\\n    relationshipPredicate\\n  FROM\\n    WalletEmailDates\\n  WHERE\\n    predicate = 'nm_hasDate'\\n    AND object = 'dateSent'\\n),\\nWalletEstimatedStartDateEntries AS MATERIALIZED (\\n  SELECT\\n    WalletEmailDates.*\\n  FROM\\n    WalletEmailSentDateRecords\\n    LEFT JOIN WalletEmailDates ON WalletEmailSentDateRecords.relationshipId = WalletEmailDates.relationshipId\\n),\\nWalletEmailSentDate AS (\\n  SELECT\\n    subject,\\n    object as emailSent\\n  FROM\\n    WalletEstimatedStartDateEntries\\n  WHERE\\n    predicate = 'nm_hasDate'\\n    AND relationshipPredicate = 'nm_imputedOccurrenceDate'\\n),\\nEmailType AS (\\n  SELECT\\n    subject,\\n    object as emailType\\n  FROM\\n    WalletEmailSubgraph\\n  WHERE\\n    predicate = 'nm_emailType'\\n),\\nOrderNumber AS (\\n    SELECT\\n      subject,\\n      object as orderNumber\\n    FROM\\n      WalletEmailSubgraph\\n    WHERE\\n      predicate = 'nm_orderNumber'\\n),\\nTrackingNumber AS (\\n    SELECT\\n      subject,\\n      object as trackingNumber\\n    FROM\\n      WalletEmailSubgraph\\n    WHERE\\n      predicate = 'nm_trackingNumber'\\n),\\nMerchantName AS (\\n    SELECT\\n      subject,\\n      object as merchantName\\n    FROM\\n      WalletEmailSubgraph\\n    WHERE\\n      predicate = 'nm_merchantName'\\n),\\nMessageId AS (\\nSELECT\\n  subject,\\n  object as messageId\\nFROM\\n  WalletEmailSubgraph\\nWHERE\\n  predicate = 'PS69'\\n),\\nSenderDomain AS (\\n  SELECT\\n    subject,\\n    object as senderDomain\\n  FROM\\n    WalletEmailSubgraph\\n  WHERE\\n    predicate = 'nm_senderDomain'\\n),\\nEmailSubject AS (\\n  SELECT\\n    subject,\\n    object as emailSubject\\n  FROM\\n    WalletEmailSubgraph\\n  WHERE\\n    predicate = 'nm_subject'\\n),\\nEmailToAddress AS (\\n  SELECT\\n    subject,\\n    object as toEmailAddress\\n  FROM\\n    WalletEmailSubgraph\\n  WHERE\\n    predicate = 'nm_toEmailAddress'\\n),\\nEmailToDisplay AS (\\n  SELECT\\n    subject,\\n    object as toEmailDisplay\\n  FROM\\n    WalletEmailSubgraph\\n  WHERE\\n    predicate = 'nm_toDisplayName'\\n),\\nEmailFromIds AS (\\n  SELECT\\n    subject,\\n    entityIdentifier(object) AS emailFromId\\n  FROM\\n    WalletEmailSubgraph\\n  WHERE\\n    predicate = 'nm_emailFrom'\\n),\\nEmailFromIdDisplay AS (\\n  SELECT\\n    EmailFromIds.subject,\\n    WalletEmailDisplaySubgraph.object AS emailFromDisplay\\n  FROM\\n    EmailFromIds LEFT JOIN WalletEmailDisplaySubgraph ON EmailFromIds.emailFromId = WalletEmailDisplaySubgraph.subject\\n),\\nEmailReplyToIds AS (\\n  SELECT\\n    subject,\\n    entityIdentifier(object) AS emailReplyToId\\n  FROM\\n    WalletEmailSubgraph\\n  WHERE\\n    predicate = 'nm_emailReplyTo'\\n),\\nEmailReplyToIdDisplay AS (\\n  SELECT\\n    EmailReplyToIds.subject,\\n    WalletEmailDisplaySubgraph.object as emailReplyToDisplay\\n  FROM\\n    EmailReplyToIds\\n    LEFT JOIN WalletEmailDisplaySubgraph ON EmailReplyToIds.emailReplyToId = WalletEmailDisplaySubgraph.subject\\n),\\nEmailFromResolved AS (\\n  Select\\n    DISTINCT E1.subject AS subject,\\n    ERel.object AS emailFrom\\n  FROM\\n    EmailFromIds E1\\n    JOIN EmailRelationSubgraph ERel ON E1.emailFromId = ERel.subject\\n),\\nEmailReplyToResolved AS (\\n  Select\\n    DISTINCT E1.subject as subject,\\n    ERel.object as emailReplyTo\\n  FROM\\n    EmailReplyToIds E1\\n    JOIN EmailRelationSubgraph ERel on E1.emailReplyToId = ERel.subject\\n),\\nWalletEmailHasIdentifiers AS (\\n  SELECT\\n    subject,\\n    predicate,\\n    object,\\n    relationshipId,\\n    relationshipPredicate\\n  FROM\\n    WalletEmailSubgraph\\n  WHERE\\n    predicate = 'PS72'\\n),\\nspotlightUniqIdRecord AS (\\n  SELECT\\n    subject,\\n    predicate,\\n    object,\\n    relationshipId,\\n    relationshipPredicate\\n  FROM\\n    WalletEmailHasIdentifiers\\n  WHERE\\n    object = 'spotlightUniqueIdentifier'\\n),\\nspotlightUniqIdRecordEntries AS (\\n  SELECT\\n    WalletEmailHasIdentifiers.*\\n  from\\n    spotlightUniqIdRecord\\n    LEFT JOIN WalletEmailHasIdentifiers ON spotlightUniqIdRecord.relationshipId = WalletEmailHasIdentifiers.relationshipId\\n),\\nspotlightUniqIdentifier AS (\\n  SELECT\\n    subject,\\n    object as spotlightUniqIdentifier\\n  FROM\\n    spotlightUniqIdRecordEntries\\n  WHERE\\n    predicate = 'PS72'\\n    AND relationshipPredicate = 'PS69'\\n),\\nspotlightDomainIdRecord AS (\\n  SELECT\\n    subject,\\n    predicate,\\n    object,\\n    relationshipId,\\n    relationshipPredicate\\n  FROM\\n    WalletEmailHasIdentifiers\\n  WHERE\\n    object = 'spotlightDomainIdentifier'\\n),\\nspotlightDomainIdRecordEntries AS (\\n  SELECT\\n    WalletEmailHasIdentifiers.*\\n  from\\n    spotlightDomainIdRecord\\n    LEFT JOIN WalletEmailHasIdentifiers ON spotlightDomainIdRecord.relationshipId = WalletEmailHasIdentifiers.relationshipId\\n),\\nspotlightDomainIdentifier AS (\\n  SELECT\\n    subject,\\n    object as spotlightDomainIdentifier\\n  FROM\\n    spotlightDomainIdRecordEntries\\n  WHERE\\n    predicate = 'PS72'\\n    AND relationshipPredicate = 'PS69'\\n),\\nWalletEmailsRepeated AS MATERIALIZED (\\n  SELECT\\n    s.subject,\\n    SenderDomain.senderDomain,\\n    EmailSubject.emailSubject,\\n    EmailFromResolved.emailFrom,\\n    EmailFromIdDisplay.emailFromDisplay,\\n    EmailToAddress.toEmailAddress AS emailTo,\\n    EmailToDisplay.toEmailDisplay AS emailToDisplay,\\n    EmailReplyToResolved.emailReplyTo,\\n    EmailReplyToIdDisplay.emailReplyToDisplay,\\n    EmailType.emailType,\\n    WalletEmailSentDate.emailSent AS emailSentDate,\\n    MessageId.messageId AS messageID,\\n    spotlightUniqIdentifier.spotlightUniqIdentifier AS spotlightUniqueIdentifier,\\n    spotlightDomainIdentifier.spotlightDomainIdentifier AS spotlightDomainIdentifier,\\n    OrderNumber.orderNumber AS origOrderNumber,\\n    TrackingNumber.trackingNumber AS origTrackingNumber,\\n    MerchantName.merchantName AS origMerchantName\\n  FROM\\n    WalletEmailSubjects AS s\\n    LEFT JOIN SenderDomain ON s.subject = SenderDomain.subject\\n    LEFT JOIN EmailSubject ON s.subject = EmailSubject.subject\\n    LEFT JOIN EmailToAddress ON s.subject = EmailToAddress.subject\\n    LEFT JOIN EmailToDisplay ON s.subject = EmailToDisplay.subject\\n    LEFT JOIN EmailFromResolved ON s.subject = EmailFromResolved.subject\\n    LEFT JOIN EmailFromIdDisplay ON s.subject = EmailFromIdDisplay.subject\\n    LEFT JOIN EmailReplyToIdDisplay ON s.subject = EmailReplyToIdDisplay.subject\\n    LEFT JOIN EmailReplyToResolved ON s.subject = EmailReplyToResolved.subject\\n    LEFT JOIN EmailType ON s.subject = EmailType.subject\\n    LEFT JOIN WalletEmailSentDate ON s.subject = WalletEmailSentDate.subject\\n    LEFT JOIN MessageId ON s.subject = MessageId.subject\\n    LEFT JOIN spotlightUniqIdentifier ON s.subject = spotlightUniqIdentifier.subject\\n    LEFT JOIN spotlightDomainIdentifier ON s.subject = spotlightDomainIdentifier.subject\\n    LEFT JOIN OrderNumber ON s.subject = OrderNumber.subject\\n    LEFT JOIN TrackingNumber ON s.subject = TrackingNumber.subject\\n    LEFT JOIN MerchantName ON s.subject = MerchantName.subject\\n),\\nWalletEmailsRanked AS (\\n  SELECT\\n    *,\\n    ROW_NUMBER() OVER (PARTITION BY subject) as rn\\n  FROM\\n    WalletEmailsRepeated\\n)\\nSELECT\\n  subject,\\n  'md:' || subject AS identifier,\\n  emailType,\\n  senderDomain,\\n  emailSubject,\\n  emailFrom,\\n  emailFromDisplay,\\n  emailTo,\\n  emailToDisplay,\\n  emailReplyTo,\\n  emailReplyToDisplay,\\n  emailSentDate,\\n  messageID,\\n  spotlightUniqueIdentifier,\\n  spotlightDomainIdentifier,\\n  origOrderNumber,\\n  origTrackingNumber,\\n  origMerchantName\\nFROM\\n  WalletEmailsRanked\\nWHERE\\n  rn = 1\\n\"}, \"target\": {\"database\": \"WalletPaymentsCommerce.Internal\", \"name\": \"WalletOrderEmail\", \"target\": \"WalletPaymentsCommerce.Internal.WalletOrderEmail\", \"type\": \"view\"}, \"type\": \"sqlConnection\", \"update\": {\"knowledgeGraphListeners\": [{\"filters\": [{\"entityType\": \"nm_email\"}, {\"entityType\": \"SB104\", \"entityTypeIncludeDescendants\": true}, {\"entityType\": \"SB10\", \"entityTypeIncludeDescendants\": true}], \"requiredSource\": false, \"schedule\": \"live\", \"source\": \"WalletClassicOrder\", \"stores\": [\"stableGraph\"]}, {\"filters\": [{\"entityType\": \"nm_email\"}, {\"entityType\": \"SB104\", \"entityTypeIncludeDescendants\": true}, {\"entityType\": \"SB10\", \"entityTypeIncludeDescendants\": true}], \"requiredSource\": false, \"schedule\": \"live\", \"source\": \"WalletEmailOrder\", \"stores\": [\"stableGraph\"]}, {\"filters\": [{\"entityType\": \"nm_email\"}, {\"entityType\": \"SB104\", \"entityTypeIncludeDescendants\": true}, {\"entityType\": \"SB10\", \"entityTypeIncludeDescendants\": true}], \"requiredSource\": false, \"schedule\": \"live\", \"source\": \"WalletTransactionOrder\", \"stores\": [\"stableGraph\"]}, {\"filters\": [{\"entityType\": \"nm_email\"}, {\"entityType\": \"SB104\", \"entityTypeIncludeDescendants\": true}, {\"entityType\": \"SB10\", \"entityTypeIncludeDescendants\": true}], \"requiredSource\": false, \"schedule\": \"live\", \"source\": \"WalletTrackedOrder\", \"stores\": [\"stableGraph\"]}]}, \"uuid\": \"0342CEBC-B14A-45AC-8986-ED6E7CCD60D3\", \"version\": \"2d35ae1d-007d-4bb9-b74b-838982432447\"}"
+ "{\"configHash\": \"a7e9502c7b95af86742d994fc780188ac81de723aa1594fbbe56d96a935ff328\", \"dependencies\": [], \"dependents\": [], \"deployment\": [\"production\"], \"featureFlag\": \"OrionSQL\", \"legacyName\": \"location\", \"name\": \"Location\", \"platforms\": {\"iOS\": \"18.0\", \"macOS\": \"15.0\"}, \"sql\": {\"update\": \"WITH LocationSubjects AS MATERIALIZED (\\n  -- NOTE: If we trust that subject_cond contains only Location subjects, this may not be needed.\\n  -- For now, this table enforces that the subjects we consider are Location subjects\\n  SELECT\\n    subject\\n  FROM\\n    \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\"\\n  WHERE\\n    predicate = 'PS1'\\n    AND object = 'SB152'\\n    AND $SUBJECT_COND(subject)\\n), LocationSubgraph AS MATERIALIZED (\\n  -- PERF: Failing to materialize this subgraph leads to extremely large processing times when there are many subjects\\n  SELECT\\n    subject AS subject,\\n    predicate,\\n    object,\\n    relationshipPredicate,\\n    relationshipId\\n  FROM\\n    \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\"\\n  WHERE\\n    subject IN (SELECT subject FROM LocationSubjects)\\n), LocationName AS (\\n  SELECT subject, object as name\\n  FROM LocationSubgraph\\n  WHERE predicate = 'PS33'\\n), LocationAddressString AS (\\n  SELECT subject, object as addressString\\n  FROM LocationSubgraph\\n  WHERE predicate = 'nm_addressString'\\n), LocationLatitude AS (\\n  SELECT l1.subject, l2.object as latitude\\n  FROM LocationSubgraph l1 JOIN LocationSubgraph l2 ON l1.relationshipId = l2.relationshipId\\n  WHERE l1.predicate = 'PS573' AND l1.relationshipPredicate = 'PS1' AND l1.object = 'CS29'\\n    AND l2.relationshipPredicate = 'PS571'\\n), LocationLongitude AS (\\n  SELECT l1.subject, l2.object as longitude\\n  FROM LocationSubgraph l1 JOIN LocationSubgraph l2 ON l1.relationshipId = l2.relationshipId\\n  WHERE l1.predicate = 'PS573' AND l1.relationshipPredicate = 'PS1' AND l1.object = 'CS29'\\n    AND l2.relationshipPredicate = 'PS572' LIMIT 1\\n), LocationAddress AS (\\n  SELECT l1.subject, json_group_object(\\n    CASE WHEN l2.relationshipPredicate = 'PS454' THEN 'isoCountryCode' WHEN l2.relationshipPredicate = 'PS450' THEN 'country' WHEN l2.relationshipPredicate = 'PS315' THEN 'postalCode' WHEN l2.relationshipPredicate = 'PS568' THEN 'administrativeArea' WHEN l2.relationshipPredicate = 'PS569' THEN 'locality' WHEN l2.relationshipPredicate = 'PS570' THEN 'thoroughfare' WHEN l2.relationshipPredicate = 'PS316' THEN 'streetName' WHEN l2.relationshipPredicate = 'PS453' THEN 'city' END,\\n    l2.object\\n  ) as address\\n  FROM LocationSubgraph l1 JOIN LocationSubgraph l2  ON l1.relationshipId = l2.relationshipId\\n  WHERE l1.predicate = 'PS317' and l1.relationshipPredicate = 'PS1' and l1.object = 'CS97'\\n  AND l2.relationshipPredicate IN ('PS315', 'PS450', 'PS568', 'PS569', 'PS570', 'PS454', 'PS316', 'PS453')\\n  GROUP BY l1.subject\\n),LocationsRepeated AS (\\n  SELECT\\n    s.subject,\\n    LocationName.name,\\n    LocationAddressString.addressString,\\n    LocationLatitude.latitude,\\n    LocationLongitude.longitude,\\n    LocationAddress.address\\n  FROM\\n    LocationSubjects AS s\\n    LEFT JOIN LocationName ON s.subject = LocationName.subject\\n    LEFT JOIN LocationAddressString ON s.subject = LocationAddressString.subject\\n    LEFT JOIN LocationLatitude ON s.subject = LocationLatitude.subject\\n    LEFT JOIN LocationLongitude ON s.subject = LocationLongitude.subject\\n    LEFT JOIN LocationAddress ON s.subject = LocationAddress.subject\\n  ORDER BY\\n    s.subject\\n), LocationsRanked AS (\\n    SELECT\\n      *,\\n      ROW_NUMBER() OVER (PARTITION BY subject) AS rn\\n    FROM\\n      LocationsRepeated\\n)\\n\\nSELECT\\n  subject,\\n  'md:' || subject as identifier,\\n  name,\\n  addressString,\\n  latitude,\\n  longitude,\\n  address\\nFROM\\n  LocationsRanked\\nWHERE\\n  rn = 1\\n\"}, \"target\": {\"database\": \"IntelligencePlatform.Entity\", \"name\": \"Location\", \"target\": \"IntelligencePlatform.Entity.Location\", \"type\": \"view\"}, \"type\": \"sqlConnection\", \"update\": {\"knowledgeGraphListeners\": [{\"filters\": [{\"entityType\": \"SB152\"}], \"schedule\": \"live\", \"stores\": [\"stableGraph\"]}]}, \"uuid\": \"C9B0B192-3E33-43C4-8C72-4CBF6D5E7525\", \"version\": \"61306782-5483-4ef1-95af-1383dfc68d2b\"}"
+ "{\"configHash\": \"abff9c36b3aa5c23428010f8bafd538d2ef0f106df2d8be79030c1a8811aed6b\", \"dependencies\": [\"WalletOrderFields\", \"WalletTrackedOrderFields\", \"WalletOrder\", \"WalletOrderEmail\", \"WalletOrderPayment\", \"WalletOrderTransaction\", \"WalletOrderShipmentFullFillmentInfo\", \"WalletOrderPerson\"], \"dependents\": [\"WalletCascadeInsert\"], \"deployment\": [\"production\"], \"featureFlag\": \"OrionSQL\", \"legacyName\": \"WalletOrderExtractedView\", \"name\": \"WalletOrderExtractedView\", \"platforms\": {\"iOS\": \"18.0\"}, \"sql\": {\"update\": \"WITH WalletOrderFields AS (\\n  SELECT\\n    wof.*\\n  FROM\\n    (\\n      SELECT DISTINCT\\n        identifier\\n      FROM\\n        \\\"WalletPaymentsCommerce.Internal.WalletOrder\\\"\\n      WHERE\\n        referenceEntityIdType = 'emailIdentifier'\\n    ) AS EmailLinkedOrder\\n    INNER JOIN \\\"WalletPaymentsCommerce.Internal.WalletOrderFields\\\" wof ON EmailLinkedOrder.identifier = wof.identifier\\n),\\nWalletEmailOrder AS (\\n  SELECT\\n    subject,\\n    orderNumber,\\n    referenceId\\n  FROM\\n    \\\"WalletPaymentsCommerce.Internal.WalletOrder\\\"\\n  WHERE\\n    referenceEntityIdType = 'emailIdentifier'\\n),\\nWalletOrderMerchantListByEmail AS (\\n  SELECT\\n    ROW_NUMBER() OVER (\\n      PARTITION BY WalletEmailOrder.subject\\n      ORDER BY\\n        emailSentDate ASC\\n    ) as rn,\\n    WalletEmailOrder.subject,\\n    origOrderNumber as orderNumber,\\n    origMerchantName AS merchantName,\\n    emailSentDate\\n  FROM\\n    WalletEmailOrder\\n    LEFT JOIN \\\"WalletPaymentsCommerce.Internal.WalletOrderEmail\\\" we ON WalletEmailOrder.referenceId = we.subject\\n),\\nWalletTrackedOrderFields AS (\\n  SELECT\\n    subject,\\n    trkOrderNumber as orderNumber,\\n    trkMerchantName as merchantName,\\n    trkOrderStatus as orderStatus,\\n    earliestEmailDateSent as earliestEmailDateSent,\\n    displayNameUpdateDate ,\\n    orderStatusUpdateDate\\n  FROM\\n    \\\"WalletPaymentsCommerce.Internal.WalletTrackedOrderFields\\\"\\n),\\nWalletOrderMerchantListUnion AS (\\n    SELECT subject , orderNumber, merchantName, emailSentDate FROM WalletOrderMerchantListByEmail\\n    UNION\\n    SELECT subject, orderNumber, merchantName, displayNameUpdateDate as emailSentDate FROM\\n        WalletTrackedOrderFields WHERE displayNameUpdateDate IS NOT NULL AND displayNameUpdateDate!=''\\n),\\nWalletOrderEmailEarliestDateList AS (\\n    SELECT subject , emailSentDate AS earliestEmailDateSent FROM WalletOrderMerchantListByEmail\\n    UNION\\n    SELECT subject, earliestEmailDateSent FROM walletTrackedOrderFields WHERE earliestEmailDateSent IS NOT NULL AND earliestEmailDateSent!=''\\n),\\nWalletEmailsUnionRanked AS  (SELECT *,  ROW_NUMBER() OVER (\\n      PARTITION BY subject\\n      ORDER BY\\n        earliestEmailDateSent ASC\\n    ) as rn FROM WalletOrderEmailEarliestDateList),\\nWalletEmailEarliestDateFinal AS (\\n    SELECT subject, earliestEmailDateSent FROM WalletEmailsUnionRanked WHERE rn =1 ),\\nWalletOrderMerchantList AS (\\n    SELECT\\n      ROW_NUMBER() OVER (\\n        PARTITION BY subject\\n        ORDER BY\\n          emailSentDate ASC\\n      ) as rn,\\n      subject,\\n      orderNumber,\\n      merchantName,\\n      emailSentDate AS displayNameUpdateDate FROM\\n    WalletOrderMerchantListUnion\\n),\\nWalletOrderStatusRanked AS (\\n  SELECT\\n    WalletEmailOrder.subject,\\n    orderNumber,\\n    CASE\\n      WHEN emailType = '1' THEN '1'\\n      WHEN emailType = '3' THEN '3'\\n      WHEN emailType = '4' THEN '4'\\n      ELSE NULL\\n    END AS emailOrderStatus,\\n    emailSentDate\\n  FROM\\n    WalletEmailOrder\\n    LEFT JOIN \\\"WalletPaymentsCommerce.Internal.WalletOrderEmail\\\" we ON WalletEmailOrder.referenceId = we.subject\\n    UNION\\n  SELECT subject, orderNumber, orderStatus AS emailOrderStatus, orderStatusUpdateDate AS emailSentDate FROM WalletTrackedOrderFields\\n),\\nWalletOrderStatusRankedList AS (\\n  SELECT\\n    *,\\n    ROW_NUMBER() OVER (\\n      PARTITION BY WalletOrderStatusRanked.subject\\n      ORDER BY\\n        emailSentDate DESC\\n    ) as rn\\n  FROM\\n    WalletOrderStatusRanked\\n  where\\n    emailOrderStatus IS NOT NULL\\n),\\nWalletOrderStatusFinal AS (\\n  SELECT\\n    subject,\\n    orderNumber,\\n    emailOrderStatus AS orderStatus,\\n    emailSentDate AS orderStatusUpdateDate\\n  FROM\\n    WalletOrderStatusRankedList\\n  WHERE\\n    rn = 1\\n),\\nWalletOrderMerchant AS (\\n  SELECT\\n    subject,\\n    merchantName,\\n    orderNumber,\\n    JSON_OBJECT('displayName', merchantName,\\n     'displayNameUpdateDate',  CAST(displayNameUpdateDate AS REAL)) AS merchantJson\\n  FROM\\n    WalletOrderMerchantList\\n  WHERE\\n    rn = 1\\n),\\nWalletPersonOrder AS (\\n  SELECT\\n    subject,\\n    orderNumber,\\n    referenceId\\n  FROM\\n    walletOrder\\n  WHERE\\n    referenceEntityIdType = 'customerIdentifier'\\n),\\nWalletPersonOrderJson AS (\\n  SELECT\\n    WalletPersonOrder.subject,\\n    JSON_OBJECT(\\n      'fullName',\\n      name,\\n      'phoneNumber',\\n      phone,\\n      'emailAddress',\\n      email,\\n      'billingAddress',\\n      JSON_OBJECT(\\n        'street',\\n        street,\\n        'city',\\n        city,\\n        'state',\\n        state,\\n        'country',\\n        country,\\n        'postalCode',\\n        postal,\\n        'rawAddress',\\n        rawAddress\\n      )\\n    ) AS personJson\\n  FROM\\n    WalletPersonOrder\\n    LEFT JOIN \\\"WalletPaymentsCommerce.Internal.WalletOrderPerson\\\" wop ON WalletPersonOrder.referenceId = wop.subject\\n),\\nWalletPymOrder AS (\\n  SELECT\\n    subject,\\n    orderNumber,\\n    referenceId\\n  FROM\\n    \\\"WalletPaymentsCommerce.Internal.WalletOrder\\\"\\n  WHERE\\n    referenceEntityIdType = 'paymentIdentifier'\\n),\\nWalletTrxOrder AS (\\n  SELECT\\n    subject,\\n    orderNumber,\\n    referenceId\\n  FROM\\n    \\\"WalletPaymentsCommerce.Internal.WalletOrder\\\"\\n  WHERE\\n    referenceEntityIdType = 'transactionIdentifier'\\n),\\nWalletPymTbl AS (\\n  SELECT\\n    WalletPymOrder.subject,\\n    orderNumber,\\n    totalAmount,\\n    currencyCode,\\n    ROW_NUMBER() OVER (\\n      PARTITION BY WalletPymOrder.subject\\n      ORDER BY\\n        totalAmount DESC\\n    ) AS rn\\n  FROM\\n    WalletPymOrder\\n    LEFT JOIN \\\"WalletPaymentsCommerce.Internal.WalletOrderPayment\\\" wop ON WalletPymOrder.referenceId = wop.subject\\n),\\nWalletPymCol AS (\\n  SELECT\\n    subject,\\n    orderNumber,\\n    totalAmount,\\n    currencyCode\\n  FROM\\n    WalletPymTbl\\n  where\\n    rn = 1\\n),\\nWalletTrxCol AS (\\n  SELECT DISTINCT\\n    WalletTrxOrder.subject,\\n    JSON_GROUP_ARRAY(\\n      JSON_OBJECT(\\n        'amount',\\n        totalAmount,\\n        'isoCurrencyCode',\\n        currencyCode,\\n        'transactionIdenifier',\\n        trxId,\\n        'paymentMethod',\\n        JSON_OBJECT(\\n          'lastFourDigits',\\n          accountLastFourDigits,\\n          'displayName',\\n          accountInstitution\\n        )\\n      )\\n    ) AS trxInfo\\n  FROM\\n    WalletTrxOrder\\n    LEFT JOIN \\\"WalletPaymentsCommerce.Internal.WalletOrderTransaction\\\" wot ON WalletTrxOrder.referenceId = wot.subject\\n  WHERE\\n    currencyCode IS NOT NULL\\n    OR totalAmount IS NOT NULL\\n    OR accountInstitution IS NOT NULL\\n    OR accountLastFourDigits IS NOT NULL\\n  GROUP BY\\n    WalletTrxOrder.subject\\n),\\nWalletPymJson AS (\\n  SELECT\\n    WalletPymCol.subject,\\n    JSON_OBJECT(\\n      'totalAmount',\\n      totalAmount,\\n      'totalIsoCurrencyCode',\\n      currencyCode,\\n      'transactions',\\n      json_extract(trxInfo, '$')\\n    ) AS orderPayment\\n  FROM\\n    WalletPymCol\\n    LEFT JOIN WalletTrxCol ON WalletPymCol.subject = WalletTrxCol.subject\\n),\\nWalletShipmentOrder AS (\\n  SELECT\\n    subject,\\n    orderNumber,\\n    referenceId\\n  FROM\\n    \\\"WalletPaymentsCommerce.Internal.WalletOrder\\\"\\n  WHERE\\n    referenceEntityIdType = 'shipmentFullFillmentIdentifier'\\n),\\nWalletDedupeShipment AS (\\n  SELECT DISTINCT\\n    WalletShipmentOrder.subject AS identifierOrder,\\n    WalletShipmentOrder.orderNumber,\\n    wosfi.*\\n  FROM\\n    WalletShipmentOrder\\n    LEFT JOIN \\\"WalletPaymentsCommerce.Internal.WalletOrderShipmentFullFillmentInfo\\\" wosfi ON WalletShipmentOrder.referenceId = wosfi.subject\\n),\\nWalletShipmentOrderByEmail AS (\\n  SELECT\\n    WalletDedupeShipment.subject AS orderIdentifier,\\n    *,\\n    ROW_NUMBER() OVER (\\n      PARTITION BY orderNumber,\\n      trackingNumber\\n      ORDER BY\\n        fullfillmentUpdateDate DESC,\\n        emailSentDate DESC\\n    ) AS rn\\n  FROM\\n    WalletDedupeShipment\\n    LEFT JOIN \\\"WalletPaymentsCommerce.Internal.WalletOrderEmail\\\" we ON WalletDedupeShipment.emailIdentifier = we.subject\\n),\\nWalletShipmentWithFilledValues AS (\\n  SELECT\\n    s1.*,\\n    COALESCE(s1.carrierName,\\n      (SELECT s2.carrierName FROM WalletShipmentOrderByEmail s2\\n       WHERE s2.orderNumber = s1.orderNumber AND s2.trackingNumber = s1.trackingNumber AND s2.carrierName IS NOT NULL\\n       ORDER BY s2.fullfillmentUpdateDate DESC, s2.emailSentDate DESC LIMIT 1)) AS filled_carrierName,\\n    COALESCE(s1.trackingNumber,\\n      (SELECT s2.trackingNumber FROM WalletShipmentOrderByEmail s2\\n       WHERE s2.orderNumber = s1.orderNumber AND s2.trackingNumber = s1.trackingNumber AND s2.trackingNumber IS NOT NULL\\n       ORDER BY s2.fullfillmentUpdateDate DESC, s2.emailSentDate DESC LIMIT 1)) AS filled_trackingNumber,\\n    COALESCE(s1.shippingMethod,\\n      (SELECT s2.shippingMethod FROM WalletShipmentOrderByEmail s2\\n       WHERE s2.orderNumber = s1.orderNumber AND s2.trackingNumber = s1.trackingNumber AND s2.shippingMethod IS NOT NULL\\n       ORDER BY s2.fullfillmentUpdateDate DESC, s2.emailSentDate DESC LIMIT 1)) AS filled_shippingMethod,\\n    COALESCE(s1.shippingStatus,\\n      (SELECT s2.shippingStatus FROM WalletShipmentOrderByEmail s2\\n       WHERE s2.orderNumber = s1.orderNumber AND s2.trackingNumber = s1.trackingNumber AND s2.shippingStatus IS NOT NULL\\n       ORDER BY s2.fullfillmentUpdateDate DESC, s2.emailSentDate DESC LIMIT 1)) AS filled_shippingStatus,\\n    COALESCE(s1.shippingDate,\\n      (SELECT s2.shippingDate FROM WalletShipmentOrderByEmail s2\\n       WHERE s2.orderNumber = s1.orderNumber AND s2.trackingNumber = s1.trackingNumber AND s2.shippingDate IS NOT NULL\\n       ORDER BY s2.fullfillmentUpdateDate DESC, s2.emailSentDate DESC LIMIT 1)) AS filled_shippingDate,\\n    COALESCE(s1.estimatedDeliveryStartDate,\\n      (SELECT s2.estimatedDeliveryStartDate FROM WalletShipmentOrderByEmail s2\\n       WHERE s2.orderNumber = s1.orderNumber AND s2.trackingNumber = s1.trackingNumber AND s2.estimatedDeliveryStartDate IS NOT NULL\\n       ORDER BY s2.fullfillmentUpdateDate DESC, s2.emailSentDate DESC LIMIT 1)) AS filled_estimatedDeliveryStartDate,\\n    COALESCE(s1.estimatedDeliveryStartTime,\\n      (SELECT s2.estimatedDeliveryStartTime FROM WalletShipmentOrderByEmail s2\\n       WHERE s2.orderNumber = s1.orderNumber AND s2.trackingNumber = s1.trackingNumber AND s2.estimatedDeliveryStartTime IS NOT NULL\\n       ORDER BY s2.fullfillmentUpdateDate DESC, s2.emailSentDate DESC LIMIT 1)) AS filled_estimatedDeliveryStartTime,\\n    COALESCE(s1.estimatedDeliveryEndDate,\\n      (SELECT s2.estimatedDeliveryEndDate FROM WalletShipmentOrderByEmail s2\\n       WHERE s2.orderNumber = s1.orderNumber AND s2.trackingNumber = s1.trackingNumber AND s2.estimatedDeliveryEndDate IS NOT NULL\\n       ORDER BY s2.fullfillmentUpdateDate DESC, s2.emailSentDate DESC LIMIT 1)) AS filled_estimatedDeliveryEndDate,\\n    COALESCE(s1.estimatedDeliveryEndTime,\\n      (SELECT s2.estimatedDeliveryEndTime FROM WalletShipmentOrderByEmail s2\\n       WHERE s2.orderNumber = s1.orderNumber AND s2.trackingNumber = s1.trackingNumber AND s2.estimatedDeliveryEndTime IS NOT NULL\\n       ORDER BY s2.fullfillmentUpdateDate DESC, s2.emailSentDate DESC LIMIT 1)) AS filled_estimatedDeliveryEndTime,\\n    COALESCE(s1.deliveryDate,\\n      (SELECT s2.deliveryDate FROM WalletShipmentOrderByEmail s2\\n       WHERE s2.orderNumber = s1.orderNumber AND s2.trackingNumber = s1.trackingNumber AND s2.deliveryDate IS NOT NULL\\n       ORDER BY s2.fullfillmentUpdateDate DESC, s2.emailSentDate DESC LIMIT 1)) AS filled_deliveryDate,\\n    COALESCE(s1.deliveryTime,\\n      (SELECT s2.deliveryTime FROM WalletShipmentOrderByEmail s2\\n       WHERE s2.orderNumber = s1.orderNumber AND s2.trackingNumber = s1.trackingNumber AND s2.deliveryTime IS NOT NULL\\n       ORDER BY s2.fullfillmentUpdateDate DESC, s2.emailSentDate DESC LIMIT 1)) AS filled_deliveryTime,\\n    COALESCE(s1.personIdentifier,\\n         (SELECT s2.personIdentifier FROM WalletShipmentOrderByEmail s2\\n          WHERE s2.orderNumber = s1.orderNumber AND s2.trackingNumber = s1.trackingNumber AND s2.personIdentifier IS NOT NULL\\n          ORDER BY s2.fullfillmentUpdateDate DESC, s2.emailSentDate DESC LIMIT 1)) AS filled_personIdentifier\\n  FROM WalletShipmentOrderByEmail s1 WHERE rn=1\\n),\\nWalletShippingRecepientOrderJson AS (\\n    SELECT\\n      WalletShipmentWithFilledValues.subject,\\n      *,\\n      JSON_OBJECT(\\n        'fullName',\\n        name,\\n        'phoneNumber',\\n        phone,\\n        'emailAddress',\\n        email,\\n        'address',\\n        JSON_OBJECT(\\n          'street',\\n          street,\\n          'city',\\n          city,\\n          'state',\\n          state,\\n          'country',\\n          country,\\n          'postalCode',\\n          postal,\\n          'rawAddress',\\n          rawAddress\\n        )\\n      ) AS shippingRecepientJson\\n    FROM\\n      WalletShipmentWithFilledValues\\n      LEFT JOIN \\\"WalletOrderPerson\\\" wop ON wop.subject = WalletShipmentWithFilledValues.filled_personIdentifier\\n      WHERE rn=1\\n),\\nWalletShipmentJson AS (\\n    SELECT\\n      WalletShipmentWithFilledValues.identifierOrder AS identifierOrder,\\n      WalletShipmentWithFilledValues.orderNumber,\\n      JSON_GROUP_ARRAY(\\n        JSON_OBJECT(\\n          'carrierName',\\n          WalletShipmentWithFilledValues.filled_carrierName,\\n          'trackingNumber',\\n          WalletShipmentWithFilledValues.filled_trackingNumber,\\n          'shippingMethod',\\n          WalletShipmentWithFilledValues.filled_shippingMethod,\\n          'status',\\n          CAST(\\n            WalletShipmentWithFilledValues.filled_shippingStatus AS INTEGER\\n          ),\\n          'shippingDate',\\n          WalletShipmentWithFilledValues.filled_shippingDate,\\n          'estimatedDeliveryStartDate',\\n          WalletShipmentWithFilledValues.filled_estimatedDeliveryStartDate,\\n          'estimatedDeliveryStartTime',\\n          WalletShipmentWithFilledValues.filled_estimatedDeliveryStartTime,\\n          'estimatedDeliveryEndDate',\\n          WalletShipmentWithFilledValues.filled_estimatedDeliveryEndDate,\\n          'estimatedDeliveryEndTime',\\n          WalletShipmentWithFilledValues.filled_estimatedDeliveryEndTime,\\n          'deliveryDate',\\n          WalletShipmentWithFilledValues.filled_deliveryDate,\\n          'deliveryTime',\\n          WalletShipmentWithFilledValues.filled_deliveryTime,\\n          'fulfillmentUpdateDate',\\n          (\\n            CASE\\n              WHEN WalletShipmentWithFilledValues.emailSentDate IS NULL THEN CAST(\\n                WalletShipmentWithFilledValues.fullfillmentUpdateDate AS REAL\\n              )\\n              WHEN WalletShipmentWithFilledValues.fullfillmentUpdateDate IS NULL THEN CAST(\\n                WalletShipmentWithFilledValues.emailSentDate AS REAL\\n              )\\n              WHEN CAST(\\n                WalletShipmentWithFilledValues.emailSentDate AS REAL\\n              ) > CAST(\\n                WalletShipmentWithFilledValues.fullfillmentUpdateDate AS REAL\\n              ) THEN CAST(\\n                WalletShipmentWithFilledValues.emailSentDate AS REAL\\n              )\\n              ELSE CAST(\\n                WalletShipmentWithFilledValues.fullfillmentUpdateDate AS REAL\\n              )\\n            END\\n          ),\\n          'shippingRecipient',\\n          json_extract(\\n            WalletShippingRecepientOrderJson.shippingRecepientJson,\\n            '$'\\n          )\\n        )\\n      ) AS shipmentJson\\n    FROM\\n      WalletShipmentWithFilledValues\\n      LEFT JOIN WalletShippingRecepientOrderJson ON WalletShippingRecepientOrderJson.orderIdentifier = WalletShipmentWithFilledValues.orderIdentifier\\n    WHERE\\n      WalletShipmentWithFilledValues.rn = 1\\n      GROUP BY\\n    WalletShipmentWithFilledValues.identifierOrder\\n),\\nWalletEmailShipping AS (\\n  SELECT\\n    shippingStatus,\\n    trackingNumber,\\n    carrierName,\\n    we.subject\\n  FROM\\n    \\\"WalletPaymentsCommerce.Internal.WalletOrderShipmentFullFillmentInfo\\\" wosfi\\n    LEFT JOIN \\\"WalletPaymentsCommerce.Internal.WalletOrderEmail\\\" we ON wosfi.emailIdentifier = we.subject\\n),\\nWalletEmailOrderJson AS (\\n  SELECT\\n    WalletEmailOrder.subject,\\n    orderNumber,\\n    JSON_GROUP_ARRAY(\\n      JSON_OBJECT(\\n        'emailType',\\n        CAST(emailType AS INTEGER),\\n        'emailMetadata',\\n        JSON_OBJECT(\\n          'messageID',\\n          messageID,\\n          'senderDomain',\\n          senderDomain,\\n          'replyToEmailAddress',\\n          emailReplyTo,\\n          'subject',\\n          emailSubject,\\n          'toEmailAddress',\\n          emailTo,\\n          'fromEmailAddress',\\n          emailFrom,\\n          'toDisplayName',\\n          emailToDisplay,\\n          'fromDisplayName',\\n          emailFromDisplay,\\n          'replyToDisplayName',\\n          emailReplyToDisplay,\\n          'dateSent',\\n          CAST(emailSentDate AS REAL)\\n        ),\\n        'orderDetails',\\n        JSON_OBJECT(\\n          'orderNumber',\\n          origOrderNumber,\\n          'merchant',\\n            JSON_OBJECT('displayName', origMerchantName),\\n          'shippingDetails',\\n          JSON_OBJECT(\\n            'status',\\n            CAST(shippingStatus AS INTEGER),\\n            'trackingNumber',\\n            origTrackingNumber,\\n            'carrierName',\\n            carrierName\\n          )\\n        ),\\n        'spotlightUniqueIdentifier',\\n        spotlightUniqueIdentifier,\\n        'spotlightDomainIdentifier',\\n        spotlightDomainIdentifier\\n      )\\n    ) AS emailArr\\n  FROM\\n    WalletEmailOrder\\n    LEFT JOIN \\\"WalletPaymentsCommerce.Internal.WalletOrderEmail\\\" we ON WalletEmailOrder.referenceId = we.subject\\n    LEFT JOIN \\\"WalletEmailShipping\\\" wes ON walletEmailOrder.referenceId = wes.subject\\n  GROUP BY\\n    WalletEmailOrder.subject\\n  ORDER BY emailSentDate DESC\\n)\\nSELECT DISTINCT\\n  WalletOrderFields.subject,\\n  'md:' || WalletOrderFields.subject AS identifier,\\n  WalletOrderFields.orderNumber AS orderNumber,\\n  JSON_OBJECT(\\n    'orderNumber',\\n    WalletOrderMerchant.orderNumber,\\n    'orderDate',\\n    WalletOrderFields.orderDate,\\n    'orderIdentifier',\\n    WalletOrderFields.orderIdentifier,\\n    'orderTypeIdentifier',\\n    WalletOrderFields.orderTypeIdentifier,\\n    'trackedOrderIdentifier',\\n    WalletOrderFields.trackedOrderIdentifier,\\n    'orderUpdateDate',\\n    CAST(WalletOrderFields.orderUpdateDate AS REAL),\\n    'orderEmails',\\n    json_extract(emailArr, '$'),\\n    'payment',\\n    json_extract(WalletPymJson.orderPayment, '$'),\\n    'shippingFulfillments',\\n    json_extract(WalletShipmentJson.shipmentJson, '$'),\\n    'merchant',\\n    json_extract(WalletOrderMerchant.merchantJson, '$'),\\n    'customer',\\n    json_extract(WalletPersonOrderJson.personJson, '$'),\\n    'orderStatus',\\n    CAST(WalletOrderStatusFinal.orderStatus AS INTEGER),\\n    'orderStatusUpdateDate',\\n    CAST(WalletOrderStatusFinal.orderStatusUpdateDate AS REAL),\\n    'earliestEmailDateSent',\\n    CAST(WalletEmailEarliestDateFinal.earliestEmailDateSent AS REAL)\\n  ) AS orderJson\\nFROM\\n  WalletOrderFields\\n  LEFT JOIN WalletEmailOrderJson ON WalletOrderFields.subject = WalletEmailOrderJson.subject\\n  LEFT JOIN WalletPymJson ON WalletOrderFields.subject = WalletPymJson.subject\\n  LEFT JOIN WalletShipmentJson ON WalletOrderFields.subject = WalletShipmentJson.identifierOrder\\n  LEFT JOIN WalletOrderMerchant ON WalletOrderFields.subject = WalletOrderMerchant.subject\\n  LEFT JOIN WalletPersonOrderJson ON WalletOrderFields.subject = WalletPersonOrderJson.subject\\n  LEFT JOIN WalletOrderStatusFinal ON WalletOrderFields.subject = WalletOrderStatusFinal.subject\\n  LEFT JOIN WalletEmailEarliestDateFinal ON WalletOrderFields.subject = WalletEmailEarliestDateFinal.subject\\n\\n\\n\"}, \"target\": {\"database\": \"WalletPaymentsCommerce.Internal\", \"name\": \"WalletOrderExtractedView\", \"target\": \"WalletPaymentsCommerce.Internal.WalletOrderExtractedView\", \"type\": \"view\"}, \"type\": \"sqlConnection\", \"update\": {\"knowledgeGraphListeners\": [{\"filters\": [{\"entityType\": \"SB10\"}], \"fullRebuildOnChange\": true, \"rebuildView\": true, \"requiredSource\": false, \"schedule\": \"live\", \"stores\": [\"stableGraph\"]}], \"viewListeners\": [{\"diffType\": \"updatedObject\", \"filterQuery\": \"SELECT subject FROM \\\"WalletPaymentsCommerce.Internal.WalletOrderFields\\\"\", \"fullRebuildOnChange\": true, \"name\": \"WalletOrderFields\", \"rebuildView\": true, \"schedule\": \"live\"}, {\"diffType\": \"updatedObject\", \"filterQuery\": \"SELECT subject FROM \\\"WalletPaymentsCommerce.Internal.WalletTrackedOrderFields\\\"\", \"fullRebuildOnChange\": true, \"name\": \"WalletTrackedOrderFields\", \"rebuildView\": true, \"schedule\": \"live\"}, {\"diffType\": \"updatedObject\", \"filterQuery\": \"SELECT subject FROM \\\"WalletPaymentsCommerce.Internal.WalletOrder\\\"\", \"fullRebuildOnChange\": true, \"name\": \"WalletOrder\", \"rebuildView\": true, \"schedule\": \"live\"}, {\"diffType\": \"updatedObject\", \"filterQuery\": \"SELECT subject FROM \\\"WalletPaymentsCommerce.Internal.WalletOrderEmail\\\"\", \"fullRebuildOnChange\": true, \"name\": \"WalletOrderEmail\", \"rebuildView\": true, \"schedule\": \"live\"}, {\"diffType\": \"updatedObject\", \"filterQuery\": \"SELECT subject FROM \\\"WalletPaymentsCommerce.Internal.WalletOrderPayment\\\"\", \"fullRebuildOnChange\": true, \"name\": \"WalletOrderPayment\", \"rebuildView\": true, \"schedule\": \"live\"}, {\"diffType\": \"updatedObject\", \"filterQuery\": \"SELECT subject FROM \\\"WalletPaymentsCommerce.Internal.WalletOrderTransaction\\\"\", \"fullRebuildOnChange\": true, \"name\": \"WalletOrderTransaction\", \"rebuildView\": true, \"schedule\": \"live\"}, {\"diffType\": \"updatedObject\", \"filterQuery\": \"SELECT subject FROM \\\"WalletPaymentsCommerce.Internal.WalletOrderShipmentFullFillmentInfo\\\"\", \"fullRebuildOnChange\": true, \"name\": \"WalletOrderShipmentFullFillmentInfo\", \"rebuildView\": true, \"schedule\": \"live\"}, {\"diffType\": \"updatedObject\", \"filterQuery\": \"SELECT subject FROM \\\"WalletPaymentsCommerce.Internal.WalletOrderPerson\\\"\", \"fullRebuildOnChange\": true, \"name\": \"WalletOrderPerson\", \"rebuildView\": true, \"requiredSource\": true, \"schedule\": \"live\"}]}, \"uuid\": \"456D4F37-51DB-4E59-B38A-C155C57FF5CB\", \"version\": \"d97930fa-0acb-4f07-9cc1-4e0d80cb7c64\", \"writeToStream\": true}"
+ "{\"configHash\": \"ad2a3e189ce7f2d50f9af4fa3db3eb7389e22744f73c4993270741f7cc9239c4\", \"dependencies\": [], \"dependents\": [\"WalletOrderExtractedView\"], \"deployment\": [\"production\"], \"featureFlag\": \"OrionSQL\", \"legacyName\": \"WalletOrderPayment\", \"name\": \"WalletOrderPayment\", \"platforms\": {\"iOS\": \"18.0\"}, \"sql\": {\"update\": \"WITH WalletPaymentSubjects AS MATERIALIZED (\\n  -- NOTE: If we trust that subject_cond contains only nm_payment subjects, this may not be needed.\\n  -- For now, this table enforces that the subjects we consider are nm_payment subjects\\n  SELECT DISTINCT\\n    subject\\n  FROM\\n    \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\"\\n  WHERE\\n    predicate = 'PS1'\\n    AND object = 'nm_payment'\\n    AND $SUBJECT_COND(subject)\\n), WalletPaymentSubgraph AS MATERIALIZED (\\n  -- PERF: Failing to materialize this subgraph leads to extremely large processing times when there are many subjects\\n  SELECT\\n    subject,\\n    predicate,\\n    object,\\n    relationshipPredicate,\\n    relationshipId\\n  FROM\\n    \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\"\\n  WHERE\\n    subject IN (SELECT subject FROM WalletPaymentSubjects)\\n), CurrencyCode AS (\\n  SELECT subject, object as currencyCode\\n  FROM WalletPaymentSubgraph\\n  WHERE predicate = 'nm_totalAmount' AND relationshipPredicate = 'PS2'\\n), TotalAmount AS (\\n  SELECT subject, object as totalAmount\\n  FROM WalletPaymentSubgraph\\n  WHERE predicate = 'nm_totalAmount' AND relationshipPredicate = 'PS3'\\n), WalletPaymentsRepeated AS (\\n  SELECT\\n    s.subject,\\n    CurrencyCode.currencyCode,\\n    TotalAmount.totalAmount\\n  FROM\\n    WalletPaymentSubjects as s\\n    LEFT JOIN CurrencyCode ON s.subject = CurrencyCode.subject\\n    LEFT JOIN TotalAmount ON s.subject = TotalAmount.subject\\n)\\nSELECT DISTINCT\\n  subject,\\n  'md:' || subject AS identifier,\\n  currencyCode,\\n  totalAmount\\nFROM\\n  WalletPaymentsRepeated\\n\"}, \"target\": {\"database\": \"WalletPaymentsCommerce.Internal\", \"name\": \"WalletOrderPayment\", \"target\": \"WalletPaymentsCommerce.Internal.WalletOrderPayment\", \"type\": \"view\"}, \"type\": \"sqlConnection\", \"update\": {\"knowledgeGraphListeners\": [{\"filters\": [{\"entityType\": \"nm_payment\"}], \"requiredSource\": false, \"schedule\": \"live\", \"source\": \"WalletClassicOrder\", \"stores\": [\"stableGraph\"]}, {\"filters\": [{\"entityType\": \"nm_payment\"}], \"requiredSource\": false, \"schedule\": \"live\", \"source\": \"WalletEmailOrder\", \"stores\": [\"stableGraph\"]}, {\"filters\": [{\"entityType\": \"nm_payment\"}], \"requiredSource\": false, \"schedule\": \"live\", \"source\": \"WalletTransactionOrder\", \"stores\": [\"stableGraph\"]}, {\"filters\": [{\"entityType\": \"nm_payment\"}], \"requiredSource\": false, \"schedule\": \"live\", \"source\": \"WalletTrackedOrder\", \"stores\": [\"stableGraph\"]}]}, \"uuid\": \"E24196FF-10DB-445C-A010-5A74DC34BA3C\", \"version\": \"6adaf600-d3d9-4cb2-a059-73a9a8b628e8\"}"
+ "{\"configHash\": \"bb56e5de40b618fbafd3938060f68772ec456cd346e4eb48ec1ddf91daa5e3f9\", \"dependencies\": [\"WalletOrderEmail\"], \"dependents\": [\"WalletOrderExtractedView\"], \"deployment\": [\"production\"], \"featureFlag\": \"OrionSQL\", \"legacyName\": \"WalletOrderShipmentFullFillmentInfo\", \"name\": \"WalletOrderShipmentFullFillmentInfo\", \"platforms\": {\"iOS\": \"18.0\"}, \"sql\": {\"update\": \"WITH WalletShipmentSubjects AS MATERIALIZED (\\n  -- NOTE: If we trust that subject_cond contains only nm_shipmentFullFillmentInfo subjects, this may not be needed.\\n  -- For now, this table enforces that the subjects we consider are nm_shipmentFullFillmentInfo subjects\\n  SELECT DISTINCT\\n    subject\\n  FROM\\n    \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\"\\n  WHERE\\n    predicate = 'PS1'\\n    AND object = 'nm_shipmentFullFillmentInfo'\\n    AND $SUBJECT_COND(subject)\\n),\\nWalletShipmentSubgraph AS MATERIALIZED (\\n  -- PERF: Failing to materialize this subgraph leads to extremely large processing times when there are many subjects\\n  SELECT\\n    subject,\\n    predicate,\\n    object,\\n    relationshipPredicate,\\n    relationshipId\\n  FROM\\n    \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\"\\n  WHERE\\n    subject IN (SELECT subject FROM WalletShipmentSubjects)\\n),\\nWalletTrackingNumber AS (\\n  SELECT\\n    subject,\\n    object AS trackingNumber\\n  FROM\\n    WalletShipmentSubgraph\\n  WHERE\\n    predicate = 'nm_trackingNumber'\\n),\\nWalletShippingMethod AS (\\n  SELECT\\n    subject,\\n    object AS shippingMethod\\n  FROM\\n    WalletShipmentSubgraph\\n  WHERE\\n    predicate = 'nm_shippingMethod'\\n),\\nWalletShippingStatus AS (\\n  SELECT\\n    subject,\\n    object AS shippingStatus\\n  FROM\\n    WalletShipmentSubgraph\\n  WHERE\\n    predicate = 'nm_shippingStatus'\\n),\\nWalletShippingCarrier AS (\\n  SELECT\\n    subject,\\n    object AS carrierName\\n  FROM\\n    WalletShipmentSubgraph\\n  WHERE\\n    predicate = 'nm_carrierName'\\n),\\nWalletShippingEmail AS (\\n  SELECT\\n    subject,\\n    object AS emailIdentifier\\n  FROM\\n    WalletShipmentSubgraph\\n  WHERE\\n    predicate = 'nm_hasEmail'\\n    AND relationshipPredicate = 'nm_emailIdentifier'\\n),\\nWalletPersonEmail AS (\\n  SELECT\\n    subject,\\n    object AS personIdentifier\\n  FROM\\n    WalletShipmentSubgraph\\n  WHERE\\n    predicate = 'nm_hasPerson'\\n    AND relationshipPredicate = 'nm_personIdentifier'\\n),\\nWalletShippingDates AS (\\n  SELECT\\n    subject,\\n    predicate,\\n    object,\\n    relationshipId,\\n    relationshipPredicate\\n  FROM\\n    WalletShipmentSubgraph\\n  WHERE\\n    predicate = 'nm_hasDate'\\n),\\nWalletShipmentUpdateDateRecord AS (\\n  SELECT\\n    subject,\\n    predicate,\\n    object,\\n    relationshipId,\\n    relationshipPredicate\\n  FROM\\n    WalletShippingDates\\n  WHERE\\n    predicate = 'nm_hasDate'\\n    AND object = 'fullfillmentUpdateDate'\\n),\\nWalletShipmentUpdateDateEntries AS (\\n  SELECT\\n    WalletShippingDates.*\\n  from\\n    WalletShipmentUpdateDateRecord\\n    LEFT JOIN WalletShippingDates ON WalletShipmentUpdateDateRecord.relationshipId = WalletShippingDates.relationshipId\\n),\\nWalletShipmentUpdateDate AS (\\n  SELECT\\n    subject,\\n    object AS fullfillmentUpdateDate\\n  FROM\\n    WalletShipmentUpdateDateEntries\\n  WHERE\\n    relationshipPredicate = 'nm_imputedOccurrenceDate'\\n),\\nWalletEstimatedStartRecord AS (\\n  SELECT\\n    subject,\\n    predicate,\\n    object,\\n    relationshipId,\\n    relationshipPredicate\\n  FROM\\n    WalletShippingDates\\n  WHERE\\n    predicate = 'nm_hasDate'\\n    AND object = 'estimatedStartDate'\\n),\\nWalletEstimatedStartDateEntries AS (\\n  SELECT\\n    WalletShippingDates.*\\n  from\\n    WalletEstimatedStartRecord\\n    LEFT JOIN WalletShippingDates ON WalletEstimatedStartRecord.relationshipId = WalletShippingDates.relationshipId\\n),\\nWalletShippingEstimatedStartDate AS (\\n  SELECT\\n    subject,\\n    object AS estimatedDeliveryStartDate\\n  FROM\\n    WalletEstimatedStartDateEntries\\n  WHERE\\n    relationshipPredicate = 'nm_imputedOccurrenceDate'\\n),\\nWalletShippingEstimatedStartTime AS (\\n  SELECT\\n    subject,\\n    object AS estimatedDeliveryStartTime\\n  FROM\\n    WalletEstimatedStartDateEntries\\n  WHERE\\n    relationshipPredicate = 'nm_imputedStartTime'\\n),\\nWalletEstimatedEndRecord AS (\\n  SELECT\\n    subject,\\n    predicate,\\n    object,\\n    relationshipId,\\n    relationshipPredicate\\n  FROM\\n    WalletShippingDates\\n  WHERE\\n    predicate = 'nm_hasDate'\\n    AND object = 'estimatedEndDate'\\n),\\nWalletEstimatedEndDateEntries AS (\\n  SELECT\\n    WalletShippingDates.*\\n  from\\n    WalletEstimatedEndRecord\\n    LEFT JOIN WalletShippingDates ON WalletEstimatedEndRecord.relationshipId = WalletShippingDates.relationshipId\\n),\\nWalletShippingEstimatedEndDate AS (\\n  SELECT\\n    subject,\\n    object AS estimatedDeliveryEndDate\\n  FROM\\n    WalletEstimatedEndDateEntries\\n  WHERE\\n    relationshipPredicate = 'nm_imputedOccurrenceDate'\\n),\\nWalletShippingEstimatedEndTime AS (\\n  SELECT\\n    subject,\\n    object AS estimatedDeliveryEndTime\\n  FROM\\n    WalletEstimatedEndDateEntries\\n  WHERE\\n    relationshipPredicate = 'nm_imputedEndTime'\\n),\\nWalletEstimatedDeliveryRecord AS (\\n  SELECT\\n    subject,\\n    predicate,\\n    object,\\n    relationshipId,\\n    relationshipPredicate\\n  FROM\\n    WalletShippingDates\\n  WHERE\\n    predicate = 'nm_hasDate'\\n    AND object = 'deliveryDate'\\n),\\nWalletEstimatedDeliveryDateEntries AS (\\n  SELECT\\n    WalletShippingDates.*\\n  from\\n    WalletEstimatedDeliveryRecord\\n    LEFT JOIN WalletShippingDates ON WalletEstimatedDeliveryRecord.relationshipId = WalletShippingDates.relationshipId\\n),\\nWalletShippingDeliveryDate AS (\\n  SELECT\\n    subject,\\n    object AS deliveryDate\\n  FROM\\n    WalletEstimatedDeliveryDateEntries\\n  WHERE\\n    relationshipPredicate = 'nm_imputedOccurrenceDate'\\n),\\nWalletShippingDeliveryTime AS (\\n  SELECT\\n    subject,\\n    object AS deliveryTime\\n  FROM\\n    WalletEstimatedDeliveryDateEntries\\n  WHERE\\n    relationshipPredicate = 'nm_imputedEndTime'\\n),\\nWalletEstimatedShipDateRecord AS (\\n  SELECT\\n    subject,\\n    predicate,\\n    object,\\n    relationshipId,\\n    relationshipPredicate\\n  FROM\\n    WalletShippingDates\\n  WHERE\\n    predicate = 'nm_hasDate'\\n    AND object = 'shippingDate'\\n),\\nWalletEstimatedShipDateEntries AS (\\n  SELECT\\n    WalletShippingDates.*\\n  from\\n    WalletEstimatedShipDateRecord\\n    LEFT JOIN WalletShippingDates ON WalletEstimatedShipDateRecord.relationshipId = WalletShippingDates.relationshipId\\n),\\nWalletShippingShipDate AS (\\n  SELECT\\n    subject,\\n    object AS shippingDate\\n  FROM\\n    WalletEstimatedShipDateEntries\\n  WHERE\\n    relationshipPredicate = 'nm_imputedOccurrenceDate'\\n),\\nWalletShipmentsRepeated AS (\\n  SELECT\\n    s.subject,\\n    WalletTrackingNumber.trackingNumber,\\n    WalletShippingMethod.shippingMethod,\\n    WalletShippingStatus.shippingStatus,\\n    WalletShippingCarrier.carrierName,\\n    WalletShippingEmail.emailIdentifier,\\n    WalletPersonEmail.personIdentifier,\\n    WalletShippingEstimatedStartDate.estimatedDeliveryStartDate,\\n    WalletShippingEstimatedStartTime.estimatedDeliveryStartTime,\\n    WalletShippingEstimatedEndDate.estimatedDeliveryEndDate,\\n    WalletShippingEstimatedEndTime.estimatedDeliveryEndTime,\\n    WalletShippingDeliveryDate.deliveryDate,\\n    WalletShippingDeliveryTime.deliveryTime,\\n    WalletShippingShipDate.shippingDate,\\n    WalletShipmentUpdateDate.fullfillmentUpdateDate\\n  FROM\\n    WalletShipmentSubjects AS s\\n    LEFT JOIN WalletTrackingNumber ON s.subject = WalletTrackingNumber.subject\\n    LEFT JOIN WalletShippingMethod ON s.subject = WalletShippingMethod.subject\\n    LEFT JOIN WalletShippingCarrier ON s.subject = WalletShippingCarrier.subject\\n    LEFT JOIN WalletShippingEmail ON s.subject = WalletShippingEmail.subject\\n    LEFT JOIN WalletPersonEmail ON s.subject = WalletPersonEmail.subject\\n    LEFT JOIN WalletShipmentUpdateDate ON s.subject = WalletShipmentUpdateDate.subject\\n    LEFT JOIN WalletShippingEstimatedStartDate ON s.subject = WalletShippingEstimatedStartDate.subject\\n    LEFT JOIN WalletShippingEstimatedStartTime ON s.subject = WalletShippingEstimatedStartTime.subject\\n    LEFT JOIN WalletShippingEstimatedEndDate ON s.subject = WalletShippingEstimatedEndDate.subject\\n    LEFT JOIN WalletShippingEstimatedEndTime ON s.subject = WalletShippingEstimatedEndTime.subject\\n    LEFT JOIN WalletShippingDeliveryDate ON s.subject = WalletShippingDeliveryDate.subject\\n    LEFT JOIN WalletShippingDeliveryTime ON s.subject = WalletShippingDeliveryTime.subject\\n    LEFT JOIN WalletShippingShipDate ON s.subject = WalletShippingShipDate.subject\\n    LEFT JOIN WalletShippingStatus ON s.subject = WalletShippingStatus.subject\\n),\\nWalletShipmentsRanked AS (\\n  SELECT\\n    *,\\n    ROW_NUMBER() OVER (PARTITION BY subject) AS rn\\n  FROM\\n    WalletShipmentsRepeated\\n)\\nSELECT\\n  subject,\\n  'md:' || subject AS identifier,\\n  trackingNumber,\\n  carrierName,\\n  entityIdentifier(emailIdentifier) AS emailIdentifier,\\n  shippingMethod,\\n  shippingStatus,\\n  shippingDate,\\n  estimatedDeliveryStartDate,\\n  estimatedDeliveryStartTime,\\n  estimatedDeliveryEndDate,\\n  estimatedDeliveryEndTime,\\n  deliveryDate,\\n  deliveryTime,\\n  fullfillmentUpdateDate,\\n  entityIdentifier(personIdentifier) AS personIdentifier\\nFROM\\n  WalletShipmentsRanked\\n\"}, \"target\": {\"database\": \"WalletPaymentsCommerce.Internal\", \"name\": \"WalletOrderShipmentFullFillmentInfo\", \"target\": \"WalletPaymentsCommerce.Internal.WalletOrderShipmentFullFillmentInfo\", \"type\": \"view\"}, \"type\": \"sqlConnection\", \"update\": {\"knowledgeGraphListeners\": [{\"filters\": [{\"entityType\": \"nm_shipmentFullFillmentInfo\"}], \"requiredSource\": false, \"schedule\": \"live\", \"source\": \"WalletClassicOrder\", \"stores\": [\"stableGraph\"]}, {\"filters\": [{\"entityType\": \"nm_shipmentFullFillmentInfo\"}], \"requiredSource\": false, \"schedule\": \"live\", \"source\": \"WalletEmailOrder\", \"stores\": [\"stableGraph\"]}, {\"filters\": [{\"entityType\": \"nm_shipmentFullFillmentInfo\"}], \"requiredSource\": false, \"schedule\": \"live\", \"source\": \"WalletTransactionOrder\", \"stores\": [\"stableGraph\"]}, {\"filters\": [{\"entityType\": \"nm_shipmentFullFillmentInfo\"}], \"requiredSource\": false, \"schedule\": \"live\", \"source\": \"WalletTrackedOrder\", \"stores\": [\"stableGraph\"]}], \"viewListeners\": [{\"diffType\": \"updatedObject\", \"filterQuery\": \"SELECT subject FROM \\\"WalletPaymentsCommerce.Internal.WalletOrderEmail\\\"\", \"fullRebuildOnChange\": true, \"name\": \"WalletOrderEmail\", \"rebuildView\": true, \"schedule\": \"live\"}]}, \"uuid\": \"D8668465-3B63-4F65-BE3D-808CED364C09\", \"version\": \"3bc00097-4d92-4b51-a63a-a3faada3b69e\"}"
+ "{\"configHash\": \"bfa291046ece1b2ff022e6f2af45dca0892930991d5f41037c923a63b47ca79c\", \"dependencies\": [\"initializeGlobalKnowledgeAssets\"], \"dependents\": [], \"deployment\": [\"production\"], \"featureFlag\": \"OrionSQL\", \"legacyName\": \"sportsTeams\", \"name\": \"sportsTeams\", \"platforms\": {\"iOS\": \"\", \"macOS\": \"\"}, \"sql\": {\"update\": \"WITH static_triples AS (\\n  SELECT\\n    *\\n  FROM\\n    \\\"IntelligencePlatform.GlobalKnowledgeGraph.StaticGraph\\\"\\n),\\nisAs AS (\\n  SELECT\\n    subject,\\n    object AS isA\\n  FROM\\n    static_graph\\n  WHERE\\n    predicate = 'PS1'\\n),\\nnames AS (\\n  SELECT\\n    subject,\\n    object AS name\\n  FROM\\n    static_graph\\n  WHERE\\n    predicate = 'PS33'\\n),\\numcIds AS (\\n  SELECT\\n    subject,\\n    object AS umcId\\n  FROM\\n    static_graph\\n  WHERE\\n    predicate = 'nm_UMC_ID'\\n  GROUP BY\\n    subject\\n),\\nleagueNames AS (\\n  SELECT\\n    subject,\\n    object AS leagueName\\n  FROM\\n    static_graph\\n  WHERE\\n    predicate = 'nm_league_name'\\n  GROUP BY\\n    subject\\n),\\nqIds AS (\\n  SELECT\\n    subject,\\n    object AS qid\\n  FROM\\n    static_graph\\n  WHERE\\n    predicate = 'PS102'\\n  GROUP BY\\n    subject\\n),\\nimageBytes AS (\\n  SELECT\\n    subject,\\n    object AS imageBytes\\n  FROM\\n    static_graph\\n  WHERE\\n    predicate = 'nm_image_bytes'\\n  GROUP BY\\n    subject\\n)\\nSELECT\\n  isAs.subject AS subject,\\n  'md:' || isAs.subject AS identifier,\\n  isAs.isA,\\n  names.name,\\n  umcIds.umcId,\\n  qIds.qid,\\n  leagueNames.leagueName,\\n  imageBytes.imageBytes\\nFROM\\n  isAs\\n  INNER JOIN names ON isAs.subject = names.subject\\n  INNER JOIN umcIds ON isAs.subject = umcIds.subject\\n  INNER JOIN qIds ON isAs.subject = qIds.subject\\n  INNER JOIN leagueNames ON isAs.subject = leagueNames.subject\\n  INNER JOIN imageBytes ON isAs.subject = imageBytes.subject\\nWHERE\\n  isA = 'SB14';\\n\"}, \"target\": {\"database\": \"IntelligencePlatform.Entity\", \"name\": \"sportsTeams\", \"target\": \"IntelligencePlatform.Entity.sportsTeams\", \"type\": \"view\"}, \"type\": \"sqlConnection\", \"update\": {\"globalKnowledgeGraphListeners\": [{\"assetName\": \"MediaEntitiesSubgraph\", \"fullRebuildOnChange\": true, \"rebuildView\": true, \"schedule\": \"live\"}], \"viewListeners\": [{\"name\": \"initializeGlobalKnowledgeAssets\", \"schedule\": \"none\"}]}, \"uuid\": \"44225F26-CBD2-41C5-B57E-919A01B76CCE\", \"version\": \"14b07a19-5c69-43eb-b6e3-05b8da77b8d6\"}"
+ "{\"configHash\": \"f7229cbe2459d45e5a6ada3353930f0c88dc783fd1a1471ea2ad88f30753705a\", \"dependencies\": [\"initializeGlobalKnowledgeAssets\"], \"dependents\": [], \"deployment\": [\"production\"], \"featureFlag\": \"OrionSQL\", \"legacyName\": \"holidayEvent\", \"name\": \"holidayEvent\", \"platforms\": {\"iOS\": \"\", \"macOS\": \"\"}, \"sql\": {\"update\": \"WITH static_triples AS (\\n  SELECT\\n    *\\n  FROM\\n    \\\"IntelligencePlatform.GlobalKnowledgeGraph.StaticGraph\\\"\\n),\\ntriples AS (\\n  SELECT\\n    static_graph.*\\n  FROM\\n    static_graph\\n    INNER JOIN static_assets ON static_graph.assetId = static_assets.id\\n  WHERE\\n    static_assets.name = 'HolidayEventSubgraph'\\n),\\nisAs AS (\\n  SELECT\\n    subject,\\n    object AS isA\\n  FROM\\n    triples\\n  WHERE\\n    triples.predicate = 'PS1'\\n),\\nnames AS (\\n  SELECT\\n    subject,\\n    object AS name\\n  FROM\\n    triples\\n  WHERE\\n    predicate = 'PS33'\\n),\\nalternateIds AS (\\n  SELECT\\n    subject,\\n    json_group_array(object) AS alternateIds\\n  FROM\\n    triples\\n  WHERE\\n    predicate = 'PS102'\\n  GROUP BY\\n    subject\\n),\\noccurances AS (\\n  SELECT\\n    subject,\\n    json_group_array(json(object)) AS occurances\\n  FROM\\n    triples\\n  WHERE\\n    predicate = 'nm_occurrenceDate'\\n  GROUP BY\\n    subject\\n)\\nSELECT\\n  isAs.subject AS subject,\\n  'md:' || isAs.subject AS identifier,\\n  isAs.isA,\\n  names.name,\\n  alternateIds.alternateIds,\\n  occurances.occurances\\nFROM\\n  isAs\\n  INNER JOIN names ON isAs.subject = names.subject\\n  INNER JOIN alternateIds ON isAs.subject = alternateIds.subject\\n  INNER JOIN occurances ON isAs.subject = occurances.subject;\\n\"}, \"target\": {\"database\": \"IntelligencePlatform.Entity\", \"name\": \"holidayEvent\", \"target\": \"IntelligencePlatform.Entity.holidayEvent\", \"type\": \"view\"}, \"type\": \"sqlConnection\", \"update\": {\"globalKnowledgeGraphListeners\": [{\"assetName\": \"HolidayEventSubgraph\", \"fullRebuildOnChange\": true, \"rebuildView\": true, \"schedule\": \"live\"}], \"viewListeners\": [{\"name\": \"initializeGlobalKnowledgeAssets\", \"schedule\": \"none\"}]}, \"uuid\": \"BA26240C-8B9B-4353-B6F9-F53BC6FAEBEA\", \"version\": \"92a847d3-278a-454b-ac84-87b3d980b614\"}"
- "    {\"tableName\": \"walletOrder\", \"primaryKeyColumns\": [\"identifier\", \"referenceId\"], \"columns\": [[\"subject\", \"INTEGER\"], [\"identifier\", \"TEXT\"], [\"orderNumber\", \"TEXT\"], [\"referenceEntityIdType\", \"TEXT\"], [\"referenceId\", \"INTEGER\"]], \"subjectIdentifierColumn\": \"subject\"}"
- "    {\"tableName\": \"walletOrderPerson\", \"columns\": [[\"subject\", \"INTEGER\"], [\"identifier\", \"TEXT\"], [\"name\", \"TEXT\"], [\"street\", \"TEXT\"], [\"city\", \"TEXT\"], [\"state\", \"TEXT\"], [\"country\", \"TEXT\"], [\"postal\", \"TEXT\"], [\"phone\", \"TEXT\"], [\"email\", \"TEXT\"]], \"subjectIdentifierColumn\": \"subject\"}"
- "1252727a-378f-4380-9d70-44b7cb9e2e16"
- "1e2cc9e4-9c37-4c0a-a2e0-d44be5a7ae9d"
- "1f88f88ecfaa58461a010b15fa3b73211b326c5a4bd2915aa0e4551e6fb18727"
- "22012a6c-1900-48ae-9ee6-a997e8f7f792"
- "236732d7-00ad-47a8-ac19-ada766a7872f"
- "288c24b5-006a-4073-b667-2dbd4672cdf8"
- "3820c45e65919e2fc1c2f7b000115fa6829b0553e4bd5a590a7e5e25c433dd84"
- "3fb9ea4e7f0341e05ebae37734c121d312684581a4f4d2db22ada54bd036edc1"
- "42df57a7bcbc4df9b3eed871208f014e41b1e3457ca9fa2f59102931fd770a61"
- "5152cd0f9ddc0c512221d03c11799643a5c33bb65c12aae976004b570158acb7"
- "5a5284102d2825fa526be30752697dbf86e84f2a7d26c7e129ad58a6094cb01b"
- "5d0be6ee-46df-4f30-ac31-544d12beb3be"
- "624db2ab-7c88-408f-b44c-1cd414a1a74b"
- "799bdcc8-02ff-4634-9e3a-c211268a2503"
- "7bf9e2507f039f0b5bc0f381f63d036eb8a5d2c1a93f32d62d68d36b88c7d919"
- "810c5dc81078144752dc5ddab04b0c41ad62b73757af7c48c62b4e4227cad0ee"
- "85efc00a5f033cf81e6c9ed9807dc13a385f4ec8c47e24246014cdf6c09251dc"
- "8bd9d1eb-8fa9-4988-8486-cf3c1fe3b8ea"
- "8f882c2f-a95e-41c0-9d0f-1c12a0ed24f7"
- "a86bdc0ee08006c69d6672ef7a0bf8e430e80dbe8497637aef8e09e4b998db45"
- "ae9fe8cf-ee2f-4017-9264-dcc71bcdbaea"
- "b07c4a57f59def5ca516cff47c623bf38958c76cb903b2fcb03b34c059d7bf61"
- "c0b4f14f-ff27-447c-a5c6-2ee2c8d9b99e"
- "c5ec8d58-b59f-45c8-9d3e-a47adc022fc0"
- "ce67ef59-18f1-4ab9-b591-8b0ed249aab7"
- "ced96078-30d4-44f5-a8f5-bdc488caaaa8"
- "da088a9112dcce748657b4353fad46d4fc5bcbf3c819a8b6611262efb5f3e894"
- "e35d0dd29b08d45ad69a4fbc97ac2121e468b5557e01e24dfbe1246df27cb5e7"
- "e6f37a0c711e82527fa75b59784a3ffc0bbbdca3b67d8148ec0f57af7069dfd8"
- "fcf226454a59cecbe50797380911fa3deae88fc16ef4f056332e7f88d64f0fa3"
- "{\"configHash\": \"1f88f88ecfaa58461a010b15fa3b73211b326c5a4bd2915aa0e4551e6fb18727\", \"dependencies\": [\"initializeGlobalKnowledgeAssets\"], \"dependents\": [], \"deployment\": [\"production\"], \"featureFlag\": \"OrionSQL\", \"legacyName\": \"holidayEvent\", \"name\": \"holidayEvent\", \"platforms\": {\"iOS\": \"\", \"macOS\": \"\", \"visionOS\": \"\"}, \"sql\": {\"update\": \"WITH static_triples AS (\\n  SELECT\\n    *\\n  FROM\\n    \\\"IntelligencePlatform.GlobalKnowledgeGraph.StaticGraph\\\"\\n),\\ntriples AS (\\n  SELECT\\n    static_graph.*\\n  FROM\\n    static_graph\\n    INNER JOIN static_assets ON static_graph.assetId = static_assets.id\\n  WHERE\\n    static_assets.name = 'HolidayEventSubgraph'\\n),\\nisAs AS (\\n  SELECT\\n    subject,\\n    object AS isA\\n  FROM\\n    triples\\n  WHERE\\n    triples.predicate = 'PS1'\\n),\\nnames AS (\\n  SELECT\\n    subject,\\n    object AS name\\n  FROM\\n    triples\\n  WHERE\\n    predicate = 'PS33'\\n),\\nalternateIds AS (\\n  SELECT\\n    subject,\\n    json_group_array(object) AS alternateIds\\n  FROM\\n    triples\\n  WHERE\\n    predicate = 'PS102'\\n  GROUP BY\\n    subject\\n),\\noccurances AS (\\n  SELECT\\n    subject,\\n    json_group_array(json(object)) AS occurances\\n  FROM\\n    triples\\n  WHERE\\n    predicate = 'nm_occurrenceDate'\\n  GROUP BY\\n    subject\\n)\\nSELECT\\n  isAs.subject AS subject,\\n  'md:' || isAs.subject AS identifier,\\n  isAs.isA,\\n  names.name,\\n  alternateIds.alternateIds,\\n  occurances.occurances\\nFROM\\n  isAs\\n  INNER JOIN names ON isAs.subject = names.subject\\n  INNER JOIN alternateIds ON isAs.subject = alternateIds.subject\\n  INNER JOIN occurances ON isAs.subject = occurances.subject;\\n\"}, \"target\": {\"database\": \"IntelligencePlatform.Entity\", \"name\": \"holidayEvent\", \"target\": \"IntelligencePlatform.Entity.holidayEvent\", \"type\": \"view\"}, \"type\": \"sqlConnection\", \"update\": {\"globalKnowledgeGraphListeners\": [{\"assetName\": \"HolidayEventSubgraph\", \"fullRebuildOnChange\": true, \"rebuildView\": true, \"schedule\": \"live\"}], \"viewListeners\": [{\"name\": \"initializeGlobalKnowledgeAssets\", \"schedule\": \"none\"}]}, \"uuid\": \"BA26240C-8B9B-4353-B6F9-F53BC6FAEBEA\", \"version\": \"236732d7-00ad-47a8-ac19-ada766a7872f\"}"
- "{\"configHash\": \"3820c45e65919e2fc1c2f7b000115fa6829b0553e4bd5a590a7e5e25c433dd84\", \"dependencies\": [], \"dependents\": [\"WalletOrderExtractedView\"], \"deployment\": [\"production\"], \"featureFlag\": \"OrionSQL\", \"legacyName\": \"WalletOrderPerson\", \"name\": \"WalletOrderPerson\", \"platforms\": {\"iOS\": \"18.0\"}, \"sql\": {\"update\": \"WITH PersonSubgraph AS (\\n  SELECT\\n    g1.subject AS subject,\\n    g1.predicate,\\n    g1.object,\\n    g1.relationshipPredicate,\\n    g1.relationshipId\\n  FROM\\n    \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\" g1\\n    JOIN \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\" g2 on g1.subject = g2.subject\\n    WHERE\\n      g2.predicate = 'PS1'\\n      AND g2.object = 'SB104'\\n      AND $SUBJECT_COND(g1.subject)\\n),\\nWalletPersonSubjects AS (\\n  SELECT\\n    DISTINCT subject\\n  FROM\\n    PersonSubgraph\\n),\\nWalletPersonNames AS (\\n  SELECT\\n    subject,\\n    object as name\\n  FROM\\n    PersonSubgraph\\n  WHERE\\n    predicate = 'PS313'\\n),\\nWalletPersonAddressRel AS (\\n  SELECT\\n    subject,\\n    predicate,\\n    object,\\n    relationshipId,\\n    relationshipPredicate\\n  FROM\\n    PersonSubgraph\\n  WHERE\\n    predicate = 'PS520'\\n),\\nWalletPersonAddressCityList AS (\\n  SELECT\\n    subject,\\n    predicate,\\n    object,\\n    relationshipId,\\n    relationshipPredicate\\n  FROM\\n    WalletPersonAddressRel\\n  WHERE\\n    predicate = 'PS520'\\n    AND object = 'CS97'\\n),\\nWalletPersonCityEntries AS (\\n  SELECT\\n    WalletPersonAddressRel.*\\n  from\\n    WalletPersonAddressCityList\\n    LEFT JOIN WalletPersonAddressRel ON WalletPersonAddressCityList.relationshipId = WalletPersonAddressRel.relationshipId\\n),\\nWalletPersonCityRecord AS (\\n  SELECT\\n    subject,\\n    object as city\\n  FROM\\n    WalletPersonCityEntries\\n  WHERE\\n    relationshipPredicate = 'PS453'\\n),\\nWalletPersonStreetRecord AS (\\n  SELECT\\n    subject,\\n    object as street\\n  FROM\\n    WalletPersonCityEntries\\n  WHERE\\n    relationshipPredicate = 'PS316'\\n),\\nWalletPersonState AS (\\n  SELECT\\n    DISTINCT subject,\\n    object as state\\n  FROM\\n    WalletPersonCityEntries\\n  WHERE\\n    relationshipPredicate = 'PS455'\\n),\\nWalletPersonPostalRecord AS (\\n  SELECT\\n    DISTINCT subject,\\n    object as postal\\n  FROM\\n    WalletPersonCityEntries\\n  WHERE\\n    relationshipPredicate = 'PS315'\\n),\\nWalletPersonCountry AS (\\n  SELECT\\n    DISTINCT subject,\\n    object as country\\n  FROM\\n    WalletPersonCityEntries\\n  WHERE\\n    relationshipPredicate = 'PS450'\\n),\\nWalletPersonPhone AS (\\n  SELECT\\n    DISTINCT subject,\\n    object as phone\\n  FROM\\n    WalletPersonCityEntries\\n  WHERE\\n    relationshipPredicate = 'PS407'\\n),\\nWalletPersonEmail AS (\\n  SELECT\\n    DISTINCT subject,\\n    object as email\\n  FROM\\n    WalletPersonCityEntries\\n  WHERE\\n    relationshipPredicate = 'PS406'\\n),\\nWalletPersonRepeated AS (\\n  SELECT\\n    s.subject,\\n    WalletPersonNames.name,\\n    WalletPersonStreetRecord.street,\\n    WalletPersonCityRecord.city,\\n    WalletPersonState.state,\\n    WalletPersonPostalRecord.postal,\\n    WalletPersonCountry.country,\\n    WalletPersonPhone.phone,\\n    WalletPersonEmail.email\\n  FROM\\n    WalletPersonSubjects as s\\n    LEFT JOIN WalletPersonNames ON s.subject = WalletPersonNames.subject\\n    LEFT JOIN WalletPersonCityRecord ON s.subject = WalletPersonCityRecord.subject\\n    LEFT JOIN WalletPersonState ON s.subject = WalletPersonState.subject\\n    LEFT JOIN WalletPersonPostalRecord ON s.subject = WalletPersonPostalRecord.subject\\n    LEFT JOIN WalletPersonCountry ON s.subject = WalletPersonCountry.subject\\n    LEFT JOIN WalletPersonPhone ON s.subject = WalletPersonPhone.subject\\n    LEFT JOIN WalletPersonEmail ON s.subject = WalletPersonEmail.subject\\n    LEFT JOIN WalletPersonStreetRecord ON s.subject = WalletPersonStreetRecord.subject\\n),\\nWalletPersonSubjectsFinal AS (\\n  SELECT\\n    *,\\n    ROW_NUMBER() OVER (PARTITION BY subject) AS rn\\n  FROM\\n    WalletPersonRepeated\\n)\\nSELECT\\n  subject,\\n  'md:' || subject AS identifier,\\n  name,\\n  street,\\n  city,\\n  state,\\n  country,\\n  postal,\\n  phone,\\n  email\\nFROM\\n  WalletPersonSubjectsFinal\\nWHERE\\n  rn = 1\\n\"}, \"target\": {\"database\": \"WalletPaymentsCommerce.Internal\", \"name\": \"WalletOrderPerson\", \"target\": \"WalletPaymentsCommerce.Internal.WalletOrderPerson\", \"type\": \"view\"}, \"type\": \"sqlConnection\", \"update\": {\"knowledgeGraphListeners\": [{\"filters\": [{\"entityType\": \"SB104\"}], \"requiredSource\": false, \"schedule\": \"live\", \"stores\": [\"stableGraph\"]}, {\"filters\": [{\"entityType\": \"SB104\"}], \"requiredSource\": false, \"schedule\": \"live\", \"source\": \"WalletClassicOrder\", \"stores\": [\"stableGraph\"]}, {\"filters\": [{\"entityType\": \"SB104\"}], \"requiredSource\": false, \"schedule\": \"live\", \"source\": \"WalletEmailOrder\", \"stores\": [\"stableGraph\"]}, {\"filters\": [{\"entityType\": \"SB104\"}], \"requiredSource\": false, \"schedule\": \"live\", \"source\": \"WalletTransactionOrder\", \"stores\": [\"stableGraph\"]}, {\"filters\": [{\"entityType\": \"SB104\"}], \"requiredSource\": false, \"schedule\": \"live\", \"source\": \"WalletTrackedOrder\", \"stores\": [\"stableGraph\"]}]}, \"uuid\": \"2692b131-570b-4094-bbb3-7287bbbe4d6b\", \"version\": \"c5ec8d58-b59f-45c8-9d3e-a47adc022fc0\"}"
- "{\"configHash\": \"3fb9ea4e7f0341e05ebae37734c121d312684581a4f4d2db22ada54bd036edc1\", \"dependencies\": [], \"dependents\": [], \"deployment\": [\"production\"], \"featureFlag\": \"OrionSQL\", \"legacyName\": \"FlightReservations\", \"name\": \"FlightReservations\", \"platforms\": {\"iOS\": \"18.0\", \"macOS\": \"15.0\"}, \"sql\": {\"update\": \"WITH FlightReservationSubgraph AS (\\n  SELECT\\n    g1.subject,\\n    g1.predicate,\\n    g1.object,\\n    g1.relationshipPredicate,\\n    g1.relationshipId\\n  FROM\\n    \\\"IntelligencePlatform.KnowledgeGraph.EventGraph\\\" g1\\n    JOIN \\\"IntelligencePlatform.KnowledgeGraph.EventGraph\\\" g2 ON g1.subject = g2.subject\\n  WHERE\\n    g2.predicate = 'PS1'\\n    AND g2.object = 'SB514'\\n    AND $SUBJECT_COND(g1.subject)\\n), FlightReservationSubjects AS (\\n  SELECT DISTINCT subject as subject FROM FlightReservationSubgraph\\n), FlightReservationTitle AS (\\n  SELECT subject, object as title\\n  FROM FlightReservationSubgraph\\n  WHERE predicate = 'PS33'\\n),FlightReservationDescription AS (\\n  SELECT subject, object as description\\n  FROM FlightReservationSubgraph\\n  WHERE predicate = 'PS51'\\n), FlightReservationFlightNumber AS (\\n  SELECT subject, object as flightNumber\\n  FROM FlightReservationSubgraph\\n  WHERE predicate = 'nm_flightNumber'\\n), FlightReservationCarrierCode AS (\\n  SELECT subject, object as carrierCode\\n  FROM FlightReservationSubgraph\\n  WHERE predicate = 'nm_iataCode'\\n), DepartureAirportName as (\\n    SELECT F.subject, G.object as departureAirportName\\n    FROM FlightReservationSubgraph F\\n    JOIN \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\" G ON entityIdentifier(F.object) = G.subject\\n    WHERE F.predicate = 'PS248'\\n    AND G.predicate = 'PS33'\\n), DepartureAirportCode as (\\n    SELECT F.subject, G.object as departureAirportCode\\n    FROM FlightReservationSubgraph F\\n    JOIN \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\" G ON entityIdentifier(F.object) = G.subject\\n    WHERE F.predicate = 'PS248'\\n    AND G.predicate = 'nm_iataCode'\\n), DepartureAirportAddress as (\\n    SELECT F.subject, G.object as departureAirportAddress\\n    FROM FlightReservationSubgraph F\\n    JOIN \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\" G ON entityIdentifier(F.object) = G.subject\\n    WHERE F.predicate = 'PS248'\\n    AND G.predicate = 'nm_addressString'\\n), DepartureTime AS (\\n    SELECT subject, object as departureTime\\n    FROM FlightReservationSubgraph\\n    WHERE predicate = 'nm_hasDate' and relationshipPredicate = 'nm_imputedStartTime'\\n), DepartureAirportLatitude AS (\\n    SELECT F.subject, G.object as departureAirportLatitude\\n    FROM FlightReservationSubgraph F\\n    JOIN \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\" G ON entityIdentifier(F.object) = G.subject\\n    WHERE F.predicate = 'PS248'\\n    AND G.predicate = 'PS573'\\n    AND G.relationshipPredicate = 'PS571'\\n), DepartureAirportLongitude AS (\\n    SELECT F.subject, G.object as departureAirportLongitude\\n    FROM FlightReservationSubgraph F\\n    JOIN \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\" G ON entityIdentifier(F.object) = G.subject\\n    WHERE F.predicate = 'PS248'\\n    AND G.predicate = 'PS573'\\n    AND G.relationshipPredicate = 'PS572'\\n), ArrivalAirportName as (\\n    SELECT F.subject, G.object as arrivalAirportName\\n    FROM FlightReservationSubgraph F\\n    JOIN \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\" G ON entityIdentifier(F.object) = G.subject\\n    WHERE F.predicate = 'PS249'\\n    AND G.predicate = 'PS33'\\n), ArrivalAirportCode as (\\n    SELECT F.subject, G.object as arrivalAirportCode\\n    FROM FlightReservationSubgraph F\\n    JOIN \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\" G ON entityIdentifier(F.object) = G.subject\\n    WHERE F.predicate = 'PS249'\\n    AND G.predicate = 'nm_iataCode'\\n), ArrivalAirportAddress as (\\n    SELECT F.subject, G.object as arrivalAirportAddress\\n    FROM FlightReservationSubgraph F\\n    JOIN \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\" G ON entityIdentifier(F.object) = G.subject\\n    WHERE F.predicate = 'PS249'\\n    AND G.predicate = 'nm_addressString'\\n), ArrivalTime AS (\\n    SELECT subject, object as arrivalTime\\n    FROM FlightReservationSubgraph\\n    WHERE predicate = 'nm_hasDate' and relationshipPredicate = 'nm_imputedEndTime'\\n), ArrivalAirportLatitude AS (\\n    SELECT F.subject, G.object as arrivalAirportLatitude\\n    FROM FlightReservationSubgraph F\\n    JOIN \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\" G ON entityIdentifier(F.object) = G.subject\\n    WHERE F.predicate = 'PS249'\\n    AND G.predicate = 'PS573'\\n    AND G.relationshipPredicate = 'PS571'\\n), ArrivalAirportLongitude AS (\\n    SELECT F.subject, G.object as arrivalAirportLongitude\\n    FROM FlightReservationSubgraph F\\n    JOIN \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\" G ON entityIdentifier(F.object) = G.subject\\n    WHERE F.predicate = 'PS249'\\n    AND G.predicate = 'PS573'\\n    AND G.relationshipPredicate = 'PS572'\\n), PassengerNames AS (\\n    SELECT F1.subject, json_group_array(G.object) as passengerNames\\n    FROM FlightReservationSubgraph F1\\n    JOIN FlightReservationSubgraph F2 ON F1.relationshipId = F2.relationshipId\\n    JOIN \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\" G ON entityIdentifier(F2.object) = G.subject\\n    WHERE F1.predicate = 'PS232' AND F1.relationshipPredicate = 'PS1' AND F1.object = 'CS38'\\n        AND F2.relationshipPredicate = 'PS143'\\n        AND G.predicate = 'PS33'\\n    GROUP BY F1.subject\\n), ExtractionSource AS (\\n    SELECT subject, object as extractionSource\\n    FROM FlightReservationSubgraph\\n    WHERE predicate = 'nm_sourceType'\\n), FlightsRepeated AS (\\n  SELECT\\n    s.subject,\\n    FlightReservationTitle.title,\\n    FlightReservationDescription.description,\\n    FlightReservationFlightNumber.flightNumber,\\n    FlightReservationCarrierCode.carrierCode,\\n    DepartureAirportName.departureAirportName,\\n    DepartureAirportCode.departureAirportCode,\\n    DepartureAirportAddress.departureAirportAddress,\\n    DepartureAirportLatitude.departureAirportLatitude,\\n    DepartureAirportLongitude.departureAirportLongitude,\\n    DepartureTime.departureTime,\\n    ArrivalAirportName.arrivalAirportName,\\n    ArrivalAirportCode.arrivalAirportCode,\\n    ArrivalAirportAddress.arrivalAirportAddress,\\n    ArrivalAirportLatitude.arrivalAirportLatitude,\\n    ArrivalAirportLongitude.arrivalAirportLongitude,\\n    ArrivalTime.arrivalTime,\\n    PassengerNames.passengerNames,\\n    ExtractionSource.extractionSource\\n  FROM\\n    FlightReservationSubjects s\\n    LEFT JOIN FlightReservationTitle ON s.subject = FlightReservationTitle.subject\\n    LEFT JOIN FlightReservationDescription ON s.subject = FlightReservationDescription.subject\\n    LEFT JOIN FlightReservationFlightNumber ON s.subject = FlightReservationFlightNumber.subject\\n    LEFT JOIN FlightReservationCarrierCode ON s.subject = FlightReservationCarrierCode.subject\\n    LEFT JOIN DepartureAirportName ON s.subject = DepartureAirportName.subject\\n    LEFT JOIN DepartureAirportCode ON s.subject = DepartureAirportCode.subject\\n    LEFT JOIN DepartureAirportAddress ON s.subject = DepartureAirportAddress.subject\\n    LEFT JOIN DepartureTime ON s.subject = DepartureTime.subject\\n    LEFT JOIN DepartureAirportLatitude ON s.subject = DepartureAirportLatitude.subject\\n    LEFT JOIN DepartureAirportLongitude ON s.subject = DepartureAirportLongitude.subject\\n    LEFT JOIN ArrivalAirportName ON s.subject = ArrivalAirportName.subject\\n    LEFT JOIN ArrivalAirportCode ON s.subject = ArrivalAirportCode.subject\\n    LEFT JOIN ArrivalAirportAddress ON s.subject = ArrivalAirportAddress.subject\\n    LEFT JOIN ArrivalAirportLatitude ON s.subject = ArrivalAirportLatitude.subject\\n    LEFT JOIN ArrivalAirportLongitude ON s.subject = ArrivalAirportLongitude.subject\\n    LEFT JOIN ArrivalTime ON s.subject = ArrivalTime.subject\\n    LEFT JOIN PassengerNames ON s.subject = PassengerNames.subject\\n    LEFT JOIN ExtractionSource ON s.subject = ExtractionSource.subject\\n), FlightsRanked AS (\\n  SELECT\\n    *,\\n    ROW_NUMBER() OVER (PARTITION BY subject) AS rn\\n  FROM\\n    FlightsRepeated\\n)\\n\\nSELECT\\n    subject,\\n    'md:' || subject AS identifier,\\n    title,\\n    description,\\n    flightNumber,\\n    carrierCode,\\n    departureAirportName,\\n    departureAirportCode,\\n    departureAirportAddress,\\n    departureAirportLatitude,\\n    departureAirportLongitude,\\n    departureTime,\\n    arrivalAirportName,\\n    arrivalAirportCode,\\n    arrivalAirportAddress,\\n    arrivalAirportLatitude,\\n    arrivalAirportLatitude,\\n    arrivalTime,\\n    passengerNames,\\n    extractionSource\\nFROM FlightsRanked\\nWHERE rn = 1\\n\"}, \"target\": {\"database\": \"IntelligencePlatform.Entity\", \"name\": \"FlightReservations\", \"target\": \"IntelligencePlatform.Entity.FlightReservations\", \"type\": \"view\"}, \"type\": \"sqlConnection\", \"update\": {\"knowledgeGraphListeners\": [{\"filters\": [{\"entityType\": \"SB514\", \"sources\": [\"SGEvent\"]}], \"schedule\": \"live\", \"stores\": [\"eventGraph\"]}]}, \"uuid\": \"08EDDFCE-98BC-42F2-AE1F-96CDA2CF1DD5\", \"version\": \"5d0be6ee-46df-4f30-ac31-544d12beb3be\"}"
- "{\"configHash\": \"42df57a7bcbc4df9b3eed871208f014e41b1e3457ca9fa2f59102931fd770a61\", \"dependencies\": [], \"dependents\": [\"WalletOrderExtractedView\"], \"deployment\": [\"production\"], \"featureFlag\": \"OrionSQL\", \"legacyName\": \"WalletOrderFields\", \"name\": \"WalletOrderFields\", \"platforms\": {\"iOS\": \"18.0\"}, \"sql\": {\"update\": \"WITH WalletOrderSubgraph AS (\\n  SELECT\\n    g1.subject,\\n    g1.predicate,\\n    g1.object,\\n    g1.relationshipPredicate,\\n    g1.relationshipId\\n  FROM\\n    \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\" g1\\n    JOIN \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\" g2 ON g1.subject = g2.subject\\n  WHERE\\n    g2.predicate = 'PS1'\\n    AND g2.object = 'nm_walletOrder'\\n    AND $SUBJECT_COND(g1.subject)\\n), WalletOrderSubjects AS (\\nSELECT DISTINCT subject FROM WalletOrderSubgraph\\n), WalletOrderNumber AS (\\nSELECT subject, object as orderNumber\\nFROM WalletOrderSubgraph\\nWHERE predicate = 'nm_orderNumber'\\n),\\nWalletOrderDates AS (\\nSELECT subject, predicate, object , relationshipId, relationshipPredicate\\nFROM WalletOrderSubgraph\\nWHERE predicate = 'nm_hasDate'\\n),\\nWalletOrderDateRecord AS (\\nSELECT subject, predicate, object , relationshipId, relationshipPredicate\\nFROM WalletOrderDates\\nWHERE predicate = 'nm_hasDate' AND object = 'orderDate'),\\nWalletOrderDateEntries AS (\\nSELECT WalletOrderDates.* from WalletOrderDateRecord LEFT JOIN WalletOrderDates ON WalletOrderDateRecord.relationshipId = WalletOrderDates.relationshipId\\n),\\nWalletOrderDateFinal AS (\\nSELECT subject, object as orderDate\\nFROM WalletOrderDateEntries\\nWHERE relationshipPredicate = 'nm_imputedOccurrenceDate'\\n),\\nWalletOrderUpdateDateRecord AS (\\nSELECT subject, predicate, object , relationshipId, relationshipPredicate\\nFROM WalletOrderDates\\nWHERE predicate = 'nm_hasDate' AND object = 'orderUpdateDate'),\\nWalletOrderUpdateDateEntries AS (\\nSELECT WalletOrderDates.* from WalletOrderUpdateDateRecord LEFT JOIN WalletOrderDates ON WalletOrderUpdateDateRecord.relationshipId = WalletOrderDates.relationshipId\\n),\\nWalletUpdateOrderDateFinal AS (\\nSELECT subject, object as orderUpdateDate\\nFROM WalletOrderUpdateDateEntries\\nWHERE relationshipPredicate = 'nm_imputedOccurrenceDate'\\n),\\nWalletHasIdentifiers AS (\\nSELECT subject, predicate, object , relationshipId, relationshipPredicate\\nFROM WalletOrderSubgraph\\nWHERE predicate = 'PS72'\\n),\\nWalletOrderTypeRecord AS (\\nSELECT subject, predicate, object , relationshipId, relationshipPredicate\\nFROM WalletHasIdentifiers\\nWHERE predicate = 'PS72' AND object = 'orderType'),\\nWalletOrderTypeEntries AS (\\nSELECT WalletHasIdentifiers.* from WalletOrderTypeRecord LEFT JOIN WalletHasIdentifiers ON WalletOrderTypeRecord.relationshipId = WalletHasIdentifiers.relationshipId\\n)\\n,orderTypeIdentifier AS (\\nSELECT subject, object as orderTypeIdentifier\\nFROM WalletOrderTypeEntries\\nWHERE predicate = 'PS72' AND relationshipPredicate = 'PS33'\\n),orderIdentifier AS (\\nSELECT subject, object as orderIdentifier\\nFROM WalletOrderTypeEntries\\nWHERE predicate = 'PS72' AND relationshipPredicate = 'PS69'\\n),\\nWalletTrackedOrderTypeRecord AS (\\nSELECT subject, predicate, object , relationshipId, relationshipPredicate\\nFROM WalletHasIdentifiers\\nWHERE predicate = 'PS72' AND object = 'trackedOrderIdentifier'),\\nWalletTrackedOrderTypeEntries AS (\\nSELECT WalletHasIdentifiers.* from WalletTrackedOrderTypeRecord LEFT JOIN WalletHasIdentifiers ON WalletTrackedOrderTypeRecord.relationshipId = WalletHasIdentifiers.relationshipId\\n)\\n,TrackedOrderIdentifier AS (\\nSELECT subject, object as trackedOrderIdentifier\\nFROM WalletTrackedOrderTypeEntries\\nWHERE predicate = 'PS72' AND relationshipPredicate = 'PS69'\\n),\\nWalletOrdersRepeated AS (\\n  SELECT\\n    s.subject,\\n    WalletOrderNumber.orderNumber,\\n    WalletOrderDateFinal.orderDate,\\n    orderTypeIdentifier.orderTypeIdentifier,\\n    orderIdentifier.orderIdentifier,\\n    TrackedOrderIdentifier.trackedOrderIdentifier,\\n    WalletUpdateOrderDateFinal.orderUpdateDate\\n  FROM\\n    WalletOrderSubjects AS s\\n    LEFT JOIN WalletOrderNumber ON s.subject = WalletOrderNumber.subject\\n    LEFT JOIN orderTypeIdentifier ON s.subject = orderTypeIdentifier.subject\\n    LEFT JOIN orderIdentifier ON s.subject = orderIdentifier.subject\\n    LEFT JOIN WalletOrderDateFinal ON s.subject = WalletOrderDateFinal.subject\\n    LEFT JOIN WalletUpdateOrderDateFinal ON s.subject = WalletUpdateOrderDateFinal.subject\\n    LEFT JOIN TrackedOrderIdentifier ON s.subject = TrackedOrderIdentifier.subject\\n)\\nSELECT DISTINCT\\n  subject,\\n  'md:' || subject AS identifier,\\n  orderNumber,\\n  orderDate,\\n  orderTypeIdentifier,\\n  orderIdentifier,\\n  trackedOrderIdentifier,\\n  orderUpdateDate\\nFROM\\n  WalletOrdersRepeated\\n\"}, \"target\": {\"database\": \"WalletPaymentsCommerce.Internal\", \"name\": \"WalletOrderFields\", \"target\": \"WalletPaymentsCommerce.Internal.WalletOrderFields\", \"type\": \"view\"}, \"type\": \"sqlConnection\", \"update\": {\"knowledgeGraphListeners\": [{\"filters\": [{\"entityType\": \"nm_walletOrder\"}], \"requiredSource\": false, \"schedule\": \"live\", \"source\": \"WalletClassicOrder\", \"stores\": [\"stableGraph\"]}, {\"filters\": [{\"entityType\": \"nm_walletOrder\"}], \"requiredSource\": false, \"schedule\": \"live\", \"source\": \"WalletEmailOrder\", \"stores\": [\"stableGraph\"]}, {\"filters\": [{\"entityType\": \"nm_walletOrder\"}], \"requiredSource\": false, \"schedule\": \"live\", \"source\": \"WalletTransactionOrder\", \"stores\": [\"stableGraph\"]}, {\"filters\": [{\"entityType\": \"nm_walletOrder\"}], \"requiredSource\": false, \"schedule\": \"live\", \"source\": \"WalletTrackedOrder\", \"stores\": [\"stableGraph\"]}]}, \"uuid\": \"BC6D1A82-3165-4C64-B6D5-E1FBDFE8EDC5\", \"version\": \"c0b4f14f-ff27-447c-a5c6-2ee2c8d9b99e\"}"
- "{\"configHash\": \"5152cd0f9ddc0c512221d03c11799643a5c33bb65c12aae976004b570158acb7\", \"dependencies\": [\"initializeGlobalKnowledgeAssets\"], \"dependents\": [], \"deployment\": [\"production\"], \"featureFlag\": \"OrionSQL\", \"legacyName\": \"sportsTeams\", \"name\": \"sportsTeams\", \"platforms\": {\"iOS\": \"\", \"macOS\": \"\", \"visionOS\": \"\"}, \"sql\": {\"update\": \"WITH static_triples AS (\\n  SELECT\\n    *\\n  FROM\\n    \\\"IntelligencePlatform.GlobalKnowledgeGraph.StaticGraph\\\"\\n),\\nisAs AS (\\n  SELECT\\n    subject,\\n    object AS isA\\n  FROM\\n    static_graph\\n  WHERE\\n    predicate = 'PS1'\\n),\\nnames AS (\\n  SELECT\\n    subject,\\n    object AS name\\n  FROM\\n    static_graph\\n  WHERE\\n    predicate = 'PS33'\\n),\\numcIds AS (\\n  SELECT\\n    subject,\\n    object AS umcId\\n  FROM\\n    static_graph\\n  WHERE\\n    predicate = 'nm_UMC_ID'\\n  GROUP BY\\n    subject\\n),\\nleagueNames AS (\\n  SELECT\\n    subject,\\n    object AS leagueName\\n  FROM\\n    static_graph\\n  WHERE\\n    predicate = 'nm_league_name'\\n  GROUP BY\\n    subject\\n),\\nqIds AS (\\n  SELECT\\n    subject,\\n    object AS qid\\n  FROM\\n    static_graph\\n  WHERE\\n    predicate = 'PS102'\\n  GROUP BY\\n    subject\\n),\\nimageBytes AS (\\n  SELECT\\n    subject,\\n    object AS imageBytes\\n  FROM\\n    static_graph\\n  WHERE\\n    predicate = 'nm_image_bytes'\\n  GROUP BY\\n    subject\\n)\\nSELECT\\n  isAs.subject AS subject,\\n  'md:' || isAs.subject AS identifier,\\n  isAs.isA,\\n  names.name,\\n  umcIds.umcId,\\n  qIds.qid,\\n  leagueNames.leagueName,\\n  imageBytes.imageBytes\\nFROM\\n  isAs\\n  INNER JOIN names ON isAs.subject = names.subject\\n  INNER JOIN umcIds ON isAs.subject = umcIds.subject\\n  INNER JOIN qIds ON isAs.subject = qIds.subject\\n  INNER JOIN leagueNames ON isAs.subject = leagueNames.subject\\n  INNER JOIN imageBytes ON isAs.subject = imageBytes.subject\\nWHERE\\n  isA = 'SB14';\\n\"}, \"target\": {\"database\": \"IntelligencePlatform.Entity\", \"name\": \"sportsTeams\", \"target\": \"IntelligencePlatform.Entity.sportsTeams\", \"type\": \"view\"}, \"type\": \"sqlConnection\", \"update\": {\"globalKnowledgeGraphListeners\": [{\"assetName\": \"MediaEntitiesSubgraph\", \"fullRebuildOnChange\": true, \"rebuildView\": true, \"schedule\": \"live\"}], \"viewListeners\": [{\"name\": \"initializeGlobalKnowledgeAssets\", \"schedule\": \"none\"}]}, \"uuid\": \"44225F26-CBD2-41C5-B57E-919A01B76CCE\", \"version\": \"ce67ef59-18f1-4ab9-b591-8b0ed249aab7\"}"
- "{\"configHash\": \"5a5284102d2825fa526be30752697dbf86e84f2a7d26c7e129ad58a6094cb01b\", \"dependencies\": [], \"dependents\": [\"WalletOrderExtractedView\", \"WalletOrderShipmentFullFillmentInfo\"], \"deployment\": [\"production\"], \"featureFlag\": \"OrionSQL\", \"legacyName\": \"WalletOrderEmail\", \"name\": \"WalletOrderEmail\", \"platforms\": {\"iOS\": \"18.0\"}, \"sql\": {\"update\": \"WITH WalletEmailSubgraph AS (\\n  SELECT\\n    g1.subject,\\n    g1.predicate,\\n    g1.object,\\n    g1.relationshipPredicate,\\n    g1.relationshipId\\n  FROM\\n    \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\" g1\\n    JOIN \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\" g2 ON g1.subject = g2.subject\\n  WHERE\\n    g2.predicate = 'PS1'\\n    AND g2.object = 'nm_email'\\n    AND $SUBJECT_COND(g1.subject)\\n),\\nWalletEmailDisplaySubgraph AS (\\n  SELECT\\n    subject,\\n    predicate,\\n    object,\\n    relationshipPredicate,\\n    relationshipId\\n  FROM\\n    \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\" g1\\n  WHERE\\n    predicate = 'PS33'\\n    AND $SUBJECT_COND(g1.subject)\\n), WalletEmailSubjects AS (\\n  SELECT DISTINCT\\n    subject\\n  FROM\\n    WalletEmailSubgraph\\n),\\nEmailRelationSubgraph AS (\\n  SELECT\\n    subject,\\n    predicate,\\n    object,\\n    relationshipPredicate,\\n    relationshipId\\n  FROM\\n    \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\" g1\\n  WHERE\\n    predicate = 'PS520'\\n    AND relationshipPredicate = 'PS406'\\n    AND $SUBJECT_COND(g1.subject)\\n),\\nWalletEmailDates AS (\\n  SELECT\\n    subject,\\n    predicate,\\n    object,\\n    relationshipId,\\n    relationshipPredicate\\n  FROM\\n    WalletEmailSubgraph\\n  WHERE\\n    predicate = 'nm_hasDate'\\n),\\nWalletEmailSentDateRecords AS (\\n  SELECT\\n    subject,\\n    predicate,\\n    object,\\n    relationshipId,\\n    relationshipPredicate\\n  FROM\\n    WalletEmailDates\\n  WHERE\\n    predicate = 'nm_hasDate'\\n    AND object = 'dateSent'\\n),\\nWalletEstimatedStartDateEntries AS (\\n  SELECT\\n    WalletEmailDates.*\\n  FROM\\n    WalletEmailSentDateRecords\\n    LEFT JOIN WalletEmailDates ON WalletEmailSentDateRecords.relationshipId = WalletEmailDates.relationshipId\\n),\\nWalletEmailSentDate AS (\\n  SELECT\\n    subject,\\n    object as emailSent\\n  FROM\\n    WalletEstimatedStartDateEntries\\n  WHERE\\n    relationshipPredicate = 'nm_imputedOccurrenceDate'\\n),\\nEmailType AS (\\n  SELECT\\n    subject,\\n    object as emailType\\n  FROM\\n    WalletEmailSubgraph\\n  WHERE\\n    predicate = 'nm_emailType'\\n),\\nOrderNumber AS (\\n    SELECT\\n      subject,\\n      object as orderNumber\\n    FROM\\n      WalletEmailSubgraph\\n    WHERE\\n      predicate = 'nm_orderNumber'\\n),\\nTrackingNumber AS (\\n    SELECT\\n      subject,\\n      object as trackingNumber\\n    FROM\\n      WalletEmailSubgraph\\n    WHERE\\n      predicate = 'nm_trackingNumber'\\n),\\nMerchantName AS (\\n    SELECT\\n      subject,\\n      object as merchantName\\n    FROM\\n      WalletEmailSubgraph\\n    WHERE\\n      predicate = 'nm_merchantName'\\n),\\nMessageId AS (\\nSELECT\\n  subject,\\n  object as messageId\\nFROM\\n  WalletEmailSubgraph\\nWHERE\\n  predicate = 'PS69'\\n),\\nSenderDomain AS (\\n  SELECT\\n    subject,\\n    object as senderDomain\\n  FROM\\n    WalletEmailSubgraph\\n  WHERE\\n    predicate = 'nm_senderDomain'\\n),\\nEmailSubject AS (\\n  SELECT\\n    subject,\\n    object as emailSubject\\n  FROM\\n    WalletEmailSubgraph\\n  WHERE\\n    predicate = 'nm_subject'\\n),\\nEmailToAddress AS (\\n  SELECT\\n    subject,\\n    object as toEmailAddress\\n  FROM\\n    WalletEmailSubgraph\\n  WHERE\\n    predicate = 'nm_toEmailAddress'\\n),\\nEmailToDisplay AS (\\n  SELECT\\n    subject,\\n    object as toEmailDisplay\\n  FROM\\n    WalletEmailSubgraph\\n  WHERE\\n    predicate = 'nm_toDisplayName'\\n),\\nEmailFromIds AS (\\n  SELECT\\n    subject,\\n    entityIdentifier(object) AS emailFromId\\n  FROM\\n    WalletEmailSubgraph\\n  WHERE\\n    predicate = 'nm_emailFrom'\\n),\\nEmailFromIdDisplay AS (\\n  SELECT\\n    EmailFromIds.subject,\\n    WalletEmailDisplaySubgraph.object AS emailFromDisplay\\n  FROM\\n    EmailFromIds LEFT JOIN WalletEmailDisplaySubgraph ON EmailFromIds.emailFromId = WalletEmailDisplaySubgraph.subject\\n),\\nEmailReplyToIds AS (\\n  SELECT\\n    subject,\\n    entityIdentifier(object) AS emailReplyToId\\n  FROM\\n    WalletEmailSubgraph\\n  WHERE\\n    predicate = 'nm_emailReplyTo'\\n),\\nEmailReplyToIdDisplay AS (\\n  SELECT\\n    EmailReplyToIds.subject,\\n    WalletEmailDisplaySubgraph.object as emailReplyToDisplay\\n  FROM\\n    EmailReplyToIds\\n    LEFT JOIN WalletEmailDisplaySubgraph ON EmailReplyToIds.emailReplyToId = WalletEmailDisplaySubgraph.subject\\n),\\nEmailFromResolved AS (\\n  Select\\n    DISTINCT E1.subject AS subject,\\n    ERel.object AS emailFrom\\n  FROM\\n    EmailFromIds E1\\n    JOIN EmailRelationSubgraph ERel ON E1.emailFromId = ERel.subject\\n),\\nEmailReplyToResolved AS (\\n  Select\\n    DISTINCT E1.subject as subject,\\n    ERel.object as emailReplyTo\\n  FROM\\n    EmailReplyToIds E1\\n    JOIN EmailRelationSubgraph ERel on E1.emailReplyToId = ERel.subject\\n),\\nWalletEmailHasIdentifiers AS (\\n  SELECT\\n    subject,\\n    predicate,\\n    object,\\n    relationshipId,\\n    relationshipPredicate\\n  FROM\\n    WalletEmailSubgraph\\n  WHERE\\n    predicate = 'PS72'\\n),\\nspotlightUniqIdRecord AS (\\n  SELECT\\n    subject,\\n    predicate,\\n    object,\\n    relationshipId,\\n    relationshipPredicate\\n  FROM\\n    WalletEmailHasIdentifiers\\n  WHERE\\n    object = 'spotlightUniqueIdentifier'\\n),\\nspotlightUniqIdRecordEntries AS (\\n  SELECT\\n    WalletEmailHasIdentifiers.*\\n  from\\n    spotlightUniqIdRecord\\n    LEFT JOIN WalletEmailHasIdentifiers ON spotlightUniqIdRecord.relationshipId = WalletEmailHasIdentifiers.relationshipId\\n),\\nspotlightUniqIdentifier AS (\\n  SELECT\\n    subject,\\n    object as spotlightUniqIdentifier\\n  FROM\\n    spotlightUniqIdRecordEntries\\n  WHERE\\n    predicate = 'PS72'\\n    AND relationshipPredicate = 'PS69'\\n),\\nspotlightDomainIdRecord AS (\\n  SELECT\\n    subject,\\n    predicate,\\n    object,\\n    relationshipId,\\n    relationshipPredicate\\n  FROM\\n    WalletEmailHasIdentifiers\\n  WHERE\\n    object = 'spotlightDomainIdentifier'\\n),\\nspotlightDomainIdRecordEntries AS (\\n  SELECT\\n    WalletEmailHasIdentifiers.*\\n  from\\n    spotlightDomainIdRecord\\n    LEFT JOIN WalletEmailHasIdentifiers ON spotlightDomainIdRecord.relationshipId = WalletEmailHasIdentifiers.relationshipId\\n),\\nspotlightDomainIdentifier AS (\\n  SELECT\\n    subject,\\n    object as spotlightDomainIdentifier\\n  FROM\\n    spotlightDomainIdRecordEntries\\n  WHERE\\n    predicate = 'PS72'\\n    AND relationshipPredicate = 'PS69'\\n),\\nWalletEmailsRepeated AS (\\n  SELECT\\n    s.subject,\\n    SenderDomain.senderDomain,\\n    EmailSubject.emailSubject,\\n    EmailFromResolved.emailFrom,\\n    EmailFromIdDisplay.emailFromDisplay,\\n    EmailToAddress.toEmailAddress AS emailTo,\\n    EmailToDisplay.toEmailDisplay AS emailToDisplay,\\n    EmailReplyToResolved.emailReplyTo,\\n    EmailReplyToIdDisplay.emailReplyToDisplay,\\n    EmailType.emailType,\\n    WalletEmailSentDate.emailSent AS emailSentDate,\\n    MessageId.messageId AS messageID,\\n    spotlightUniqIdentifier.spotlightUniqIdentifier AS spotlightUniqueIdentifier,\\n    spotlightDomainIdentifier.spotlightDomainIdentifier AS spotlightDomainIdentifier,\\n    OrderNumber.orderNumber AS origOrderNumber,\\n    TrackingNumber.trackingNumber AS origTrackingNumber,\\n    MerchantName.merchantName AS origMerchantName\\n  FROM\\n    WalletEmailSubjects AS s\\n    LEFT JOIN SenderDomain ON s.subject = SenderDomain.subject\\n    LEFT JOIN EmailSubject ON s.subject = EmailSubject.subject\\n    LEFT JOIN EmailToAddress ON s.subject = EmailToAddress.subject\\n    LEFT JOIN EmailToDisplay ON s.subject = EmailToDisplay.subject\\n    LEFT JOIN EmailFromResolved ON s.subject = EmailFromResolved.subject\\n    LEFT JOIN EmailFromIdDisplay ON s.subject = EmailFromIdDisplay.subject\\n    LEFT JOIN EmailReplyToIdDisplay ON s.subject = EmailReplyToIdDisplay.subject\\n    LEFT JOIN EmailReplyToResolved ON s.subject = EmailReplyToResolved.subject\\n    LEFT JOIN EmailType ON s.subject = EmailType.subject\\n    LEFT JOIN WalletEmailSentDate ON s.subject = WalletEmailSentDate.subject\\n    LEFT JOIN MessageId ON s.subject = MessageId.subject\\n    LEFT JOIN spotlightUniqIdentifier ON s.subject = spotlightUniqIdentifier.subject\\n    LEFT JOIN spotlightDomainIdentifier ON s.subject = spotlightDomainIdentifier.subject\\n    LEFT JOIN OrderNumber ON s.subject = OrderNumber.subject\\n    LEFT JOIN TrackingNumber ON s.subject = TrackingNumber.subject\\n    LEFT JOIN MerchantName ON s.subject = MerchantName.subject\\n),\\nWalletEmailsRanked AS (\\n  SELECT\\n    *,\\n    ROW_NUMBER() OVER (PARTITION BY subject) as rn\\n  FROM\\n    WalletEmailsRepeated\\n)\\nSELECT\\n  subject,\\n  'md:' || subject AS identifier,\\n  emailType,\\n  senderDomain,\\n  emailSubject,\\n  emailFrom,\\n  emailFromDisplay,\\n  emailTo,\\n  emailToDisplay,\\n  emailReplyTo,\\n  emailReplyToDisplay,\\n  emailSentDate,\\n  messageID,\\n  spotlightUniqueIdentifier,\\n  spotlightDomainIdentifier,\\n  origOrderNumber,\\n  origTrackingNumber,\\n  origMerchantName\\nFROM\\n  WalletEmailsRanked\\nWHERE\\n  rn = 1\\n\"}, \"target\": {\"database\": \"WalletPaymentsCommerce.Internal\", \"name\": \"WalletOrderEmail\", \"target\": \"WalletPaymentsCommerce.Internal.WalletOrderEmail\", \"type\": \"view\"}, \"type\": \"sqlConnection\", \"update\": {\"knowledgeGraphListeners\": [{\"filters\": [{\"entityType\": \"nm_email\"}, {\"entityType\": \"SB104\", \"entityTypeIncludeDescendants\": true}, {\"entityType\": \"SB10\", \"entityTypeIncludeDescendants\": true}], \"requiredSource\": false, \"schedule\": \"live\", \"source\": \"WalletClassicOrder\", \"stores\": [\"stableGraph\"]}, {\"filters\": [{\"entityType\": \"nm_email\"}, {\"entityType\": \"SB104\", \"entityTypeIncludeDescendants\": true}, {\"entityType\": \"SB10\", \"entityTypeIncludeDescendants\": true}], \"requiredSource\": false, \"schedule\": \"live\", \"source\": \"WalletEmailOrder\", \"stores\": [\"stableGraph\"]}, {\"filters\": [{\"entityType\": \"nm_email\"}, {\"entityType\": \"SB104\", \"entityTypeIncludeDescendants\": true}, {\"entityType\": \"SB10\", \"entityTypeIncludeDescendants\": true}], \"requiredSource\": false, \"schedule\": \"live\", \"source\": \"WalletTransactionOrder\", \"stores\": [\"stableGraph\"]}, {\"filters\": [{\"entityType\": \"nm_email\"}, {\"entityType\": \"SB104\", \"entityTypeIncludeDescendants\": true}, {\"entityType\": \"SB10\", \"entityTypeIncludeDescendants\": true}], \"requiredSource\": false, \"schedule\": \"live\", \"source\": \"WalletTrackedOrder\", \"stores\": [\"stableGraph\"]}]}, \"uuid\": \"0342CEBC-B14A-45AC-8986-ED6E7CCD60D3\", \"version\": \"ced96078-30d4-44f5-a8f5-bdc488caaaa8\"}"
- "{\"configHash\": \"7bf9e2507f039f0b5bc0f381f63d036eb8a5d2c1a93f32d62d68d36b88c7d919\", \"dependencies\": [], \"dependents\": [\"WalletOrderExtractedView\"], \"deployment\": [\"production\"], \"featureFlag\": \"OrionSQL\", \"legacyName\": \"WalletOrderTransaction\", \"name\": \"WalletOrderTransaction\", \"platforms\": {\"iOS\": \"18.0\"}, \"sql\": {\"update\": \"WITH WalletTransactionSubgraph AS (\\n  SELECT\\n    g1.subject as subject,\\n    g1.predicate,\\n    g1.object,\\n    g1.relationshipPredicate,\\n    g1.relationshipId\\n  FROM\\n    \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\" g1\\n    JOIN \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\" g2 ON g1.subject = g2.subject\\n  WHERE\\n    g2.predicate = 'PS1'\\n    AND g2.object = 'nm_transaction'\\n    AND $SUBJECT_COND(g1.subject)\\n), WalletTransactionSubjects AS (\\nSELECT DISTINCT subject FROM WalletTransactionSubgraph\\n), CurrencyCode AS (\\nSELECT subject, object as currencyCode\\nFROM WalletTransactionSubgraph\\nWHERE predicate = 'nm_amount' AND relationshipPredicate = 'PS2'\\n), TotalAmount AS (\\nSELECT subject, object as totalAmount\\nFROM WalletTransactionSubgraph\\nWHERE predicate = 'nm_amount' AND relationshipPredicate = 'PS3'\\n), TrxAccountInstitution AS (\\nSELECT subject, object as accountInstitution\\nFROM WalletTransactionSubgraph\\nWHERE predicate = 'nm_accountInstitution'\\n), TrxAccountLastFourDigits AS (\\nSELECT subject, object as accountLastFourDigits\\nFROM WalletTransactionSubgraph\\nWHERE predicate = 'nm_accountLastFourDigits'\\n),TrxIdentifier AS (\\nSELECT subject, object as trxId\\nFROM WalletTransactionSubgraph\\nWHERE predicate = 'PS69'\\n),TrxDisplayName AS (\\nSELECT subject, object as trxDisplay\\nFROM WalletTransactionSubgraph\\nWHERE predicate = 'PS51'\\n), WalletTransactionsRepeated AS (\\nSELECT\\n  s.subject,\\n  CurrencyCode.currencyCode,\\n  TotalAmount.totalAmount,\\n  TrxAccountInstitution.accountInstitution,\\n  TrxAccountLastFourDigits.accountLastFourDigits,\\n  TrxIdentifier.trxId,\\n  TrxDisplayName.trxDisplay\\nFROM WalletTransactionSubjects as s\\nLEFT JOIN CurrencyCode ON s.subject = CurrencyCode.subject\\nLEFT JOIN TotalAmount ON s.subject = TotalAmount.subject\\nLEFT JOIN TrxAccountInstitution ON s.subject = TrxAccountInstitution.subject\\nLEFT JOIN TrxAccountLastFourDigits ON s.subject = TrxAccountLastFourDigits.subject\\nLEFT JOIN TrxIdentifier ON s.subject = TrxIdentifier.subject\\nLEFT JOIN TrxDisplayName ON s.subject = TrxDisplayName.subject\\n), WalletTransactionsRanked AS (\\n  SELECT *,\\n      ROW_NUMBER() OVER (PARTITION BY currencyCode, totalAmount, accountInstitution, accountLastFourDigits, trxId) as rn\\n  FROM WalletTransactionsRepeated\\n)\\n\\nSELECT\\n  subject,\\n  'md:' || subject AS identifier,\\n  currencyCode,\\n  totalAmount,\\n  accountInstitution,\\n  accountLastFourDigits,\\n  trxId,\\n  trxDisplay\\nFROM\\n  WalletTransactionsRanked\\nWHERE\\n  rn = 1\\n\"}, \"target\": {\"database\": \"WalletPaymentsCommerce.Internal\", \"name\": \"WalletOrderTransaction\", \"target\": \"WalletPaymentsCommerce.Internal.WalletOrderTransaction\", \"type\": \"view\"}, \"type\": \"sqlConnection\", \"update\": {\"knowledgeGraphListeners\": [{\"filters\": [{\"entityType\": \"nm_transaction\"}], \"requiredSource\": false, \"schedule\": \"live\", \"source\": \"WalletClassicOrder\", \"stores\": [\"stableGraph\"]}, {\"filters\": [{\"entityType\": \"nm_transaction\"}], \"requiredSource\": false, \"schedule\": \"live\", \"source\": \"WalletEmailOrder\", \"stores\": [\"stableGraph\"]}, {\"filters\": [{\"entityType\": \"nm_transaction\"}], \"requiredSource\": false, \"schedule\": \"live\", \"source\": \"WalletTransactionOrder\", \"stores\": [\"stableGraph\"]}, {\"filters\": [{\"entityType\": \"nm_transaction\"}], \"requiredSource\": false, \"schedule\": \"live\", \"source\": \"WalletTrackedOrder\", \"stores\": [\"stableGraph\"]}]}, \"uuid\": \"7C8D3B36-B9A9-4D1E-95F2-C5967ABA9238\", \"version\": \"22012a6c-1900-48ae-9ee6-a997e8f7f792\"}"
- "{\"configHash\": \"810c5dc81078144752dc5ddab04b0c41ad62b73757af7c48c62b4e4227cad0ee\", \"dependencies\": [\"WalletOrderEmail\"], \"dependents\": [\"WalletOrderExtractedView\"], \"deployment\": [\"production\"], \"featureFlag\": \"OrionSQL\", \"legacyName\": \"WalletOrderShipmentFullFillmentInfo\", \"name\": \"WalletOrderShipmentFullFillmentInfo\", \"platforms\": {\"iOS\": \"18.0\"}, \"sql\": {\"update\": \"WITH WalletShipmentSubgraph AS (\\n  SELECT\\n    g1.subject,\\n    g1.predicate,\\n    g1.object,\\n    g1.relationshipPredicate,\\n    g1.relationshipId\\n  FROM\\n    \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\" g1\\n    JOIN \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\" g2 ON g1.subject = g2.subject\\n  WHERE\\n    g2.predicate = 'PS1'\\n    AND g2.object = 'nm_shipmentFullFillmentInfo'\\n    AND $SUBJECT_COND(g1.subject)\\n),\\nWalletShipmentSubjects AS (\\n  SELECT DISTINCT\\n    subject\\n  FROM\\n    WalletShipmentSubgraph\\n),\\nWalletTrackingNumber AS (\\n  SELECT\\n    subject,\\n    object AS trackingNumber\\n  FROM\\n    WalletShipmentSubgraph\\n  WHERE\\n    predicate = 'nm_trackingNumber'\\n),\\nWalletShippingMethod AS (\\n  SELECT\\n    subject,\\n    object AS shippingMethod\\n  FROM\\n    WalletShipmentSubgraph\\n  WHERE\\n    predicate = 'nm_shippingMethod'\\n),\\nWalletShippingStatus AS (\\n  SELECT\\n    subject,\\n    object AS shippingStatus\\n  FROM\\n    WalletShipmentSubgraph\\n  WHERE\\n    predicate = 'nm_shippingStatus'\\n),\\nWalletShippingCarrier AS (\\n  SELECT\\n    subject,\\n    object AS carrierName\\n  FROM\\n    WalletShipmentSubgraph\\n  WHERE\\n    predicate = 'nm_carrierName'\\n),\\nWalletShippingEmail AS (\\n  SELECT\\n    subject,\\n    object AS emailIdentifier\\n  FROM\\n    WalletShipmentSubgraph\\n  WHERE\\n    predicate = 'nm_hasEmail'\\n    AND relationshipPredicate = 'nm_emailIdentifier'\\n),\\nWalletPersonEmail AS (\\n  SELECT\\n    subject,\\n    object AS personIdentifier\\n  FROM\\n    WalletShipmentSubgraph\\n  WHERE\\n    predicate = 'nm_hasPerson'\\n    AND relationshipPredicate = 'nm_personIdentifier'\\n),\\nWalletShippingDates AS (\\n  SELECT\\n    subject,\\n    predicate,\\n    object,\\n    relationshipId,\\n    relationshipPredicate\\n  FROM\\n    WalletShipmentSubgraph\\n  WHERE\\n    predicate = 'nm_hasDate'\\n),\\nWalletShipmentUpdateDateRecord AS (\\n  SELECT\\n    subject,\\n    predicate,\\n    object,\\n    relationshipId,\\n    relationshipPredicate\\n  FROM\\n    WalletShippingDates\\n  WHERE\\n    predicate = 'nm_hasDate'\\n    AND object = 'fullfillmentUpdateDate'\\n),\\nWalletShipmentUpdateDateEntries AS (\\n  SELECT\\n    WalletShippingDates.*\\n  from\\n    WalletShipmentUpdateDateRecord\\n    LEFT JOIN WalletShippingDates ON WalletShipmentUpdateDateRecord.relationshipId = WalletShippingDates.relationshipId\\n),\\nWalletShipmentUpdateDate AS (\\n  SELECT\\n    subject,\\n    object AS fullfillmentUpdateDate\\n  FROM\\n    WalletShipmentUpdateDateEntries\\n  WHERE\\n    relationshipPredicate = 'nm_imputedOccurrenceDate'\\n),\\nWalletEstimatedStartRecord AS (\\n  SELECT\\n    subject,\\n    predicate,\\n    object,\\n    relationshipId,\\n    relationshipPredicate\\n  FROM\\n    WalletShippingDates\\n  WHERE\\n    predicate = 'nm_hasDate'\\n    AND object = 'estimatedStartDate'\\n),\\nWalletEstimatedStartDateEntries AS (\\n  SELECT\\n    WalletShippingDates.*\\n  from\\n    WalletEstimatedStartRecord\\n    LEFT JOIN WalletShippingDates ON WalletEstimatedStartRecord.relationshipId = WalletShippingDates.relationshipId\\n),\\nWalletShippingEstimatedStartDate AS (\\n  SELECT\\n    subject,\\n    object AS estimatedDeliveryStartDate\\n  FROM\\n    WalletEstimatedStartDateEntries\\n  WHERE\\n    relationshipPredicate = 'nm_imputedOccurrenceDate'\\n),\\nWalletShippingEstimatedStartTime AS (\\n  SELECT\\n    subject,\\n    object AS estimatedDeliveryStartTime\\n  FROM\\n    WalletEstimatedStartDateEntries\\n  WHERE\\n    relationshipPredicate = 'nm_imputedStartTime'\\n),\\nWalletEstimatedEndRecord AS (\\n  SELECT\\n    subject,\\n    predicate,\\n    object,\\n    relationshipId,\\n    relationshipPredicate\\n  FROM\\n    WalletShippingDates\\n  WHERE\\n    predicate = 'nm_hasDate'\\n    AND object = 'estimatedEndDate'\\n),\\nWalletEstimatedEndDateEntries AS (\\n  SELECT\\n    WalletShippingDates.*\\n  from\\n    WalletEstimatedEndRecord\\n    LEFT JOIN WalletShippingDates ON WalletEstimatedEndRecord.relationshipId = WalletShippingDates.relationshipId\\n),\\nWalletShippingEstimatedEndDate AS (\\n  SELECT\\n    subject,\\n    object AS estimatedDeliveryEndDate\\n  FROM\\n    WalletEstimatedEndDateEntries\\n  WHERE\\n    relationshipPredicate = 'nm_imputedOccurrenceDate'\\n),\\nWalletShippingEstimatedEndTime AS (\\n  SELECT\\n    subject,\\n    object AS estimatedDeliveryEndTime\\n  FROM\\n    WalletEstimatedEndDateEntries\\n  WHERE\\n    relationshipPredicate = 'nm_imputedEndTime'\\n),\\nWalletEstimatedDeliveryRecord AS (\\n  SELECT\\n    subject,\\n    predicate,\\n    object,\\n    relationshipId,\\n    relationshipPredicate\\n  FROM\\n    WalletShippingDates\\n  WHERE\\n    predicate = 'nm_hasDate'\\n    AND object = 'deliveryDate'\\n),\\nWalletEstimatedDeliveryDateEntries AS (\\n  SELECT\\n    WalletShippingDates.*\\n  from\\n    WalletEstimatedDeliveryRecord\\n    LEFT JOIN WalletShippingDates ON WalletEstimatedDeliveryRecord.relationshipId = WalletShippingDates.relationshipId\\n),\\nWalletShippingDeliveryDate AS (\\n  SELECT\\n    subject,\\n    object AS deliveryDate\\n  FROM\\n    WalletEstimatedDeliveryDateEntries\\n  WHERE\\n    relationshipPredicate = 'nm_imputedOccurrenceDate'\\n),\\nWalletShippingDeliveryTime AS (\\n  SELECT\\n    subject,\\n    object AS deliveryTime\\n  FROM\\n    WalletEstimatedDeliveryDateEntries\\n  WHERE\\n    relationshipPredicate = 'nm_imputedEndTime'\\n),\\nWalletEstimatedShipDateRecord AS (\\n  SELECT\\n    subject,\\n    predicate,\\n    object,\\n    relationshipId,\\n    relationshipPredicate\\n  FROM\\n    WalletShippingDates\\n  WHERE\\n    predicate = 'nm_hasDate'\\n    AND object = 'shippingDate'\\n),\\nWalletEstimatedShipDateEntries AS (\\n  SELECT\\n    WalletShippingDates.*\\n  from\\n    WalletEstimatedShipDateRecord\\n    LEFT JOIN WalletShippingDates ON WalletEstimatedShipDateRecord.relationshipId = WalletShippingDates.relationshipId\\n),\\nWalletShippingShipDate AS (\\n  SELECT\\n    subject,\\n    object AS shippingDate\\n  FROM\\n    WalletEstimatedShipDateEntries\\n  WHERE\\n    relationshipPredicate = 'nm_imputedOccurrenceDate'\\n),\\nWalletShipmentsRepeated AS (\\n  SELECT\\n    s.subject,\\n    WalletTrackingNumber.trackingNumber,\\n    WalletShippingMethod.shippingMethod,\\n    WalletShippingStatus.shippingStatus,\\n    WalletShippingCarrier.carrierName,\\n    WalletShippingEmail.emailIdentifier,\\n    WalletPersonEmail.personIdentifier,\\n    WalletShippingEstimatedStartDate.estimatedDeliveryStartDate,\\n    WalletShippingEstimatedStartTime.estimatedDeliveryStartTime,\\n    WalletShippingEstimatedEndDate.estimatedDeliveryEndDate,\\n    WalletShippingEstimatedEndTime.estimatedDeliveryEndTime,\\n    WalletShippingDeliveryDate.deliveryDate,\\n    WalletShippingDeliveryTime.deliveryTime,\\n    WalletShippingShipDate.shippingDate,\\n    WalletShipmentUpdateDate.fullfillmentUpdateDate\\n  FROM\\n    WalletShipmentSubjects AS s\\n    LEFT JOIN WalletTrackingNumber ON s.subject = WalletTrackingNumber.subject\\n    LEFT JOIN WalletShippingMethod ON s.subject = WalletShippingMethod.subject\\n    LEFT JOIN WalletShippingCarrier ON s.subject = WalletShippingCarrier.subject\\n    LEFT JOIN WalletShippingEmail ON s.subject = WalletShippingEmail.subject\\n    LEFT JOIN WalletPersonEmail ON s.subject = WalletPersonEmail.subject\\n    LEFT JOIN WalletShipmentUpdateDate ON s.subject = WalletShipmentUpdateDate.subject\\n    LEFT JOIN WalletShippingEstimatedStartDate ON s.subject = WalletShippingEstimatedStartDate.subject\\n    LEFT JOIN WalletShippingEstimatedStartTime ON s.subject = WalletShippingEstimatedStartTime.subject\\n    LEFT JOIN WalletShippingEstimatedEndDate ON s.subject = WalletShippingEstimatedEndDate.subject\\n    LEFT JOIN WalletShippingEstimatedEndTime ON s.subject = WalletShippingEstimatedEndTime.subject\\n    LEFT JOIN WalletShippingDeliveryDate ON s.subject = WalletShippingDeliveryDate.subject\\n    LEFT JOIN WalletShippingDeliveryTime ON s.subject = WalletShippingDeliveryTime.subject\\n    LEFT JOIN WalletShippingShipDate ON s.subject = WalletShippingShipDate.subject\\n    LEFT JOIN WalletShippingStatus ON s.subject = WalletShippingStatus.subject\\n),\\nWalletShipmentsRanked AS (\\n  SELECT\\n    *,\\n    ROW_NUMBER() OVER (PARTITION BY subject) AS rn\\n  FROM\\n    WalletShipmentsRepeated\\n)\\nSELECT\\n  subject,\\n  'md:' || subject AS identifier,\\n  trackingNumber,\\n  carrierName,\\n  entityIdentifier(emailIdentifier) AS emailIdentifier,\\n  shippingMethod,\\n  shippingStatus,\\n  shippingDate,\\n  estimatedDeliveryStartDate,\\n  estimatedDeliveryStartTime,\\n  estimatedDeliveryEndDate,\\n  estimatedDeliveryEndTime,\\n  deliveryDate,\\n  deliveryTime,\\n  fullfillmentUpdateDate,\\n  entityIdentifier(personIdentifier) AS personIdentifier\\nFROM\\n  WalletShipmentsRanked\\n\"}, \"target\": {\"database\": \"WalletPaymentsCommerce.Internal\", \"name\": \"WalletOrderShipmentFullFillmentInfo\", \"target\": \"WalletPaymentsCommerce.Internal.WalletOrderShipmentFullFillmentInfo\", \"type\": \"view\"}, \"type\": \"sqlConnection\", \"update\": {\"knowledgeGraphListeners\": [{\"filters\": [{\"entityType\": \"nm_shipmentFullFillmentInfo\"}], \"requiredSource\": false, \"schedule\": \"live\", \"source\": \"WalletClassicOrder\", \"stores\": [\"stableGraph\"]}, {\"filters\": [{\"entityType\": \"nm_shipmentFullFillmentInfo\"}], \"requiredSource\": false, \"schedule\": \"live\", \"source\": \"WalletEmailOrder\", \"stores\": [\"stableGraph\"]}, {\"filters\": [{\"entityType\": \"nm_shipmentFullFillmentInfo\"}], \"requiredSource\": false, \"schedule\": \"live\", \"source\": \"WalletTransactionOrder\", \"stores\": [\"stableGraph\"]}, {\"filters\": [{\"entityType\": \"nm_shipmentFullFillmentInfo\"}], \"requiredSource\": false, \"schedule\": \"live\", \"source\": \"WalletTrackedOrder\", \"stores\": [\"stableGraph\"]}], \"viewListeners\": [{\"diffType\": \"updatedObject\", \"filterQuery\": \"SELECT subject FROM \\\"WalletPaymentsCommerce.Internal.WalletOrderEmail\\\"\", \"fullRebuildOnChange\": true, \"name\": \"WalletOrderEmail\", \"rebuildView\": true, \"schedule\": \"live\"}]}, \"uuid\": \"D8668465-3B63-4F65-BE3D-808CED364C09\", \"version\": \"1252727a-378f-4380-9d70-44b7cb9e2e16\"}"
- "{\"configHash\": \"85efc00a5f033cf81e6c9ed9807dc13a385f4ec8c47e24246014cdf6c09251dc\", \"dependencies\": [\"WalletOrderFields\", \"WalletTrackedOrderFields\", \"WalletOrder\", \"WalletOrderEmail\", \"WalletOrderPayment\", \"WalletOrderTransaction\", \"WalletOrderShipmentFullFillmentInfo\", \"WalletOrderPerson\"], \"dependents\": [\"WalletCascadeInsert\"], \"deployment\": [\"production\"], \"featureFlag\": \"OrionSQL\", \"legacyName\": \"WalletOrderExtractedView\", \"name\": \"WalletOrderExtractedView\", \"platforms\": {\"iOS\": \"18.0\"}, \"sql\": {\"update\": \"WITH WalletOrderFields AS (\\n  SELECT\\n    wof.*\\n  FROM\\n    (\\n      SELECT DISTINCT\\n        identifier\\n      FROM\\n        \\\"WalletPaymentsCommerce.Internal.WalletOrder\\\"\\n      WHERE\\n        referenceEntityIdType = 'emailIdentifier'\\n    ) AS EmailLinkedOrder\\n    INNER JOIN \\\"WalletPaymentsCommerce.Internal.WalletOrderFields\\\" wof ON EmailLinkedOrder.identifier = wof.identifier\\n),\\nWalletEmailOrder AS (\\n  SELECT\\n    subject,\\n    orderNumber,\\n    referenceId\\n  FROM\\n    \\\"WalletPaymentsCommerce.Internal.WalletOrder\\\"\\n  WHERE\\n    referenceEntityIdType = 'emailIdentifier'\\n),\\nWalletOrderMerchantListByEmail AS (\\n  SELECT\\n    ROW_NUMBER() OVER (\\n      PARTITION BY WalletEmailOrder.subject\\n      ORDER BY\\n        emailSentDate ASC\\n    ) as rn,\\n    WalletEmailOrder.subject,\\n    origOrderNumber as orderNumber,\\n    origMerchantName AS merchantName,\\n    emailSentDate\\n  FROM\\n    WalletEmailOrder\\n    LEFT JOIN \\\"WalletPaymentsCommerce.Internal.WalletOrderEmail\\\" we ON WalletEmailOrder.referenceId = we.subject\\n),\\nWalletTrackedOrderFields AS (\\n  SELECT\\n    subject,\\n    trkOrderNumber as orderNumber,\\n    trkMerchantName as merchantName,\\n    trkOrderStatus as orderStatus,\\n    earliestEmailDateSent as earliestEmailDateSent,\\n    displayNameUpdateDate ,\\n    orderStatusUpdateDate\\n  FROM\\n    \\\"WalletPaymentsCommerce.Internal.WalletTrackedOrderFields\\\"\\n),\\nWalletOrderMerchantListUnion AS (\\n    SELECT subject , orderNumber, merchantName, emailSentDate FROM WalletOrderMerchantListByEmail\\n    UNION\\n    SELECT subject, orderNumber, merchantName, displayNameUpdateDate as emailSentDate FROM\\n        WalletTrackedOrderFields WHERE displayNameUpdateDate IS NOT NULL AND displayNameUpdateDate!=''\\n),\\nWalletOrderEmailEarliestDateList AS (\\n    SELECT subject , emailSentDate AS earliestEmailDateSent FROM WalletOrderMerchantListByEmail\\n    UNION\\n    SELECT subject, earliestEmailDateSent FROM walletTrackedOrderFields WHERE earliestEmailDateSent IS NOT NULL AND earliestEmailDateSent!=''\\n),\\nWalletEmailsUnionRanked AS  (SELECT *,  ROW_NUMBER() OVER (\\n      PARTITION BY subject\\n      ORDER BY\\n        earliestEmailDateSent ASC\\n    ) as rn FROM WalletOrderEmailEarliestDateList),\\nWalletEmailEarliestDateFinal AS (\\n    SELECT subject, earliestEmailDateSent FROM WalletEmailsUnionRanked WHERE rn =1 ),\\nWalletOrderMerchantList AS (\\n    SELECT\\n      ROW_NUMBER() OVER (\\n        PARTITION BY subject\\n        ORDER BY\\n          emailSentDate ASC\\n      ) as rn,\\n      subject,\\n      orderNumber,\\n      merchantName,\\n      emailSentDate AS displayNameUpdateDate FROM\\n    WalletOrderMerchantListUnion\\n),\\nWalletOrderStatusRanked AS (\\n  SELECT\\n    WalletEmailOrder.subject,\\n    orderNumber,\\n    CASE\\n      WHEN emailType = '1' THEN '1'\\n      WHEN emailType = '3' THEN '3'\\n      WHEN emailType = '4' THEN '4'\\n      ELSE NULL\\n    END AS emailOrderStatus,\\n    emailSentDate\\n  FROM\\n    WalletEmailOrder\\n    LEFT JOIN \\\"WalletPaymentsCommerce.Internal.WalletOrderEmail\\\" we ON WalletEmailOrder.referenceId = we.subject\\n    UNION\\n  SELECT subject, orderNumber, orderStatus AS emailOrderStatus, orderStatusUpdateDate AS emailSentDate FROM WalletTrackedOrderFields\\n),\\nWalletOrderStatusRankedList AS (\\n  SELECT\\n    *,\\n    ROW_NUMBER() OVER (\\n      PARTITION BY WalletOrderStatusRanked.subject\\n      ORDER BY\\n        emailSentDate DESC\\n    ) as rn\\n  FROM\\n    WalletOrderStatusRanked\\n  where\\n    emailOrderStatus IS NOT NULL\\n),\\nWalletOrderStatusFinal AS (\\n  SELECT\\n    subject,\\n    orderNumber,\\n    emailOrderStatus AS orderStatus,\\n    emailSentDate AS orderStatusUpdateDate\\n  FROM\\n    WalletOrderStatusRankedList\\n  WHERE\\n    rn = 1\\n),\\nWalletOrderMerchant AS (\\n  SELECT\\n    subject,\\n    merchantName,\\n    orderNumber,\\n    JSON_OBJECT('displayName', merchantName,\\n     'displayNameUpdateDate',  CAST(displayNameUpdateDate AS REAL)) AS merchantJson\\n  FROM\\n    WalletOrderMerchantList\\n  WHERE\\n    rn = 1\\n),\\nWalletPersonOrder AS (\\n  SELECT\\n    subject,\\n    orderNumber,\\n    referenceId\\n  FROM\\n    walletOrder\\n  WHERE\\n    referenceEntityIdType = 'customerIdentifier'\\n),\\nWalletPersonOrderJson AS (\\n  SELECT\\n    WalletPersonOrder.subject,\\n    JSON_OBJECT(\\n      'fullName',\\n      name,\\n      'phoneNumber',\\n      phone,\\n      'emailAddress',\\n      email,\\n      'billingAddress',\\n      JSON_OBJECT(\\n        'street',\\n        street,\\n        'city',\\n        city,\\n        'state',\\n        state,\\n        'country',\\n        country,\\n        'postalCode',\\n        postal\\n      )\\n    ) AS personJson\\n  FROM\\n    WalletPersonOrder\\n    LEFT JOIN \\\"WalletPaymentsCommerce.Internal.WalletOrderPerson\\\" wop ON WalletPersonOrder.referenceId = wop.subject\\n),\\nWalletPymOrder AS (\\n  SELECT\\n    subject,\\n    orderNumber,\\n    referenceId\\n  FROM\\n    \\\"WalletPaymentsCommerce.Internal.WalletOrder\\\"\\n  WHERE\\n    referenceEntityIdType = 'paymentIdentifier'\\n),\\nWalletTrxOrder AS (\\n  SELECT\\n    subject,\\n    orderNumber,\\n    referenceId\\n  FROM\\n    \\\"WalletPaymentsCommerce.Internal.WalletOrder\\\"\\n  WHERE\\n    referenceEntityIdType = 'transactionIdentifier'\\n),\\nWalletPymTbl AS (\\n  SELECT\\n    WalletPymOrder.subject,\\n    orderNumber,\\n    totalAmount,\\n    currencyCode,\\n    ROW_NUMBER() OVER (\\n      PARTITION BY WalletPymOrder.subject\\n      ORDER BY\\n        totalAmount DESC\\n    ) AS rn\\n  FROM\\n    WalletPymOrder\\n    LEFT JOIN \\\"WalletPaymentsCommerce.Internal.WalletOrderPayment\\\" wop ON WalletPymOrder.referenceId = wop.subject\\n),\\nWalletPymCol AS (\\n  SELECT\\n    subject,\\n    orderNumber,\\n    totalAmount,\\n    currencyCode\\n  FROM\\n    WalletPymTbl\\n  where\\n    rn = 1\\n),\\nWalletTrxCol AS (\\n  SELECT DISTINCT\\n    WalletTrxOrder.subject,\\n    JSON_GROUP_ARRAY(\\n      JSON_OBJECT(\\n        'amount',\\n        totalAmount,\\n        'isoCurrencyCode',\\n        currencyCode,\\n        'transactionIdenifier',\\n        trxId,\\n        'paymentMethod',\\n        JSON_OBJECT(\\n          'lastFourDigits',\\n          accountLastFourDigits,\\n          'displayName',\\n          accountInstitution\\n        )\\n      )\\n    ) AS trxInfo\\n  FROM\\n    WalletTrxOrder\\n    LEFT JOIN \\\"WalletPaymentsCommerce.Internal.WalletOrderTransaction\\\" wot ON WalletTrxOrder.referenceId = wot.subject\\n  WHERE\\n    currencyCode IS NOT NULL\\n    OR totalAmount IS NOT NULL\\n    OR accountInstitution IS NOT NULL\\n    OR accountLastFourDigits IS NOT NULL\\n  GROUP BY\\n    WalletTrxOrder.subject\\n),\\nWalletPymJson AS (\\n  SELECT\\n    WalletPymCol.subject,\\n    JSON_OBJECT(\\n      'totalAmount',\\n      totalAmount,\\n      'totalIsoCurrencyCode',\\n      currencyCode,\\n      'transactions',\\n      json_extract(trxInfo, '$')\\n    ) AS orderPayment\\n  FROM\\n    WalletPymCol\\n    LEFT JOIN WalletTrxCol ON WalletPymCol.subject = WalletTrxCol.subject\\n),\\nWalletShipmentOrder AS (\\n  SELECT\\n    subject,\\n    orderNumber,\\n    referenceId\\n  FROM\\n    \\\"WalletPaymentsCommerce.Internal.WalletOrder\\\"\\n  WHERE\\n    referenceEntityIdType = 'shipmentFullFillmentIdentifier'\\n),\\nWalletDedupeShipment AS (\\n  SELECT DISTINCT\\n    WalletShipmentOrder.subject AS identifierOrder,\\n    WalletShipmentOrder.orderNumber,\\n    wosfi.*\\n  FROM\\n    WalletShipmentOrder\\n    LEFT JOIN \\\"WalletPaymentsCommerce.Internal.WalletOrderShipmentFullFillmentInfo\\\" wosfi ON WalletShipmentOrder.referenceId = wosfi.subject\\n),\\nWalletShipmentOrderByEmail AS (\\n  SELECT\\n    WalletDedupeShipment.subject AS orderIdentifier,\\n    *,\\n    ROW_NUMBER() OVER (\\n      PARTITION BY orderNumber,\\n      trackingNumber\\n      ORDER BY\\n        fullfillmentUpdateDate DESC,\\n        emailSentDate DESC\\n    ) AS rn\\n  FROM\\n    WalletDedupeShipment\\n    LEFT JOIN \\\"WalletPaymentsCommerce.Internal.WalletOrderEmail\\\" we ON WalletDedupeShipment.emailIdentifier = we.subject\\n),\\nWalletShipmentWithFilledValues AS (\\n  SELECT\\n    s1.*,\\n    COALESCE(s1.carrierName,\\n      (SELECT s2.carrierName FROM WalletShipmentOrderByEmail s2\\n       WHERE s2.orderNumber = s1.orderNumber AND s2.carrierName IS NOT NULL\\n       ORDER BY s2.fullfillmentUpdateDate DESC, s2.emailSentDate DESC LIMIT 1)) AS filled_carrierName,\\n    COALESCE(s1.trackingNumber,\\n      (SELECT s2.trackingNumber FROM WalletShipmentOrderByEmail s2\\n       WHERE s2.orderNumber = s1.orderNumber AND s2.trackingNumber IS NOT NULL\\n       ORDER BY s2.fullfillmentUpdateDate DESC, s2.emailSentDate DESC LIMIT 1)) AS filled_trackingNumber,\\n    COALESCE(s1.shippingMethod,\\n      (SELECT s2.shippingMethod FROM WalletShipmentOrderByEmail s2\\n       WHERE s2.orderNumber = s1.orderNumber AND s2.shippingMethod IS NOT NULL\\n       ORDER BY s2.fullfillmentUpdateDate DESC, s2.emailSentDate DESC LIMIT 1)) AS filled_shippingMethod,\\n    COALESCE(s1.shippingStatus,\\n      (SELECT s2.shippingStatus FROM WalletShipmentOrderByEmail s2\\n       WHERE s2.orderNumber = s1.orderNumber AND s2.shippingStatus IS NOT NULL\\n       ORDER BY s2.fullfillmentUpdateDate DESC, s2.emailSentDate DESC LIMIT 1)) AS filled_shippingStatus,\\n    COALESCE(s1.shippingDate,\\n      (SELECT s2.shippingDate FROM WalletShipmentOrderByEmail s2\\n       WHERE s2.orderNumber = s1.orderNumber AND s2.shippingDate IS NOT NULL\\n       ORDER BY s2.fullfillmentUpdateDate DESC, s2.emailSentDate DESC LIMIT 1)) AS filled_shippingDate,\\n    COALESCE(s1.estimatedDeliveryStartDate,\\n      (SELECT s2.estimatedDeliveryStartDate FROM WalletShipmentOrderByEmail s2\\n       WHERE s2.orderNumber = s1.orderNumber AND s2.estimatedDeliveryStartDate IS NOT NULL\\n       ORDER BY s2.fullfillmentUpdateDate DESC, s2.emailSentDate DESC LIMIT 1)) AS filled_estimatedDeliveryStartDate,\\n    COALESCE(s1.estimatedDeliveryStartTime,\\n      (SELECT s2.estimatedDeliveryStartTime FROM WalletShipmentOrderByEmail s2\\n       WHERE s2.orderNumber = s1.orderNumber AND s2.estimatedDeliveryStartTime IS NOT NULL\\n       ORDER BY s2.fullfillmentUpdateDate DESC, s2.emailSentDate DESC LIMIT 1)) AS filled_estimatedDeliveryStartTime,\\n    COALESCE(s1.estimatedDeliveryEndDate,\\n      (SELECT s2.estimatedDeliveryEndDate FROM WalletShipmentOrderByEmail s2\\n       WHERE s2.orderNumber = s1.orderNumber AND s2.estimatedDeliveryEndDate IS NOT NULL\\n       ORDER BY s2.fullfillmentUpdateDate DESC, s2.emailSentDate DESC LIMIT 1)) AS filled_estimatedDeliveryEndDate,\\n    COALESCE(s1.estimatedDeliveryEndTime,\\n      (SELECT s2.estimatedDeliveryEndTime FROM WalletShipmentOrderByEmail s2\\n       WHERE s2.orderNumber = s1.orderNumber AND s2.estimatedDeliveryEndTime IS NOT NULL\\n       ORDER BY s2.fullfillmentUpdateDate DESC, s2.emailSentDate DESC LIMIT 1)) AS filled_estimatedDeliveryEndTime,\\n    COALESCE(s1.deliveryDate,\\n      (SELECT s2.deliveryDate FROM WalletShipmentOrderByEmail s2\\n       WHERE s2.orderNumber = s1.orderNumber AND s2.deliveryDate IS NOT NULL\\n       ORDER BY s2.fullfillmentUpdateDate DESC, s2.emailSentDate DESC LIMIT 1)) AS filled_deliveryDate,\\n    COALESCE(s1.deliveryTime,\\n      (SELECT s2.deliveryTime FROM WalletShipmentOrderByEmail s2\\n       WHERE s2.orderNumber = s1.orderNumber AND s2.deliveryTime IS NOT NULL\\n       ORDER BY s2.fullfillmentUpdateDate DESC, s2.emailSentDate DESC LIMIT 1)) AS filled_deliveryTime\\n  FROM WalletShipmentOrderByEmail s1\\n),\\nWalletShippingRecepientOrderJson AS (\\n  SELECT\\n    WalletShipmentOrderByEmail.subject,\\n    JSON_OBJECT(\\n      'fullName',\\n      name,\\n      'phoneNumber',\\n      phone,\\n      'emailAddress',\\n      email,\\n      'address',\\n      JSON_OBJECT(\\n        'street',\\n        street,\\n        'city',\\n        city,\\n        'state',\\n        state,\\n        'country',\\n        country,\\n        'postalCode',\\n        postal\\n      )\\n    ) AS shippingRecepientJson\\n  FROM\\n    WalletShipmentOrderByEmail\\n    LEFT JOIN \\\"WalletPaymentsCommerce.Internal.WalletOrderPerson\\\" wop ON wop.subject = WalletShipmentOrderByEmail.personIdentifier\\n),\\nWalletShipmentJson AS (\\n  SELECT\\n    WalletShipmentWithFilledValues.identifierOrder AS identifierOrder,\\n    WalletShipmentWithFilledValues.orderNumber,\\n    JSON_GROUP_ARRAY(\\n      JSON_OBJECT(\\n        'carrierName',\\n        filled_carrierName,\\n        'trackingNumber',\\n        filled_trackingNumber,\\n        'shippingMethod',\\n        filled_shippingMethod,\\n        'status',\\n        CAST(filled_shippingStatus AS INTEGER),\\n        'shippingDate',\\n        filled_shippingDate,\\n        'estimatedDeliveryStartDate',\\n        filled_estimatedDeliveryStartDate,\\n        'estimatedDeliveryStartTime',\\n        filled_estimatedDeliveryStartTime,\\n        'estimatedDeliveryEndDate',\\n        filled_estimatedDeliveryEndDate,\\n        'estimatedDeliveryEndTime',\\n        filled_estimatedDeliveryEndTime,\\n        'deliveryDate',\\n        filled_deliveryDate,\\n        'deliveryTime',\\n        filled_deliveryTime,\\n        'fulfillmentUpdateDate',\\n        (CASE\\n            WHEN WalletShipmentWithFilledValues.emailSentDate IS NULL THEN\\n                CAST(WalletShipmentWithFilledValues.fullfillmentUpdateDate AS REAL)\\n            WHEN WalletShipmentWithFilledValues.fullfillmentUpdateDate IS NULL THEN\\n                CAST(WalletShipmentWithFilledValues.emailSentDate AS REAL)\\n            WHEN CAST(WalletShipmentWithFilledValues.emailSentDate AS REAL) > CAST(WalletShipmentWithFilledValues.fullfillmentUpdateDate AS REAL) THEN\\n                CAST(WalletShipmentWithFilledValues.emailSentDate AS REAL)\\n            ELSE\\n                CAST(WalletShipmentWithFilledValues.fullfillmentUpdateDate AS REAL)\\n         END),\\n        'shippingRecipient',\\n        json_extract(\\n          WalletShippingRecepientOrderJson.shippingRecepientJson,\\n          '$'\\n        )\\n      )\\n    ) AS shipmentJson\\n  FROM\\n    WalletShipmentWithFilledValues\\n    LEFT JOIN WalletShippingRecepientOrderJson ON WalletShippingRecepientOrderJson.subject = WalletShipmentWithFilledValues.subject\\n  where\\n    rn = 1\\n  GROUP BY\\n    WalletShipmentWithFilledValues.identifierOrder\\n),\\nWalletEmailShipping AS (\\n  SELECT\\n    shippingStatus,\\n    trackingNumber,\\n    carrierName,\\n    we.subject\\n  FROM\\n    \\\"WalletPaymentsCommerce.Internal.WalletOrderShipmentFullFillmentInfo\\\" wosfi\\n    LEFT JOIN \\\"WalletPaymentsCommerce.Internal.WalletOrderEmail\\\" we ON wosfi.emailIdentifier = we.subject\\n),\\nWalletEmailOrderJson AS (\\n  SELECT\\n    WalletEmailOrder.subject,\\n    orderNumber,\\n    JSON_GROUP_ARRAY(\\n      JSON_OBJECT(\\n        'emailType',\\n        CAST(emailType AS INTEGER),\\n        'emailMetadata',\\n        JSON_OBJECT(\\n          'messageID',\\n          messageID,\\n          'senderDomain',\\n          senderDomain,\\n          'replyToEmailAddress',\\n          emailReplyTo,\\n          'subject',\\n          emailSubject,\\n          'toEmailAddress',\\n          emailTo,\\n          'fromEmailAddress',\\n          emailFrom,\\n          'toDisplayName',\\n          emailToDisplay,\\n          'fromDisplayName',\\n          emailFromDisplay,\\n          'replyToDisplayName',\\n          emailReplyToDisplay,\\n          'dateSent',\\n          CAST(emailSentDate AS REAL)\\n        ),\\n        'orderDetails',\\n        JSON_OBJECT(\\n          'orderNumber',\\n          origOrderNumber,\\n          'merchant',\\n            JSON_OBJECT('displayName', origMerchantName),\\n          'shippingDetails',\\n          JSON_OBJECT(\\n            'status',\\n            CAST(shippingStatus AS INTEGER),\\n            'trackingNumber',\\n            origTrackingNumber,\\n            'carrierName',\\n            carrierName\\n          )\\n        ),\\n        'spotlightUniqueIdentifier',\\n        spotlightUniqueIdentifier,\\n        'spotlightDomainIdentifier',\\n        spotlightDomainIdentifier\\n      )\\n    ) AS emailArr\\n  FROM\\n    WalletEmailOrder\\n    LEFT JOIN \\\"WalletPaymentsCommerce.Internal.WalletOrderEmail\\\" we ON WalletEmailOrder.referenceId = we.subject\\n    LEFT JOIN \\\"WalletEmailShipping\\\" wes ON walletEmailOrder.referenceId = wes.subject\\n  GROUP BY\\n    WalletEmailOrder.subject\\n  ORDER BY emailSentDate DESC\\n)\\nSELECT DISTINCT\\n  WalletOrderFields.subject,\\n  'md:' || WalletOrderFields.subject AS identifier,\\n  WalletOrderFields.orderNumber AS orderNumber,\\n  JSON_OBJECT(\\n    'orderNumber',\\n    WalletOrderMerchant.orderNumber,\\n    'orderDate',\\n    WalletOrderFields.orderDate,\\n    'orderIdentifier',\\n    WalletOrderFields.orderIdentifier,\\n    'orderTypeIdentifier',\\n    WalletOrderFields.orderTypeIdentifier,\\n    'trackedOrderIdentifier',\\n    WalletOrderFields.trackedOrderIdentifier,\\n    'orderUpdateDate',\\n    CAST(WalletOrderFields.orderUpdateDate AS REAL),\\n    'orderEmails',\\n    json_extract(emailArr, '$'),\\n    'payment',\\n    json_extract(WalletPymJson.orderPayment, '$'),\\n    'shippingFulfillments',\\n    json_extract(WalletShipmentJson.shipmentJson, '$'),\\n    'merchant',\\n    json_extract(WalletOrderMerchant.merchantJson, '$'),\\n    'customer',\\n    json_extract(WalletPersonOrderJson.personJson, '$'),\\n    'orderStatus',\\n    CAST(WalletOrderStatusFinal.orderStatus AS INTEGER),\\n    'orderStatusUpdateDate',\\n    CAST(WalletOrderStatusFinal.orderStatusUpdateDate AS REAL),\\n    'earliestEmailDateSent',\\n    CAST(WalletEmailEarliestDateFinal.earliestEmailDateSent AS REAL)\\n  ) AS orderJson\\nFROM\\n  WalletOrderFields\\n  LEFT JOIN WalletEmailOrderJson ON WalletOrderFields.subject = WalletEmailOrderJson.subject\\n  LEFT JOIN WalletPymJson ON WalletOrderFields.subject = WalletPymJson.subject\\n  LEFT JOIN WalletShipmentJson ON WalletOrderFields.subject = WalletShipmentJson.identifierOrder\\n  LEFT JOIN WalletOrderMerchant ON WalletOrderFields.subject = WalletOrderMerchant.subject\\n  LEFT JOIN WalletPersonOrderJson ON WalletOrderFields.subject = WalletPersonOrderJson.subject\\n  LEFT JOIN WalletOrderStatusFinal ON WalletOrderFields.subject = WalletOrderStatusFinal.subject\\n  LEFT JOIN WalletEmailEarliestDateFinal ON WalletOrderFields.subject = WalletEmailEarliestDateFinal.subject\\n\\n\"}, \"target\": {\"database\": \"WalletPaymentsCommerce.Internal\", \"name\": \"WalletOrderExtractedView\", \"target\": \"WalletPaymentsCommerce.Internal.WalletOrderExtractedView\", \"type\": \"view\"}, \"type\": \"sqlConnection\", \"update\": {\"knowledgeGraphListeners\": [{\"filters\": [{\"entityType\": \"SB10\"}], \"fullRebuildOnChange\": true, \"rebuildView\": true, \"requiredSource\": false, \"schedule\": \"live\", \"stores\": [\"stableGraph\"]}], \"viewListeners\": [{\"diffType\": \"updatedObject\", \"filterQuery\": \"SELECT subject FROM \\\"WalletPaymentsCommerce.Internal.WalletOrderFields\\\"\", \"fullRebuildOnChange\": true, \"name\": \"WalletOrderFields\", \"rebuildView\": true, \"schedule\": \"live\"}, {\"diffType\": \"updatedObject\", \"filterQuery\": \"SELECT subject FROM \\\"WalletPaymentsCommerce.Internal.WalletTrackedOrderFields\\\"\", \"fullRebuildOnChange\": true, \"name\": \"WalletTrackedOrderFields\", \"rebuildView\": true, \"schedule\": \"live\"}, {\"diffType\": \"updatedObject\", \"filterQuery\": \"SELECT subject FROM \\\"WalletPaymentsCommerce.Internal.WalletOrder\\\"\", \"fullRebuildOnChange\": true, \"name\": \"WalletOrder\", \"rebuildView\": true, \"schedule\": \"live\"}, {\"diffType\": \"updatedObject\", \"filterQuery\": \"SELECT subject FROM \\\"WalletPaymentsCommerce.Internal.WalletOrderEmail\\\"\", \"fullRebuildOnChange\": true, \"name\": \"WalletOrderEmail\", \"rebuildView\": true, \"schedule\": \"live\"}, {\"diffType\": \"updatedObject\", \"filterQuery\": \"SELECT subject FROM \\\"WalletPaymentsCommerce.Internal.WalletOrderPayment\\\"\", \"fullRebuildOnChange\": true, \"name\": \"WalletOrderPayment\", \"rebuildView\": true, \"schedule\": \"live\"}, {\"diffType\": \"updatedObject\", \"filterQuery\": \"SELECT subject FROM \\\"WalletPaymentsCommerce.Internal.WalletOrderTransaction\\\"\", \"fullRebuildOnChange\": true, \"name\": \"WalletOrderTransaction\", \"rebuildView\": true, \"schedule\": \"live\"}, {\"diffType\": \"updatedObject\", \"filterQuery\": \"SELECT subject FROM \\\"WalletPaymentsCommerce.Internal.WalletOrderShipmentFullFillmentInfo\\\"\", \"fullRebuildOnChange\": true, \"name\": \"WalletOrderShipmentFullFillmentInfo\", \"rebuildView\": true, \"schedule\": \"live\"}, {\"diffType\": \"updatedObject\", \"filterQuery\": \"SELECT subject FROM \\\"WalletPaymentsCommerce.Internal.WalletOrderPerson\\\"\", \"fullRebuildOnChange\": true, \"name\": \"WalletOrderPerson\", \"rebuildView\": true, \"requiredSource\": true, \"schedule\": \"live\"}]}, \"uuid\": \"456D4F37-51DB-4E59-B38A-C155C57FF5CB\", \"version\": \"ae9fe8cf-ee2f-4017-9264-dcc71bcdbaea\", \"writeToStream\": true}"
- "{\"configHash\": \"a86bdc0ee08006c69d6672ef7a0bf8e430e80dbe8497637aef8e09e4b998db45\", \"dependencies\": [], \"dependents\": [\"WalletOrderExtractedView\"], \"deployment\": [\"production\"], \"featureFlag\": \"OrionSQL\", \"legacyName\": \"WalletOrder\", \"name\": \"WalletOrder\", \"platforms\": {\"iOS\": \"18.0\"}, \"sql\": {\"update\": \"WITH WalletOrderSubgraph AS (\\n  SELECT\\n    g1.subject,\\n    g1.predicate,\\n    g1.object,\\n    g1.relationshipPredicate,\\n    g1.relationshipId\\n  FROM\\n    \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\" g1\\n    JOIN \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\" g2 ON g1.subject = g2.subject\\n  WHERE\\n    g2.predicate = 'PS1'\\n    AND g2.object = 'nm_walletOrder'\\n    AND $SUBJECT_COND(g1.subject)\\n), WalletOrderSubjects AS (\\n  SELECT DISTINCT subject FROM WalletOrderSubgraph\\n), OrganizationSubgraph AS (\\n  SELECT\\n    g1.subject as subject,\\n    g1.predicate,\\n    g1.object,\\n    g1.relationshipPredicate,\\n    g1.relationshipId\\n  FROM\\n    \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\" g1\\n    JOIN \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\" g2 ON g1.subject = g2.subject\\n  WHERE\\n    g2.predicate = 'PS1'\\n    AND g2.object = 'SB10'\\n), WalletOrderNumber AS (\\n  SELECT subject, object as orderNumber\\n  FROM WalletOrderSubgraph\\n  WHERE predicate = 'nm_orderNumber'\\n), WalletOrderPaymentIdentifier AS (\\n  SELECT subject, object as paymentIdentifier\\n  FROM WalletOrderSubgraph\\n  WHERE relationshipPredicate = 'nm_paymentIdentifier'\\n), WalletOrderTransactionIdentifier AS (\\n  SELECT subject, object as transactionIdentifier\\n  FROM WalletOrderSubgraph\\n  WHERE relationshipPredicate = 'nm_transactionIdentifier'\\n), WalletOrderEmailIdentifier AS (\\n  SELECT subject, object as emailIdentifier\\n  FROM WalletOrderSubgraph\\n  WHERE relationshipPredicate = 'nm_emailIdentifier'\\n), WalletOrderShipmentFullFillmentIdentifier AS (\\n  SELECT subject, object as shipmentFullFillmentIdentifier\\n  FROM WalletOrderSubgraph\\n  WHERE relationshipPredicate = 'nm_shipmentFullFillmentIdentifier'\\n), CustomerIdentifier AS (\\n  SELECT subject, object as customerIdentifier\\n  FROM WalletOrderSubgraph\\n  WHERE relationshipPredicate = 'nm_personIdentifier'\\n), MerchantIdentifier AS (\\n  SELECT subject, object as merchantIdentifier\\n  FROM WalletOrderSubgraph\\n  WHERE relationshipPredicate = 'nm_organizationIdentifier'\\n), WalletOrdersRepeated AS (\\n  SELECT\\n    s.subject,\\n    WalletOrderNumber.orderNumber,\\n    WalletOrderPaymentIdentifier.paymentIdentifier,\\n    WalletOrderTransactionIdentifier.transactionIdentifier,\\n    WalletOrderEmailIdentifier.emailIdentifier,\\n    WalletOrderShipmentFullFillmentIdentifier.shipmentFullFillmentIdentifier,\\n    CustomerIdentifier.customerIdentifier,\\n    MerchantIdentifier.merchantIdentifier\\n  FROM\\n    WalletOrderSubjects AS s\\n    LEFT JOIN WalletOrderNumber ON s.subject = WalletOrderNumber.subject\\n    LEFT JOIN WalletOrderPaymentIdentifier ON s.subject = WalletOrderPaymentIdentifier.subject\\n    LEFT JOIN WalletOrderTransactionIdentifier ON s.subject = WalletOrderTransactionIdentifier.subject\\n    LEFT JOIN WalletOrderEmailIdentifier ON s.subject = WalletOrderEmailIdentifier.subject\\n    LEFT JOIN WalletOrderShipmentFullFillmentIdentifier ON s.subject = WalletOrderShipmentFullFillmentIdentifier.subject\\n    LEFT JOIN CustomerIdentifier ON s.subject = CustomerIdentifier.subject\\n    LEFT JOIN MerchantIdentifier ON s.subject = MerchantIdentifier.subject\\n),WalletOrdersTransposed AS (\\n  SELECT\\n    subject,\\n    orderNumber,\\n    'paymentIdentifier' AS referenceEntityIdType,\\n    entityIdentifier(paymentIdentifier) AS referenceId\\n  FROM\\n    WalletOrdersRepeated\\n  WHERE\\n    paymentIdentifier IS NOT NULL\\n  UNION ALL\\n  SELECT\\n    subject,\\n    orderNumber,\\n    'transactionIdentifier' AS referenceEntityIdType,\\n    entityIdentifier(transactionIdentifier) AS referenceId\\n  FROM\\n    WalletOrdersRepeated\\n  WHERE\\n    transactionIdentifier IS NOT NULL\\n  UNION ALL\\n  SELECT\\n    subject,\\n    orderNumber,\\n    'emailIdentifier' AS referenceEntityIdType,\\n    entityIdentifier(emailIdentifier) AS referenceId\\n  FROM\\n    WalletOrdersRepeated\\n  WHERE\\n    emailIdentifier IS NOT NULL\\n  UNION ALL\\n  SELECT\\n    subject,\\n    orderNumber,\\n    'shipmentFullFillmentIdentifier' AS referenceEntityIdType,\\n    entityIdentifier(shipmentFullFillmentIdentifier) AS referenceId\\n  FROM\\n    WalletOrdersRepeated\\n  WHERE\\n    shipmentFullFillmentIdentifier IS NOT NULL\\n  UNION ALL\\n  SELECT\\n    subject,\\n    orderNumber,\\n    'customerIdentifier' AS referenceEntityIdType,\\n    entityIdentifier(customerIdentifier) AS referenceId\\n  FROM\\n    WalletOrdersRepeated\\n  WHERE\\n    customerIdentifier IS NOT NULL\\n  UNION ALL\\n  SELECT\\n    subject,\\n    orderNumber,\\n    'merchantIdentifier' AS referenceEntityIdType,\\n    entityIdentifier(merchantIdentifier) AS referenceId\\n  FROM\\n    WalletOrdersRepeated\\n  WHERE\\n    merchantIdentifier IS NOT NULL\\n)\\nSELECT DISTINCT\\n  subject,\\n  'md:' || subject AS identifier,\\n  orderNumber,\\n  referenceEntityIdType,\\n  referenceId\\nFROM\\n  WalletOrdersTransposed\\n\"}, \"target\": {\"database\": \"WalletPaymentsCommerce.Internal\", \"name\": \"WalletOrder\", \"target\": \"WalletPaymentsCommerce.Internal.WalletOrder\", \"type\": \"view\"}, \"type\": \"sqlConnection\", \"update\": {\"knowledgeGraphListeners\": [{\"filters\": [{\"entityType\": \"nm_walletOrder\"}], \"requiredSource\": false, \"schedule\": \"live\", \"source\": \"WalletClassicOrder\", \"stores\": [\"stableGraph\"]}, {\"filters\": [{\"entityType\": \"nm_walletOrder\"}], \"requiredSource\": false, \"schedule\": \"live\", \"source\": \"WalletEmailOrder\", \"stores\": [\"stableGraph\"]}, {\"filters\": [{\"entityType\": \"nm_walletOrder\"}], \"requiredSource\": false, \"schedule\": \"live\", \"source\": \"WalletTransactionOrder\", \"stores\": [\"stableGraph\"]}, {\"filters\": [{\"entityType\": \"nm_walletOrder\"}], \"requiredSource\": false, \"schedule\": \"live\", \"source\": \"WalletTrackedOrder\", \"stores\": [\"stableGraph\"]}]}, \"uuid\": \"1C132518-5A84-4EA0-B282-5CD8F73E41E0\", \"version\": \"799bdcc8-02ff-4634-9e3a-c211268a2503\"}"
- "{\"configHash\": \"b07c4a57f59def5ca516cff47c623bf38958c76cb903b2fcb03b34c059d7bf61\", \"dependencies\": [], \"dependents\": [], \"deployment\": [\"production\"], \"featureFlag\": \"OrionSQL\", \"legacyName\": \"location\", \"name\": \"Location\", \"platforms\": {\"iOS\": \"18.0\", \"macOS\": \"15.0\"}, \"sql\": {\"update\": \"WITH LocationSubgraph AS (\\n  SELECT\\n    g1.subject AS subject,\\n    g1.predicate,\\n    g1.object,\\n    g1.relationshipPredicate,\\n    g1.relationshipId\\n  FROM\\n    \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\" g1\\n    JOIN \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\" g2 ON g1.subject = g2.subject\\n  WHERE\\n    g2.predicate = 'PS1'\\n    AND g2.object = 'SB152'\\n    AND $SUBJECT_COND(g1.subject)\\n), LocationSubjects AS (\\n  SELECT DISTINCT subject FROM LocationSubgraph\\n), LocationName AS (\\n  SELECT subject, object as name\\n  FROM LocationSubgraph\\n  WHERE predicate = 'PS33'\\n), LocationAddressString AS (\\n  SELECT subject, object as addressString\\n  FROM LocationSubgraph\\n  WHERE predicate = 'nm_addressString'\\n), LocationLatitude AS (\\n  SELECT l1.subject, l2.object as latitude\\n  FROM LocationSubgraph l1 JOIN LocationSubgraph l2 ON l1.relationshipId = l2.relationshipId\\n  WHERE l1.predicate = 'PS573' AND l1.relationshipPredicate = 'PS1' AND l1.object = 'CS29'\\n    AND l2.relationshipPredicate = 'PS571'\\n), LocationLongitude AS (\\n  SELECT l1.subject, l2.object as longitude\\n  FROM LocationSubgraph l1 JOIN LocationSubgraph l2 ON l1.relationshipId = l2.relationshipId\\n  WHERE l1.predicate = 'PS573' AND l1.relationshipPredicate = 'PS1' AND l1.object = 'CS29'\\n    AND l2.relationshipPredicate = 'PS572' LIMIT 1\\n), LocationAddress AS (\\n  SELECT l1.subject, json_group_object(\\n    CASE WHEN l2.relationshipPredicate = 'PS454' THEN 'isoCountryCode' WHEN l2.relationshipPredicate = 'PS450' THEN 'country' WHEN l2.relationshipPredicate = 'PS315' THEN 'postalCode' WHEN l2.relationshipPredicate = 'PS568' THEN 'administrativeArea' WHEN l2.relationshipPredicate = 'PS569' THEN 'locality' WHEN l2.relationshipPredicate = 'PS570' THEN 'thoroughfare' WHEN l2.relationshipPredicate = 'PS316' THEN 'streetName' WHEN l2.relationshipPredicate = 'PS453' THEN 'city' END,\\n    l2.object\\n  ) as address\\n  FROM LocationSubgraph l1 JOIN LocationSubgraph l2  ON l1.relationshipId = l2.relationshipId\\n  WHERE l1.predicate = 'PS317' and l1.relationshipPredicate = 'PS1' and l1.object = 'CS97'\\n  AND l2.relationshipPredicate IN ('PS315', 'PS450', 'PS568', 'PS569', 'PS570', 'PS454', 'PS316', 'PS453')\\n  GROUP BY l1.subject\\n),LocationsRepeated AS (\\n  SELECT\\n    s.subject,\\n    LocationName.name,\\n    LocationAddressString.addressString,\\n    LocationLatitude.latitude,\\n    LocationLongitude.longitude,\\n    LocationAddress.address\\n  FROM\\n    LocationSubjects AS s\\n    LEFT JOIN LocationName ON s.subject = LocationName.subject\\n    LEFT JOIN LocationAddressString ON s.subject = LocationAddressString.subject\\n    LEFT JOIN LocationLatitude ON s.subject = LocationLatitude.subject\\n    LEFT JOIN LocationLongitude ON s.subject = LocationLongitude.subject\\n    LEFT JOIN LocationAddress ON s.subject = LocationAddress.subject\\n  ORDER BY\\n    s.subject\\n), LocationsRanked AS (\\n    SELECT\\n      *,\\n      ROW_NUMBER() OVER (PARTITION BY subject) AS rn\\n    FROM\\n      LocationsRepeated\\n)\\n\\nSELECT\\n  subject,\\n  'md:' || subject as identifier,\\n  name,\\n  addressString,\\n  latitude,\\n  longitude,\\n  address\\nFROM\\n  LocationsRanked\\nWHERE\\n  rn = 1\\n\"}, \"target\": {\"database\": \"IntelligencePlatform.Entity\", \"name\": \"Location\", \"target\": \"IntelligencePlatform.Entity.Location\", \"type\": \"view\"}, \"type\": \"sqlConnection\", \"update\": {\"knowledgeGraphListeners\": [{\"filters\": [{\"entityType\": \"SB152\"}], \"schedule\": \"live\", \"stores\": [\"stableGraph\"]}]}, \"uuid\": \"C9B0B192-3E33-43C4-8C72-4CBF6D5E7525\", \"version\": \"288c24b5-006a-4073-b667-2dbd4672cdf8\"}"
- "{\"configHash\": \"da088a9112dcce748657b4353fad46d4fc5bcbf3c819a8b6611262efb5f3e894\", \"dependencies\": [], \"dependents\": [], \"deployment\": [\"production\"], \"featureFlag\": \"OrionSQL\", \"legacyName\": \"person\", \"name\": \"Person\", \"platforms\": {\"iOS\": \"18.0\", \"macOS\": \"15.0\"}, \"sql\": {\"update\": \"WITH PersonSubgraph AS (\\n  SELECT\\n    g1.subject,\\n    g1.predicate,\\n    g1.object,\\n    g1.relationshipPredicate,\\n    g1.relationshipId\\n  FROM\\n    \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\" g1\\n    JOIN \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\" g2 ON g1.subject = g2.subject\\n  WHERE\\n    g2.predicate = 'PS1'\\n    AND g2.object = 'SB104'\\n    AND $SUBJECT_COND(g1.subject)\\n), PersonSubjects AS (\\n  SELECT DISTINCT subject as subject FROM PersonSubgraph\\n), PersonIdentifiers AS (\\n  SELECT p1.subject, p1.object AS source, p2.object AS identifier\\n  FROM PersonSubgraph p1\\n  JOIN PersonSubgraph p2 ON p1.relationshipId = p2.relationshipId\\n  WHERE p1.predicate = 'PS72' AND p1.relationshipPredicate = 'PS396' AND p2.predicate = 'PS72' AND p2.relationshipPredicate = 'PS69'\\n),OrganizationSubgraph AS (\\n  SELECT\\n    g1.subject,\\n    g1.predicate,\\n    g1.object,\\n    g1.relationshipPredicate,\\n    g1.relationshipId\\n  FROM\\n    \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\" g1\\n    JOIN \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\" g2 ON g1.subject = g2.subject\\n  WHERE\\n    g2.predicate = 'PS1'\\n    AND g2.object = 'SB10'\\n), PersonName AS (\\n  SELECT subject, object as fullName\\n  FROM PersonSubgraph\\n  WHERE predicate = 'PS33'\\n), PersonFirstName AS (\\n  SELECT subject, json_group_array(object) as firstNames\\n  FROM PersonSubgraph\\n  WHERE predicate = 'PS312'\\n  GROUP BY subject\\n), PersonMiddleName AS (\\n  SELECT subject, json_group_array(object) as middleNames\\n  FROM PersonSubgraph\\n  WHERE predicate = 'PS546'\\n  GROUP BY subject\\n), PersonFamilyName AS (\\n  SELECT subject, json_group_array(object) as familyNames\\n  FROM PersonSubgraph\\n  WHERE predicate = 'PS441'\\n  GROUP BY subject\\n), PersonPhoneticName AS (\\n  SELECT subject, json_group_object(\\n    CASE WHEN predicate = 'nm_phoneticName' THEN 'name' WHEN predicate = 'nm_phoneticFirstName' THEN 'firstName' WHEN predicate = 'nm_phoneticMiddleName' THEN 'middleName' WHEN predicate = 'nm_phoneticFamilyName' THEN 'familyName' END,\\n    object\\n  ) as phoneticName\\n  FROM PersonSubgraph\\n  WHERE predicate IN ('nm_phoneticName', 'nm_phoneticFirstName', 'nm_phoneticMiddleName', 'nm_phoneticFamilyName')\\n  GROUP BY subject\\n), PersonAliases AS (\\n  SELECT subject, json_group_array(object) as aliases\\n  FROM PersonSubgraph\\n  WHERE predicate = 'nm_entityAliasRelationship' AND relationshipPredicate = 'PS89'\\n  GROUP BY subject\\n), PersonDOB AS (\\n  SELECT subject, object as dateOfBirth\\n  FROM PersonSubgraph\\n  WHERE predicate = 'nm_imputedBirthday'\\n), PersonCurrentUser AS (\\n  SELECT p1.subject, CASE WHEN p2.object = 'true' THEN 1 ELSE 0 END as isCurrentUser\\n  FROM PersonSubjects p1 LEFT JOIN\\n  (SELECT * FROM PersonSubgraph WHERE predicate = 'nm_isCurrentUser' ) p2 ON p1.subject = p2.subject\\n), PersonPrevFamilyName AS (\\n  SELECT subject, object as previousFamilyName\\n  FROM PersonSubgraph\\n  WHERE predicate = 'PS574'\\n), PersonVID AS (\\n  SELECT subject, json_group_array(object) as visualIdentifier\\n  FROM PersonSubgraph\\n  WHERE predicate = 'nm_hasVisualIdentifier' and relationshipPredicate = 'nm_visualIdentifier'\\n  GROUP BY subject\\n), PersonCID AS (\\n  SELECT subject, json_group_array(identifier) as contactIdentifier\\n  FROM PersonIdentifiers\\n  WHERE source = 'CNContact'\\n  GROUP BY subject\\n), PersonEmployer AS (\\n  SELECT p.subject, json_group_object(\\n    CASE WHEN o.predicate = 'PS33' THEN 'name' WHEN o.predicate = 'nm_phoneticName' THEN 'phoneticName' WHEN o.predicate = 'PS548' THEN 'department' WHEN o.predicate = 'nm_teamIdentifier' THEN 'teamIdentifier' END,\\n    o.object\\n  ) as employer\\n  FROM PersonSubgraph p JOIN OrganizationSubgraph o ON p.object = o.subject\\n  WHERE p.predicate = 'PS500' AND p.relationshipPredicate = 'PS45'\\n  AND o.predicate IN ('PS33', 'nm_phoneticName', 'PS548', 'nm_teamIdentifier')\\n  GROUP BY p.subject\\n), PersonURL AS (\\n  SELECT subject, json_group_array(object) as url\\n  FROM PersonSubgraph\\n  WHERE predicate = 'PS296'\\n  GROUP BY subject\\n), PersonRelationship AS (\\n  SELECT subject, json_group_array(json(rel)) as personRelationship\\n  FROM (\\n    SELECT subject, relationshipId, json_group_object(\\n      CASE WHEN relationshipPredicate = 'nm_relationshipLabel' THEN 'label' WHEN relationshipPredicate = 'nm_personIdentifier' THEN 'target' END,\\n      object\\n    ) as rel\\n    FROM PersonSubgraph\\n    WHERE predicate = 'PS598' and relationshipPredicate IN ('nm_relationshipLabel', 'nm_personIdentifier')\\n    GROUP BY subject, relationshipId\\n  )\\n  GROUP BY subject\\n), PersonLocation AS (\\n  SELECT subject, json_group_array(json(rel)) as location\\n  FROM (\\n    SELECT subject, json_group_object(\\n      CASE WHEN relationshipPredicate = 'PS733' THEN 'label' WHEN relationshipPredicate = 'PS107' THEN 'targetIdentifier' END,\\n      object\\n    ) as rel\\n    FROM PersonSubgraph\\n    WHERE predicate = 'PS225' and relationshipPredicate IN ('PS733', 'PS107')\\n    GROUP BY subject, relationshipId\\n  )\\n  GROUP BY subject\\n), PersonEmail AS (\\n  SELECT subject, json_group_array(json(email)) as emailAddresses\\n  FROM (\\n    SELECT p1.subject, json_object('label', p1.object, 'emailAddress', p2.object) as email\\n    FROM PersonSubgraph p1 JOIN PersonSubgraph p2 ON p1.relationshipId = p2.relationshipId\\n    WHERE p1.predicate = 'PS520' AND p1.relationshipPredicate = 'PS740' AND p2.relationshipPredicate = 'PS406'\\n    GROUP BY p1.subject, p1.relationshipId\\n  ) as res\\n  GROUP BY subject\\n), PersonNumber AS (\\n  SELECT subject, json_group_array(json(number)) as phoneNumbers\\n  FROM (\\n    SELECT p1.subject, json_object('label', p1.object, 'phoneNumber', p2.object) as number\\n    FROM PersonSubgraph p1 JOIN PersonSubgraph p2 ON p1.relationshipId = p2.relationshipId\\n    WHERE p1.predicate = 'PS520' AND p1.relationshipPredicate = 'PS740' AND p2.relationshipPredicate = 'PS407'\\n    GROUP BY p1.subject, p1.relationshipId\\n  ) as res\\n  GROUP BY subject\\n), PersonsRepeated AS (\\n    SELECT\\n      s.subject,\\n      PersonName.fullName,\\n      PersonFirstName.firstNames,\\n      PersonMiddleName.middleNames,\\n      PersonFamilyName.familyNames,\\n      NULL as names,\\n      PersonPhoneticName.phoneticName,\\n      PersonAliases.aliases,\\n      PersonDOB.dateOfBirth,\\n      PersonCurrentUser.isCurrentUser,\\n      PersonPrevFamilyName.previousFamilyName,\\n      PersonVID.visualIdentifier,\\n      PersonCID.contactIdentifier,\\n      PersonEmployer.employer,\\n      PersonURL.url,\\n      PersonRelationship.personRelationship,\\n      PersonLocation.location,\\n      PersonEmail.emailAddresses,\\n      PersonNumber.phoneNumbers\\n    FROM PersonSubjects s\\n    LEFT JOIN PersonName ON s.subject = PersonName.subject\\n    LEFT JOIN PersonFirstName ON s.subject = PersonFirstName.subject\\n    LEFT JOIN PersonMiddleName ON s.subject = PersonMiddleName.subject\\n    LEFT JOIN PersonFamilyName ON s.subject = PersonFamilyName.subject\\n    LEFT JOIN PersonPhoneticName ON s.subject = PersonPhoneticName.subject\\n    LEFT JOIN PersonAliases ON s.subject = PersonAliases.subject\\n    LEFT JOIN PersonDOB ON s.subject = PersonDOB.subject\\n    LEFT JOIN PersonCurrentUser ON s.subject = PersonCurrentUser.subject\\n    LEFT JOIN PersonPrevFamilyName ON s.subject = PersonPrevFamilyName.subject\\n    LEFT JOIN PersonVID ON s.subject = PersonVID.subject\\n    LEFT JOIN PersonCID ON s.subject = PersonCID.subject\\n    LEFT JOIN PersonEmployer ON s.subject = PersonEmployer.subject\\n    LEFT JOIN PersonURL ON s.subject = PersonURL.subject\\n    LEFT JOIN PersonRelationship ON s.subject = PersonRelationship.subject\\n    LEFT JOIN PersonLocation ON s.subject = PersonLocation.subject\\n    LEFT JOIN PersonEmail ON s.subject = PersonEmail.subject\\n    LEFT JOIN PersonNumber ON s.subject = PersonNumber.subject\\n), PersonsRanked AS (\\n    SELECT\\n      *,\\n      ROW_NUMBER() OVER (PARTITION BY subject) AS rn\\n    FROM\\n      PersonsRepeated\\n)\\n\\nSELECT\\n  subject,\\n  'md:' || subject AS identifier,\\n  fullName,\\n  firstNames,\\n  middleNames,\\n  familyNames,\\n  names,\\n  phoneticName,\\n  aliases,\\n  dateOfBirth,\\n  isCurrentUser,\\n  previousFamilyName,\\n  visualIdentifier,\\n  contactIdentifier,\\n  employer,\\n  url,\\n  personRelationship,\\n  location,\\n  emailAddresses,\\n  phoneNumbers\\nFROM\\n  PersonsRanked\\nWHERE\\n  rn = 1;\\n\"}, \"target\": {\"database\": \"IntelligencePlatform.Entity\", \"name\": \"Person\", \"target\": \"IntelligencePlatform.Entity.Person\", \"type\": \"view\"}, \"type\": \"sqlConnection\", \"update\": {\"knowledgeGraphListeners\": [{\"filters\": [{\"entityType\": \"SB104\"}], \"schedule\": \"live\", \"stores\": [\"stableGraph\"]}]}, \"uuid\": \"452B64BE-860F-45E7-A31E-3FBE288A01E8\", \"version\": \"8bd9d1eb-8fa9-4988-8486-cf3c1fe3b8ea\", \"writeToStream\": true}"
- "{\"configHash\": \"e35d0dd29b08d45ad69a4fbc97ac2121e468b5557e01e24dfbe1246df27cb5e7\", \"dependencies\": [], \"dependents\": [], \"deployment\": [\"production\"], \"featureFlag\": \"OrionSQL\", \"legacyName\": \"software\", \"name\": \"Software\", \"platforms\": {\"iOS\": \"18.0\", \"macOS\": \"15.0\"}, \"sql\": {\"update\": \"WITH SoftwareSubgraph AS (\\n  SELECT\\n    g1.subject,\\n    g1.predicate,\\n    g1.object,\\n    g1.relationshipPredicate,\\n    g1.relationshipId\\n  FROM\\n    \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\" g1\\n    JOIN \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\" g2 ON g1.subject = g2.subject\\n  WHERE\\n    g2.predicate = 'PS1'\\n    AND g2.object = 'SB144'\\n    AND $SUBJECT_COND(g1.subject)\\n), SoftwareSubjects AS (\\n  SELECT DISTINCT subject FROM SoftwareSubgraph\\n), OrganizationSubgraph AS (\\n  SELECT\\n    g1.subject,\\n    g1.predicate,\\n    g1.object,\\n    g1.relationshipPredicate,\\n    g1.relationshipId\\n  FROM\\n    \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\" g1\\n    JOIN \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\" g2 ON g1.subject = g2.subject\\n  WHERE\\n    g2.predicate = 'PS1'\\n    AND g2.object = 'SB10'\\n), SoftwareName AS (\\n  SELECT subject, object as name\\n  FROM SoftwareSubgraph\\n  WHERE predicate = 'PS33'\\n), SoftwareBundleIdentifier AS (\\n  SELECT subject, object as bundleIdentifier\\n  FROM SoftwareSubgraph\\n  WHERE predicate = 'nm_bundleID'\\n), SoftwareAppIdentifier AS (\\n  SELECT subject, object as applicationIdentifier\\n  FROM SoftwareSubgraph\\n  WHERE predicate = 'nm_applicationIdentifier'\\n), SoftwarePublisher AS (\\n  SELECT p.subject, json_group_object(\\n    CASE WHEN o.predicate = 'PS33' THEN 'name' WHEN o.predicate = 'nm_phoneticName' THEN 'phoneticName' WHEN o.predicate = 'PS548' THEN 'department' WHEN o.predicate = 'nm_teamIdentifier' THEN 'teamIdentifier' END,\\n    o.object\\n  ) as publishedBy\\n  FROM SoftwareSubgraph p JOIN OrganizationSubgraph o ON p.object = o.subject\\n  WHERE p.predicate = 'PS194'\\n  AND o.predicate IN ('PS33', 'nm_phoneticName', 'PS548', 'nm_teamIdentifier')\\n  GROUP BY p.subject\\n), SoftwareRepeated AS (\\nSELECT\\n  s.subject,\\n  SoftwareName.name,\\n  SoftwareBundleIdentifier.bundleIdentifier,\\n  SoftwareAppIdentifier.applicationIdentifier,\\n  SoftwarePublisher.publishedBy\\nFROM\\n  SoftwareSubjects AS s\\n  LEFT JOIN SoftwareName ON s.subject = SoftwareName.subject\\n  LEFT JOIN SoftwareBundleIdentifier ON s.subject = SoftwareBundleIdentifier.subject\\n  LEFT JOIN SoftwareAppIdentifier ON s.subject = SoftwareAppIdentifier.subject\\n  LEFT JOIN SoftwarePublisher ON s.subject = SoftwarePublisher.subject\\n), SoftwareRanked AS (\\n  SELECT\\n    *,\\n    ROW_NUMBER() OVER (PARTITION BY subject) AS rn\\n  FROM\\n    SoftwareRepeated\\n)\\n\\nSELECT\\n  subject,\\n  'md:' || subject as identifier,\\n  name,\\n  bundleIdentifier,\\n  applicationIdentifier,\\n  publishedBy\\nFROM\\n  SoftwareRanked\\nWHERE\\n  rn = 1\\n\"}, \"target\": {\"database\": \"IntelligencePlatform.Entity\", \"name\": \"Software\", \"target\": \"IntelligencePlatform.Entity.Software\", \"type\": \"view\"}, \"type\": \"sqlConnection\", \"update\": {\"knowledgeGraphListeners\": [{\"filters\": [{\"entityType\": \"SB144\"}], \"schedule\": \"live\", \"stores\": [\"stableGraph\"]}]}, \"uuid\": \"22867F23-F8DB-4678-B75F-96CE567CC22B\", \"version\": \"8f882c2f-a95e-41c0-9d0f-1c12a0ed24f7\"}"
- "{\"configHash\": \"e6f37a0c711e82527fa75b59784a3ffc0bbbdca3b67d8148ec0f57af7069dfd8\", \"dependencies\": [], \"dependents\": [\"WalletOrderExtractedView\"], \"deployment\": [\"production\"], \"featureFlag\": \"OrionSQL\", \"legacyName\": \"WalletTrackedOrderFields\", \"name\": \"WalletTrackedOrderFields\", \"platforms\": {\"iOS\": \"18.0\"}, \"sql\": {\"update\": \"WITH WalletOrderSubgraph AS (\\n  SELECT\\n    g1.subject,\\n    g1.predicate,\\n    g1.object,\\n    g1.relationshipPredicate,\\n    g1.relationshipId\\n  FROM\\n    \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\" g1\\n    JOIN \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\" g2 ON g1.subject = g2.subject\\n  WHERE\\n    g2.predicate = 'PS1'\\n    AND g2.object = 'nm_walletOrder'\\n    AND $SUBJECT_COND(g1.subject)\\n),\\nWalletOrderSubjects AS (\\n  SELECT\\n    DISTINCT subject\\n  FROM\\n    WalletOrderSubgraph\\n),\\nWalletOrderNumber AS (\\n  SELECT\\n    subject,\\n    object as orderNumber\\n  FROM\\n    WalletOrderSubgraph\\n  WHERE\\n    predicate = 'nm_orderNumber'\\n),\\nWalletHasIdentifiers AS (\\n  SELECT\\n    subject,\\n    predicate,\\n    object,\\n    relationshipId,\\n    relationshipPredicate\\n  FROM\\n    WalletOrderSubgraph\\n  WHERE\\n    predicate = 'PS72'\\n),\\nWalletTrackedOrderTypeRecord AS (\\n  SELECT\\n    subject,\\n    predicate,\\n    object,\\n    relationshipId,\\n    relationshipPredicate\\n  FROM\\n    WalletHasIdentifiers\\n  WHERE\\n    predicate = 'PS72'\\n    AND object = 'trackedOrderDetails'\\n),\\nWalletTrackedOrderTypeEntries AS (\\n  SELECT\\n    WalletHasIdentifiers.*\\n  from\\n    WalletTrackedOrderTypeRecord\\n    LEFT JOIN WalletHasIdentifiers ON WalletTrackedOrderTypeRecord.relationshipId = WalletHasIdentifiers.relationshipId\\n),\\nTrackedOrderDetails AS (\\n  SELECT\\n    subject,\\n    object as trackedOrderDetailJson\\n  FROM\\n    WalletTrackedOrderTypeEntries\\n  WHERE\\n    predicate = 'PS72'\\n    AND relationshipPredicate = 'PS69'\\n)\\nSELECT\\n  subject,\\n  'md:' || subject AS identifier,\\n  json_extract(trackedOrderDetailJson, '$.merchantName') trkMerchantName,\\n  json_extract(trackedOrderDetailJson, '$.domainName') trkDomainName,\\n  json_extract(trackedOrderDetailJson, '$.orderStatus') trkOrderStatus,\\n  json_extract(trackedOrderDetailJson, '$.orderDate') trkOrderDate,\\n  json_extract(trackedOrderDetailJson, '$.trackingNumber') trkTrackingNumber,\\n  json_extract(trackedOrderDetailJson, '$.orderNumber') trkOrderNumber,\\n  json_extract(trackedOrderDetailJson, '$.earliestEmailDateSent') earliestEmailDateSent,\\n  json_extract(trackedOrderDetailJson, '$.displayNameUpdateDate') merchantNameUpdateDate,\\n  json_extract(trackedOrderDetailJson, '$.orderStatusUpdateDate') orderStatusUpdateDate\\nFROM\\n  TrackedOrderDetails\\n\"}, \"target\": {\"database\": \"WalletPaymentsCommerce.Internal\", \"name\": \"WalletTrackedOrderFields\", \"target\": \"WalletPaymentsCommerce.Internal.WalletTrackedOrderFields\", \"type\": \"view\"}, \"type\": \"sqlConnection\", \"update\": {\"knowledgeGraphListeners\": [{\"filters\": [{\"entityType\": \"nm_walletOrder\"}], \"requiredSource\": false, \"schedule\": \"live\", \"source\": \"WalletTrackedOrder\", \"stores\": [\"stableGraph\"]}]}, \"uuid\": \"BC6D1A82-3165-4C64-B6D5-E1FBDFE8EDC5\", \"version\": \"624db2ab-7c88-408f-b44c-1cd414a1a74b\"}"
- "{\"configHash\": \"fcf226454a59cecbe50797380911fa3deae88fc16ef4f056332e7f88d64f0fa3\", \"dependencies\": [], \"dependents\": [\"WalletOrderExtractedView\"], \"deployment\": [\"production\"], \"featureFlag\": \"OrionSQL\", \"legacyName\": \"WalletOrderPayment\", \"name\": \"WalletOrderPayment\", \"platforms\": {\"iOS\": \"18.0\"}, \"sql\": {\"update\": \"WITH WalletPaymentSubgraph AS (\\n  SELECT\\n    g1.subject,\\n    g1.predicate,\\n    g1.object,\\n    g1.relationshipPredicate,\\n    g1.relationshipId\\n  FROM\\n    \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\" g1\\n    JOIN \\\"IntelligencePlatform.KnowledgeGraph.StableGraph\\\" g2 ON g1.subject = g2.subject\\n  WHERE\\n    g2.predicate = 'PS1'\\n    AND g2.object = 'nm_payment'\\n    AND $SUBJECT_COND(g1.subject)\\n), WalletPaymentSubjects AS (\\n  SELECT DISTINCT subject FROM WalletPaymentSubgraph\\n), CurrencyCode AS (\\n  SELECT subject, object as currencyCode\\n  FROM WalletPaymentSubgraph\\n  WHERE predicate = 'nm_totalAmount' AND relationshipPredicate = 'PS2'\\n), TotalAmount AS (\\n  SELECT subject, object as totalAmount\\n  FROM WalletPaymentSubgraph\\n  WHERE predicate = 'nm_totalAmount' AND relationshipPredicate = 'PS3'\\n), WalletPaymentsRepeated AS (\\n  SELECT\\n    s.subject,\\n    CurrencyCode.currencyCode,\\n    TotalAmount.totalAmount\\n  FROM\\n    WalletPaymentSubjects as s\\n    LEFT JOIN CurrencyCode ON s.subject = CurrencyCode.subject\\n    LEFT JOIN TotalAmount ON s.subject = TotalAmount.subject\\n)\\nSELECT DISTINCT\\n  subject,\\n  'md:' || subject AS identifier,\\n  currencyCode,\\n  totalAmount\\nFROM\\n  WalletPaymentsRepeated\\n\"}, \"target\": {\"database\": \"WalletPaymentsCommerce.Internal\", \"name\": \"WalletOrderPayment\", \"target\": \"WalletPaymentsCommerce.Internal.WalletOrderPayment\", \"type\": \"view\"}, \"type\": \"sqlConnection\", \"update\": {\"knowledgeGraphListeners\": [{\"filters\": [{\"entityType\": \"nm_payment\"}], \"requiredSource\": false, \"schedule\": \"live\", \"source\": \"WalletClassicOrder\", \"stores\": [\"stableGraph\"]}, {\"filters\": [{\"entityType\": \"nm_payment\"}], \"requiredSource\": false, \"schedule\": \"live\", \"source\": \"WalletEmailOrder\", \"stores\": [\"stableGraph\"]}, {\"filters\": [{\"entityType\": \"nm_payment\"}], \"requiredSource\": false, \"schedule\": \"live\", \"source\": \"WalletTransactionOrder\", \"stores\": [\"stableGraph\"]}, {\"filters\": [{\"entityType\": \"nm_payment\"}], \"requiredSource\": false, \"schedule\": \"live\", \"source\": \"WalletTrackedOrder\", \"stores\": [\"stableGraph\"]}]}, \"uuid\": \"E24196FF-10DB-445C-A010-5A74DC34BA3C\", \"version\": \"1e2cc9e4-9c37-4c0a-a2e0-d44be5a7ae9d\"}"

```
