## TrialServer

> `/System/Library/PrivateFrameworks/TrialServer.framework/TrialServer`

```diff

-429.0.4.6.0
-  __TEXT.__text: 0x163438
-  __TEXT.__auth_stubs: 0xf00
-  __TEXT.__objc_methlist: 0xacec
-  __TEXT.__const: 0xf80
-  __TEXT.__gcc_except_tab: 0xa198
-  __TEXT.__cstring: 0x160f3
-  __TEXT.__oslogstring: 0x1dc68
+429.18.0.0.0
+  __TEXT.__text: 0x1681ec
+  __TEXT.__auth_stubs: 0xf30
+  __TEXT.__delay_helper: 0x1d8
+  __TEXT.__objc_methlist: 0xbf7c
+  __TEXT.__const: 0xf90
   __TEXT.__dlopen_cstrs: 0x74
-  __TEXT.__unwind_info: 0x4508
-  __TEXT.__objc_classname: 0x27bb
-  __TEXT.__objc_methname: 0x1db49
-  __TEXT.__objc_methtype: 0x5362
-  __TEXT.__objc_stubs: 0x145e0
-  __DATA_CONST.__got: 0x1338
-  __DATA_CONST.__const: 0x6cd0
-  __DATA_CONST.__objc_classlist: 0x918
+  __TEXT.__gcc_except_tab: 0xa2c0
+  __TEXT.__cstring: 0x16e48
+  __TEXT.__oslogstring: 0x1e519
+  __TEXT.__unwind_info: 0x4548
+  __TEXT.__objc_classname: 0x287c
+  __TEXT.__objc_methname: 0x1e543
+  __TEXT.__objc_methtype: 0x5478
+  __TEXT.__objc_stubs: 0x14e40
+  __DATA_CONST.__got: 0x1390
+  __DATA_CONST.__const: 0x6ea0
+  __DATA_CONST.__objc_classlist: 0x940
   __DATA_CONST.__objc_catlist: 0x80
-  __DATA_CONST.__objc_protolist: 0x1f8
+  __DATA_CONST.__objc_protolist: 0x200
   __DATA_CONST.__objc_imageinfo: 0x8
-  __DATA_CONST.__objc_selrefs: 0x5ac8
+  __DATA_CONST.__objc_selrefs: 0x5de0
   __DATA_CONST.__objc_protorefs: 0x40
-  __DATA_CONST.__objc_superrefs: 0x5e0
-  __DATA_CONST.__objc_arraydata: 0x3c0
-  __AUTH_CONST.__auth_got: 0x790
-  __AUTH_CONST.__const: 0xfa0
-  __AUTH_CONST.__cfstring: 0xdbc0
-  __AUTH_CONST.__objc_const: 0x18b28
-  __AUTH_CONST.__objc_arrayobj: 0x300
-  __AUTH_CONST.__objc_intobj: 0x930
+  __DATA_CONST.__objc_superrefs: 0x5f8
+  __DATA_CONST.__objc_arraydata: 0x350
+  __AUTH_CONST.__auth_got: 0x7a8
+  __AUTH_CONST.__const: 0x1020
+  __AUTH_CONST.__cfstring: 0xe1a0
+  __AUTH_CONST.__objc_const: 0x173a0
+  __AUTH_CONST.__objc_arrayobj: 0x2e8
+  __AUTH_CONST.__objc_intobj: 0x960
   __AUTH_CONST.__objc_dictobj: 0x28
-  __AUTH.__objc_data: 0x2008
-  __AUTH.__data: 0x8c0
-  __DATA.__objc_ivar: 0xaa8
-  __DATA.__data: 0x2528
+  __AUTH.__objc_data: 0x1748
+  __AUTH.__data: 0x8e8
+  __DATA.__objc_ivar: 0x8a8
+  __DATA.__data: 0x25b8
   __DATA.__crash_info: 0x40
-  __DATA.__bss: 0x3a8
-  __DATA_DIRTY.__objc_data: 0x3ae8
-  __DATA_DIRTY.__bss: 0x58
+  __DATA.__bss: 0x168
+  __DATA_DIRTY.__objc_ivar: 0x22c
+  __DATA_DIRTY.__objc_data: 0x4538
+  __DATA_DIRTY.__common: 0x8
+  __DATA_DIRTY.__bss: 0x2a8
   - /System/Library/Frameworks/Accounts.framework/Accounts
   - /System/Library/Frameworks/CloudKit.framework/CloudKit
   - /System/Library/Frameworks/CoreFoundation.framework/CoreFoundation

   - /System/Library/PrivateFrameworks/AppleAccount.framework/AppleAccount
   - /System/Library/PrivateFrameworks/AppleFlatBuffers.framework/AppleFlatBuffers
   - /System/Library/PrivateFrameworks/ApplePushService.framework/ApplePushService
+  - /System/Library/PrivateFrameworks/BackgroundSystemTasks.framework/BackgroundSystemTasks
   - /System/Library/PrivateFrameworks/BiomeLibrary.framework/BiomeLibrary
   - /System/Library/PrivateFrameworks/BiomeStreams.framework/BiomeStreams
   - /System/Library/PrivateFrameworks/CacheDelete.framework/CacheDelete
+  - /System/Library/PrivateFrameworks/GenerativeModels.framework/GenerativeModels
   - /System/Library/PrivateFrameworks/ManagedConfiguration.framework/ManagedConfiguration
   - /System/Library/PrivateFrameworks/MobileAsset.framework/MobileAsset
   - /System/Library/PrivateFrameworks/MobileKeyBag.framework/MobileKeyBag

   - /usr/lib/libSystem.B.dylib
   - /usr/lib/libobjc.A.dylib
   - /usr/lib/libsqlite3.dylib
-  Functions: 4892
-  Symbols:   6178
-  CStrings:  8713
+  Functions: 4922
+  Symbols:   6261
+  CStrings:  8917
 
Symbols:
+ OBJC_IVAR_$_TRIBGSTManagerGuardedData.identifierToTask
+ OBJC_IVAR_$_TRITaskQueueGuardedData.bgstManager
+ _BiomeLibrary
+ _CFStringGetTypeID
+ _OBJC_CLASS_$_BGNonRepeatingSystemTaskRequest
+ _OBJC_CLASS_$_BGSystemTaskScheduler
+ _OBJC_CLASS_$_BMSQLDatabase
+ _OBJC_CLASS_$_BMTrialNamespaceUpdates
+ _OBJC_CLASS_$_BMTrialNamespaceUpdatesNamespaceNamesList
+ _OBJC_CLASS_$_GMAvailabilityWrapper
+ _OBJC_CLASS_$_TRIBGSTManager
+ _OBJC_CLASS_$_TRIBGSTManagerGuardedData
+ _OBJC_CLASS_$_TRIBiomeExperimentUpdateStreamWriter
+ _OBJC_CLASS_$_TRIExperimentUpdateProcessor
+ _OBJC_CLASS_$_TRIExperimentUpdateScheduler
+ _OBJC_METACLASS_$_TRIBGSTManager
+ _OBJC_METACLASS_$_TRIBGSTManagerGuardedData
+ _OBJC_METACLASS_$_TRIBiomeExperimentUpdateStreamWriter
+ _OBJC_METACLASS_$_TRIExperimentUpdateProcessor
+ _OBJC_METACLASS_$_TRIExperimentUpdateScheduler
+ _TRIBGSTSchedulingDelayInSeconds
+ _TRIBackgroundSystemTaskIdentifier_Deactivation
+ _TRIPersistentAIState
+ __experimentUpdateProcessor
+ _dlopen
CStrings:
+ "\x01\x14\x13\x14"
+ "\x03\x12"
+ "\x13\x14"
+ "-[TRIDServer _registerXpcStreamEventHandler]_block_invoke"
+ "-[TRIInternalServiceRequestHandler activeBMLTInformationWithPrivacyFilterPolicy:completion:]_block_invoke"
+ "-[TRIInternalServiceRequestHandler activeRolloutInformationWithPrivacyFilterPolicy:completion:]_block_invoke"
+ "-[TRIInternalServiceRequestHandler experimentNotificationsWithExperimentId:cloudKitContainer:teamId:completion:]_block_invoke"
+ "-[TRIInternalServiceRequestHandler lastFetchDateForContainer:teamId:completion:]_block_invoke"
+ "-[TRIInternalServiceRequestHandler logSystemCovariates]_block_invoke"
+ "-[TRIInternalServiceRequestHandler rolloutNotificationWithLatestDeploymentForRolloutId:cloudKitContainer:teamId:completion:]_block_invoke"
+ "-[TRIInternalServiceRequestHandler setLastFetchDate:forContainer:teamId:completion:]_block_invoke"
+ "-[TRIInternalServiceRequestHandler setSubscription:namespaceName:completion:]_block_invoke"
+ "-[TRIInternalServiceRequestHandler subscriptionForNamespaceName:completion:]_block_invoke"
+ "-[TRIXPCNamespaceManagementRequestHandler _setPurgeabilityLevelsForFactors:usingEntitlementWitness:namespace:paths:completion:]_block_invoke"
+ "-[TRIXPCNamespaceManagementRequestHandler loadNamespaceMetadataForNamespaceName:completion:]_block_invoke"
+ "-[TRIXPCNamespaceManagementRequestHandler setPurgeabilityLevelsForFactors:forNamespaceName:completion:]_block_invoke_2"
+ "-[TRIXPCNamespaceManagementRequestHandler startDownloadLevelsForFactors:withNamespace:factorsState:options:completion:]_block_invoke"
+ "-[TRIXPCNamespaceManagementRequestHandler statusOfDownloadForFactors:withNamespace:factorsState:completion:]_block_invoke_2"
+ "/System/Library/PrivateFrameworks/BackgroundSystemTasks.framework/BackgroundSystemTasks"
+ "/System/Library/PrivateFrameworks/GenerativeModels.framework/GenerativeModels"
+ "<%@:%@,%d,%ld,r:%d>"
+ "@\"<TRIExperimentUpdateSchedulerProtocol>\""
+ "@\"TRIBGSTManager\""
+ "@40@0:8@16@24B32B36"
+ "@52@0:8@16@24B32@36@44"
+ "@84@0:8@16@24@32@40@48B56@60@68@76"
+ "AppleIntelligenceState"
+ "B24@?0@\"BMStoreEvent\"8^B16"
+ "B76@0:8B16@20@28@36@44@52@60@68"
+ "BGST %@ was expired, but we failed to request rescheduling: %@"
+ "BGST %@ was expired, requested rescheduling"
+ "BMLT fetch requested but no deployment was provided"
+ "Blob length (%lu) is insufficient for reading persisted AI State"
+ "Clearing Experiment Updates Biome Stream due to D&U opt-out"
+ "Counterfactuals"
+ "Currently running deactivation BGST. Completing and rescheduling it."
+ "Data to be persisted for Apple Intelligence and usage was nil"
+ "Deferral requested before checking to see if biome should be cleared."
+ "Deferral requested before pruning Biome Stream."
+ "Deferral requested before publishing low level factors."
+ "Deferral requested before reporting experiments metric."
+ "Error querying Obsolete Biome Events: %@"
+ "Experiment update notification missing artifact"
+ "Failed to reschedule deactivation BGST with error: %@"
+ "Failed to submit deactivation BGST with error: %@"
+ "Failed to update experiment end date due to missing existing experiment record."
+ "Feb 21 2025"
+ "Found Pallas settings for %{public}@: Audience %{public}@, matches new setting: %d"
+ "Found Pallas settings for %{public}@: Pallas URL %{public}@, matches new setting: %d"
+ "Found missing MA ref db entry: %{public}@"
+ "Invalid FPS ID for counterfactuals in TRIActivateTreatmentPersistedTask: %{public}@"
+ "Invalid useCaseId: %@"
+ "Marking all BGSTs as completed as the task queue has finished"
+ "MobileAssetAssetAudience"
+ "NamespaceUpdates"
+ "Neither protobuf nor flatbuffer were found in a factor pack of FPS with id %@"
+ "New BGST added, need to update task queue capabilities"
+ "No key-value store present for persisted AI State retrieval"
+ "No persisted AI State and usage state found for key: %{public}@"
+ "Not able to log post-launch telemetry for exp_st_AL. Experiment record not found after downloading FPS: %@"
+ "Not scheduling deactivation BGST as there's already a BGST scheduled to run in %lld seconds"
+ "Not scheduling deactivation BGST as there's no scheduled deactivation tasks"
+ "Not scheduling deactivation BGST as there's no scheduled tasks"
+ "PallasUrlOverrideV2"
+ "Processing experiment update for experiment: %{public}@ deployment: %u"
+ "Pruning Obsolete events from biome stream"
+ "Queueing counterfactual FPS fetch (ExperimentId: %@, TreatmentId: %@, FPSId: %@)"
+ "Rescheduling deactivation BGST to run in %lld seconds (previously %lld)"
+ "Running deactivation BGST"
+ "SELECT * FROM \"Trial.Experiment.NamespaceUpdates\" WHERE experimentStatus=2 AND eventTimestamp < '%f'"
+ "Scheduled the deactivation BGST to run in %lld seconds from now."
+ "Setting PallasURL for %{public}@ to %{public}@"
+ "Setting audience setting for %{public}@ to %{public}@"
+ "Skipping post-launch FPS task telemetry for counterfactual treatment: %@ (FPS: %@)"
+ "T@\"<TRIExperimentUpdateSchedulerProtocol>\",R,N,V_experimentUpdateScheduler"
+ "T@\"NSDictionary\",R,N,V_counterfactualTreatments"
+ "T@\"NSMutableDictionary\",&,D,N"
+ "T@\"_PASSqliteDatabase\",R,N"
+ "TRIBGSTManager"
+ "TRIBGSTManager.m"
+ "TRIBGSTManagerGuardedData"
+ "TRIBiomeExperimentUpdateStreamWriter"
+ "TRIBiomeExperimentUpdateStreamWriter.m"
+ "TRIDServer: AI State Change Notification received"
+ "TRIDServer: AI State changed, queueing retargeting"
+ "TRIExperimentUpdateProcessor"
+ "TRIExperimentUpdateScheduler"
+ "TRIExperimentUpdateSchedulerProtocol"
+ "TRIPurgeableExperimentAndRolloutProvider.m"
+ "TrialXP-429.18"
+ "Unable to find subpaths of treatments dir %{public}@"
+ "Unable to rollback because the artifact contains no deployment"
+ "[RADAR SEARCH] Missing FPE layer for an experiment in namespace %@"
+ "[serverContext.paths namespaceDescriptorsDefaultDir]"
+ "_counterfactualTreatments"
+ "_experimentDeployment.experimentId"
+ "_experimentUpdateScheduler"
+ "_getCurrentPallasAudienceForAssetType:"
+ "_getCurrentPallasURLForAssetType:"
+ "_handleExperimentUpdateNotification:"
+ "_isCounterfactualTreatment"
+ "_overwriteActiveFactorProvidersUsingGlobalPath:withNamespaceMap:rolloutDeploymentMap:experimentDeploymentMap:experimentTreatmentMap:treatmentFactorPackSetIdsMap:counterfactualTreatmentsMap:factorPackMap:"
+ "_registerDeactivationBGST"
+ "_scheduleDeactivationBGST:"
+ "_setPallasAudience:forAssetType:"
+ "_setPallasURL:forAssetType:"
+ "_submitDeactivationBGSTRequestAfterSeconds:gracePeriodInSeconds:"
+ "_updateExperimentEndDateWithDeployment:withNewEndDate:scheduleDeactivationTask:scheduleDeactivationNow:"
+ "appleIntelligenceState"
+ "artifact.experiment.endDate.date"
+ "artifact.experimentDeployment.taskTag"
+ "artifact.namespaceNames"
+ "artifact.rollout.rampId"
+ "bgstManager"
+ "clearExperimentUpdatesStream"
+ "com.apple.MobileAsset"
+ "com.apple.gms.availability.notification"
+ "com.apple.triald.deactivation"
+ "com.apple.triald.persisted.AIState"
+ "counterfactualLogging"
+ "counterfactualTreatmentIds"
+ "counterfactualTreatments"
+ "counterfactualTreatments_Count"
+ "counterfactualsTreatmentsToFactorPackSetIds"
+ "counterfactualsTreatmentsToFactorPackSetIdsWithActiveTreatmentId:"
+ "currentWithUseCaseIdentifiers:"
+ "delete-obsolete-events"
+ "deleteObsoleteEventsFromExperimentsUpdateStream"
+ "deleteWithPolicy:eventsPassingTest:"
+ "eliminableAssetTypes"
+ "eventBody"
+ "executeQuery:"
+ "experimentRecord.artifact.experiment.channelId"
+ "experimentUpdateNotification"
+ "experimentUpdateScheduler"
+ "expireBGST:"
+ "factorPack"
+ "factorPack.factorPackId"
+ "factorPack.selectedNamespace"
+ "factorPack.selectedNamespace.name"
+ "fbFactorLevel.namespaceName"
+ "fbFactorPack.namespaceName"
+ "fbFactorPack.sourceAsFactorPackId"
+ "flatbufferFactorLevel.namespaceName"
+ "getBytes:length:"
+ "hasCounterfactualLogging"
+ "hasCounterfactualTreatmentReferencingFactorPackSetId:"
+ "hasIsCounterfactualTreatment"
+ "identifierToTask"
+ "initWithDeploymentEnvironment:experimentDeployment:treatmentId:factorPackSetId:type:status:startDate:endDate:namespaces:isShadow:counterfactualTreatmentIds:"
+ "initWithExperimentDatabase:"
+ "initWithFactorPackSetId:treatmentId:isCounterfactualTreatment:taskAttribution:experimentDeployment:"
+ "initWithIdentifier:"
+ "initWithNamespaceName:"
+ "initWithNamespaceNames:experimentStatus:userId:experimentId:deploymentId:treatmentId:"
+ "initWithNotificationChecker:hotfixScheduler:rollbackScheduler:experimentUpdateScheduler:"
+ "initWithServerContext:asyncQueue:"
+ "initWithUseCase:"
+ "invalid type for key: %@ | expecting string"
+ "isCompatibleCounterfactual"
+ "isCounterfactualTreatment"
+ "markAllBGSTsAsCompleted"
+ "markBGSTAsStarted:"
+ "member:"
+ "newEndDate"
+ "next"
+ "opt-out-security-updates"
+ "pbFactorPack.selectedNamespace.name"
+ "persistAIState:"
+ "persistedAIState"
+ "processUpdateOperationForExistingExperimentWithEndDate:withExperimentDeployment:"
+ "protoFactorPack.selectedNamespace.name"
+ "pruner"
+ "reactionForUpdateExperimentDeployment:"
+ "record.experimentDeployment"
+ "registerForTaskWithIdentifier:usingQueue:launchHandler:"
+ "result.backgroundTask"
+ "result.backgroundTask.pluginId"
+ "resumeWithBGST:executeWhenSuspended:"
+ "rolloutRecord.namespaces"
+ "root"
+ "row"
+ "scheduleAfter"
+ "scheduleDeactivationBGSTWithEarliestDeactivationTaskScheduledDate:gracePeriodInSeconds:"
+ "scheduleExperimentUpdateOperationsForExperimentWithNewEndDate:withDeployment:"
+ "selectedNamespace.name"
+ "self.experimentDeployment.experimentId"
+ "sendEvent:"
+ "server context not full initialised before logging system covariates"
+ "serverContext.client.trackingId"
+ "serverContext.namespaceDatabase"
+ "serverContext.paths"
+ "setCounterfactualTreatments:"
+ "setExpirationHandler:"
+ "setIsCounterfactualTreatment:"
+ "setRequiresExternalPower:"
+ "setRequiresNetworkConnectivity:"
+ "setScheduleAfter:"
+ "setTaskCompleted"
+ "setTaskExpiredWithRetryAfter:error:"
+ "setTrySchedulingBefore:"
+ "sharedScheduler"
+ "source"
+ "submitTaskRequest:error:"
+ "taskRequestForIdentifier:"
+ "taskWithExperiment:treatmentId:factorPackSetId:counterfactualTreatments:taskAttributing:requiresTreatmentInstallation:capabilityModifier:startTime:taskOptions:"
+ "taskWithFactorPackSetId:treatmentId:isCounterfactualTreatment:taskAttribution:experimentDeployment:"
+ "treatmentFactorPackSetIds"
+ "tri_checkAIUseCaseEnabled:"
+ "updateTaskRequest:error:"
+ "v16@?0@\"BGSystemTask\"8"
+ "v16@?0@\"TRIBGSTManagerGuardedData\"8"
+ "v32@0:8@\"BGSystemTask\"16@?<v@?>24"
+ "v32@0:8@\"NSDate\"16@\"TRIExperimentDeployment\"24"
+ "v32@0:8@16q24"
+ "v32@0:8q16q24"
+ "v32@?0@\"NSString\"8@\"BGSystemTask\"16^B24"
+ "v32@?0@\"NSString\"8@\"NSString<TRIFactorPackSetId>\"16^B24"
+ "v36@0:8@16B24@28"
+ "writeExperimentUpdateWithRecord:withExperimentStateIsActive:withUserId:"
+ "{?=C}24@0:8@\"TRIExperimentDeployment\"16"
- "\x01\x17\x14"
- "\x13\x13"
- "@76@0:8@16@24@32@40B48@52@60@68"
- "B60@0:8B16@20@28@36@44@52"
- "Deferral requested before reporting storage telemetry."
- "Did not find any missing MA ref db entries"
- "Failed to update experiment end date due to missing information, ignoring."
- "Found missing MA ref db entries: %{public}@"
- "Jan  1 2025"
- "Setting Siri-specific audience setting for %{public}@ to %{public}@ with Pallas URL %{public}@"
- "Setting audience setting for %{public}@ to %{public}@ with Pallas URL %{public}@"
- "TRIActivateTreatment is instantiated with a factor pack set id when FPE write is disabled."
- "TrialXP-429.0.4.6"
- "Unable to find subpaths of treatments dir %{public}@: %{public}@"
- "_overwriteActiveFactorProvidersUsingGlobalPath:withNamespaceMap:rolloutDeploymentMap:experimentDeploymentMap:experimentTreatmentMap:factorPackMap:"
- "_updateExperimentEndDateWithArtifact:context:database:scheduleDeactivationTask:scheduleDeactivationNow:"
- "allTrialAssetTypes"
- "initWithDeploymentEnvironment:experimentDeployment:treatmentId:factorPackSetId:type:status:startDate:endDate:namespaces:isShadow:"
- "initWithFactorPackSetId:treatmentId:taskAttribution:experimentDeployment:"
- "initWithNotificationChecker:hotfixScheduler:rollbackScheduler:"
- "siriTrialAssetTypes"
- "subpathsOfDirectoryAtPath:error:"
- "taskWithExperiment:treatmentId:factorPackSetId:taskAttributing:requiresTreatmentInstallation:capabilityModifier:startTime:taskOptions:"
- "taskWithFactorPackSetId:treatmentId:taskAttribution:experimentDeployment:"

```
