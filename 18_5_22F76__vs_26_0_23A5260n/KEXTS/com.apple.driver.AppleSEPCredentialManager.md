## com.apple.driver.AppleSEPCredentialManager

> `com.apple.driver.AppleSEPCredentialManager`

```diff

-758.120.3.0.0
-  __TEXT.__cstring: 0x10b3a
-  __TEXT.__const: 0x370
-  __TEXT_EXEC.__text: 0x4a860
+864.0.3.0.0
+  __TEXT.__cstring: 0xfd59
+  __TEXT.__const: 0x410
+  __TEXT_EXEC.__text: 0x45624
   __TEXT_EXEC.__auth_stubs: 0x0
-  __DATA.__data: 0x2d01
-  __DATA.__common: 0x1d8
-  __DATA.__bss: 0x24f1
+  __DATA.__data: 0x2751
+  __DATA.__common: 0x1d0
+  __DATA.__bss: 0xe1
   __DATA_CONST.__auth_got: 0x310
   __DATA_CONST.__got: 0xc8
   __DATA_CONST.__auth_ptr: 0x8
   __DATA_CONST.__mod_init_func: 0x58
   __DATA_CONST.__mod_term_func: 0x58
-  __DATA_CONST.__const: 0x1a98
-  __DATA_CONST.__kalloc_type: 0x600
-  __DATA_CONST.__kalloc_var: 0x1400
-  UUID: 5A838404-4ACC-37B4-9307-DE4A891F8AC4
-  Functions: 928
+  __DATA_CONST.__const: 0x1b80
+  __DATA_CONST.__kalloc_type: 0x580
+  __DATA_CONST.__kalloc_var: 0x14a0
+  UUID: 39DCA0A3-1265-368A-93C1-602671E69883
+  Functions: 886
   Symbols:   0
-  CStrings:  1848
+  CStrings:  1735
 
CStrings:
+ "!preflightFound || allowPreflightParameter"
+ "%s: %s: %s(%u)=%s.\n"
+ "%s: %s: %s(%u)=%u.\n"
+ "*outSize >= ACMRMEnvironment::STATE_SIZE"
+ "*resultLength >= respDataSize"
+ "1211111122222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222122323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232311111112111111111122122222222222222221222222222222222222222222222222222222222222"
+ "121111121221112212221112212221112212221112212221112212222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222"
+ "ACMRequirement - ACMRequirementDataPushButton"
+ "ACMTRM-E"
+ "LibCall_ACMContextContainsCredentialTypeEx"
+ "LibCall_ACMContextCopyData"
+ "LibCall_ACMSecContextVerifyPolicyAndCopyRequirementEx"
+ "LibSer_ACMDeserializeEnvironmentVariableType"
+ "LibSer_ACMDeserializeSEPControlCode"
+ "_env.save(outBuffer, *outSize)"
+ "boAllPolicyModesSupported"
+ "boBaseSystemBooted"
+ "boBaseSystemExited"
+ "boEnd"
+ "boHIDRMEnabledByDefault"
+ "boHIDRMEnrollmentRequested"
+ "boNull"
+ "boPolicyModesConfigurable"
+ "boPolicySupportedInBaseSystem"
+ "boRecoveryEntered"
+ "boTRMEnabledByDefault"
+ "boTRMEnrollmentRequested"
+ "boTRMLockerAvailabilityChecked"
+ "boTRMLockerAvailable"
+ "boTRMLockerSupported"
+ "boUnificationSupported"
+ "com.apple.private.applecredentialmanager.contextcopydata.passphrase.allow"
+ "com.apple.private.applecredentialmanager.contextcopydata.securepassphrase.allow"
+ "com.apple.private.applecredentialmanager.nonautodisposablecontext.allow"
+ "com.apple.private.applecredentialmanager.oti.config.allow"
+ "context && outSize"
+ "context && outSize && outBuffer"
+ "cred->numCredSets <= kACMContextPoolTotalCount"
+ "locErr == 0 "
+ "nonAutoDisposable requires tracking support"
+ "param.parameterData && param.parameterDataLength == sizeof(uint8_t)"
+ "request->version > 0"
+ "requirement->type == kACMRequirementTypePushButtonPressed"
+ "requirementSize <= reqSize"
+ "site.ACMRequirement.ACMRequirementDataPushButton"
+ "size >= sizeof(acm_command_t) + sizeof(Request)"
+ "sourceContextExternalForm && sourceContextExternalFormLength == sizeof(ACMHandle)"
+ "targetContextExternalForm && targetContextExternalFormLength == sizeof(ACMHandle)"
+ "trackingSupported || !nonAutoDisposableRequested"
+ "transport && context"
+ "u32BootMode"
+ "u32End"
+ "u32HIDRMDefaultBootArg"
+ "u32HIDRMEnabledBootArg"
+ "u32HIDRMEnabledEDTProp"
+ "u32Null"
+ "u32StressRackEDTProp"
+ "u32TRMAllPolicyModesBootArg"
+ "u32TRMBaseSystemBootArg"
+ "u32TRMDefaultBootArg"
+ "u32TRMEnabledBootArg"
+ "u32TRMEnabledEDTProp"
+ "u32TRMUnificationBootArg"
- "!slot->preallocatedData.modificationTimestamp"
- "!slot->preallocatedData.owningStorage"
- "!slot->preallocatedData.size"
- "%s: %s: CS[%u] clear data[%u].\n"
- "%s: %s: CS[%u] denied to access data[%u] (owned by CS[%u]).\n"
- "%s: %s: CS[%u] get data[%u|prop=%u] <sensitive>.\n"
- "%s: %s: CS[%u] get data[%u|prop=%u] len=%u <%s>.\n"
- "%s: %s: CS[%u] set data[%u] <sensitive>.\n"
- "%s: %s: CS[%u] set data[%u] len=%u <%s>.\n"
- "%s: %s: CS[%u] storage created.\n"
- "%s: %s: CS[%u] storage deleted.\n"
- "%s: %s: accUUID=<%s> found: %s.\n"
- "%s: %s: accUUID[%u]=<%s>.\n"
- "%s: %s: forbidden to override contextData[%u]: data differs from existing data.\n"
- "%s: %s: kACMCredentialTypeSecureIntent ignored, found but untrusted.\n"
- "%s: %s: operation %s(%u) denied for %s(%u).\n"
- "%s: %s: received %u accessory UUID(s).\n"
- "%s: %s: returning, err = %ld, accUUIDs=%s, accUUIDsSize=%u.\n"
- "%s: %s: unknown data[%u|%u] property.\n"
- "((&storage->items)->slh_first == ((void*)0))"
- "(aclData && aclSize) || (!aclData && !aclSize)"
- "*inOutSize >= sizeof(Response)"
- "*outSize >= data->passphraseLength"
- "*outSize >= dataSize"
- "*outSize >= sizeof(data->format)"
- "*outSize >= sizeof(data->identityUuid)"
- "*outSize >= sizeof(data->revision)"
- "*outSize >= sizeof(uint32_t)"
- "*resultLength >= dataSize"
- "/Library/Caches/com.apple.xbs/Sources/AppleCredentialManager/common/CoreCred.c"
- "/Library/Caches/com.apple.xbs/Sources/AppleCredentialManager/common/CoreCredSet.c"
- "/Library/Caches/com.apple.xbs/Sources/AppleCredentialManager/common/CoreExec.c"
- "/Library/Caches/com.apple.xbs/Sources/AppleCredentialManager/common/CorePrague.c"
- "/Library/Caches/com.apple.xbs/Sources/AppleCredentialManager/common/CoreStorage.c"
- "/Library/Caches/com.apple.xbs/Sources/AppleCredentialManager/common/CoreUserIntent.c"
- "112"
- "12111111222222222222222222222222122323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232311111112111111111122122222222222222221222222222222222222222222222222222222222222"
- "12111121221112212221112212221112212221112212221112212222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222"
- "CredEntry"
- "CredSet_AddCredEntry"
- "CredSet_FindCredSetEntry"
- "Cred_GetNameSafe"
- "Cred_GetOpNameSafe"
- "Cred_GetPermissions"
- "Cred_IsPermanent"
- "Cred_VerifyCallerPermissions"
- "Exec_ACMContextCredentialGetProperty"
- "Exec_ACMContextCredentialGetProperty_Impl"
- "Exec_ACMContextGetData"
- "Exec_ACMContextGetInfo"
- "Exec_ACMContextLoadFromImage"
- "Exec_ACMContextSetData"
- "Exec_ACMContextUnloadToImage"
- "Exec_ACMDeserializeEnvironmentVariableType"
- "Exec_ACMDeserializeSEPControlCode"
- "Exec_ACMGetAclAuthMethod"
- "Exec_ACMGetEnvironmentVariable"
- "Exec_ACMGlobalContextCredentialGetProperty"
- "Exec_ACMGlobalContextCredentialGetProperty_Impl"
- "Exec_ACMPublishTrustedAccessories"
- "Exec_ACMSEPControl"
- "Exec_ACMSecContextGetUnlockSecret"
- "Exec_ACMSetEnvironmentVariable"
- "Exec_ACMTRMLoadState"
- "Exec_ACMTRMSaveState"
- "Prague_Parse"
- "Prague_hasInstruction"
- "Prague_verifyPrerequisite"
- "Storage_Create"
- "Storage_Delete"
- "Storage_GetDataProperty"
- "Storage_GetDataPropertyAddress"
- "Storage_GetForContext"
- "Storage_HasData"
- "Storage_SetData"
- "UserIntentProxy_Create"
- "UserIntentProxy_EvaluateCredentials"
- "UserIntentProxy_IncrementCredentialsUseCount"
- "UserIntentProxy_Release"
- "UserIntent_FindTrustedAccessory"
- "UserIntent_UpdateTrustedAccessories"
- "_verifySignature"
- "accUUID && found"
- "aclSize <= 65535"
- "add"
- "commandEnd - commandCursor >= sizeof(ACMEnvironmentVariable)"
- "commandEnd >= commandCursor"
- "context && outStorage && execCB"
- "contextRef && outBuffer && outSize && *outSize"
- "cred->numCredSets <= 80"
- "credEntry"
- "credSetEntry && cred"
- "credStore && csHandle && foundCredSetEntry"
- "credType < (sizeof(_credTable) / sizeof(_credTable[0]))"
- "credType == slotAtIndex->type"
- "credentialType == kACMCredentialTypeKextDenyListApplePay || credentialType == kACMCredentialTypeKextDenyListFairPlay || credentialType == kACMCredentialTypeBiometryMatched"
- "credentialType == kACMCredentialTypePassphraseExtractable"
- "dataAddr"
- "dataSize <= slot->maxDataSize"
- "dataType < (sizeof(_storageSlots) / sizeof(_storageSlots[0]))"
- "dataType == slotAtIndex->dataType"
- "engine"
- "engine->createRequirement"
- "engine->deallocRequirement"
- "execCB"
- "execCB && execCleanupSecretCB"
- "findItem"
- "findValidCredentialParams"
- "foundCred->type == kACMCredentialTypeSecureIntent"
- "getDataAddress"
- "getDataPropertyAddress"
- "globalCred"
- "hasData"
- "inSize <= 65535"
- "inSize >= sizeof(Request)"
- "inSize >= sizeof(Request) + request->accUUIDsSize"
- "instructionPresent"
- "instructions"
- "item"
- "kACMCredentialTypeAP"
- "kACMCredentialTypeAny"
- "kACMCredentialTypeBioContinuityConfirmed"
- "kACMCredentialTypeBiometryMatchAttempted"
- "kACMCredentialTypeBiometryMatchConfirmed"
- "kACMCredentialTypeBiometryMatched"
- "kACMCredentialTypeCapture"
- "kACMCredentialTypeContinuityUnlock"
- "kACMCredentialTypeDeviceRestrictedMode"
- "kACMCredentialTypeKextDenyListApplePay"
- "kACMCredentialTypeKextDenyListFairPlay"
- "kACMCredentialTypePasscodeValidated"
- "kACMCredentialTypePasscodeValidated2"
- "kACMCredentialTypePassphraseEntered"
- "kACMCredentialTypePassphraseExtractable"
- "kACMCredentialTypePushButtonPressed"
- "kACMCredentialTypePushButtonSecondary"
- "kACMCredentialTypeRatchet"
- "kACMCredentialTypeSecureIntent"
- "kACMCredentialTypeSignature"
- "kACMCredentialTypeUserConsent"
- "kACMCredentialTypeUserInputConfirmed"
- "kACMCredentialTypeUserOutputDiscarded"
- "kACMCredentialTypeUserOutputDisplayed"
- "kofn->subrequirements[0]"
- "kofn->subrequirements[1]"
- "newUserIntent.requirement"
- "op > kCredOperation_NULL && op < kCredOperation_COUNT"
- "outBuffer && inOutSize && *inOutSize"
- "outBuffer && outSize && *outSize"
- "paramsOpt && paramsOpt->context && paramsOpt->aclVerifyCB"
- "permissions"
- "remove"
- "request->version == kCmdCurrentVersion_ContextGetInfo"
- "request->version == kCmdCurrentVersion_PublishTrustedAccessories"
- "request->version == kCmdCurrentVersion_SetEnvironmentVariableExtended"
- "site.CredEntry"
- "slot && storage"
- "slot && storage && foundItem"
- "slot->preallocatedData.addr"
- "slot->preallocatedData.modificationTimestamp"
- "slot->preallocatedData.owningStorage"
- "storage"
- "storage && outBuffer && outSize"
- "storage && slot"
- "the caller has not provided required params for ACL verification"
- "userIntent"
- "userIntent->engine"
- "userIntent->engine->deallocRequirement"
- "userIntent->engine->evaluateKofNSubrequirements"
- "userIntent->engine->findValidCredential"
- "userIntent->req.secureIntent->type == kACMRequirementTypeSecureIntent"
- "userIntent->requirement"
- "validateInputDataSize"
- "verifyACL"
- "verifyKDL"
- "verifySIPSecureBoot"

```
